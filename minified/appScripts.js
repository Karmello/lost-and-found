"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};!function(){var e=angular.injector(["ng"]).get("$q"),t=angular.injector(["ng"]).get("$http"),o=angular.module("appModule",["ui.bootstrap","ui.router","ngAnimate","restangular","LocalStorageModule","angular-momentjs"]);e.all([t.get("public/json/hard_coded/hard_coded_en.json"),t.get("public/json/hard_coded/hard_coded_pl.json"),t.get("/session")]).then(function(e){o.constant("hardDataConst",{en:e[0].data,pl:e[1].data}),o.constant("sessionConst",e[2].data),angular.element(document).ready(function(){angular.bootstrap(document,["appModule"])})})}(),function(){angular.module("appModule").config(["$urlRouterProvider","$locationProvider","localStorageServiceProvider",function(e,t,o){e.otherwise("/home"),t.html5Mode(!1).hashPrefix(""),o.setPrefix("laf"),String.prototype.truncate=function(e){var t=this.toString();return t.length>e?t.substr(0,e)+"...":t}}])}(),function(){var e={AWS3_UPLOADS_BUCKET_URL:"https://s3.amazonaws.com/laf.useruploads/",AWS3_RESIZED_UPLOADS_BUCKET_URL:"https://s3.amazonaws.com/laf.useruploadsresized/"},t={reportMaxPhotos:15,photoMaxSize:1048576};angular.module("appModule").constant("URLS",e),angular.module("appModule").constant("NUMS",t)}(),function(){var e=angular.module("appModule");e.filter("filterByCategory",function(){return function(e,t){if(t){var o=[];return angular.forEach(e,function(e){e.name[0]==t&&o.push(e)}),o}return e}})}(),function(){angular.module("appModule").run(["$rootScope","$location","$timeout","$state","$moment","apiService","logService","ui","uiThemeService","sessionConst",function(e,t,o,r,n,a,i,c,s,l){a.setup(),s.include(l.theme),n.locale(l.language),"scrollRestoration"in history&&(history.scrollRestoration="manual"),e.$on("$stateChangeStart",function(e,t,o,r,n){r.name.split(".")[0]!=t.name.split(".")[0]&&c.loaders.renderer.start(),r!=t&&($(".modal").modal("hide"),$(".navbar-collapse").collapse("hide"))}),e.$on("$stateChangeSuccess",function(e,t,n,a,i){a.scrollY=window.scrollY,o(function(){var e;switch(t.name){case"app.profile":case"app.report":e=t.id==n.id?r.current.scrollY:0,t.id=n.id;break;case"app.search":e=r.current.scrollY;break;case"app.report.tab":return;default:e=0}$("html, body").animate({scrollTop:e},"fast")}),o(function(){c.loaders.renderer.stop()},3e3)})}])}(),function(){var e=function(e,t,o,r){return this.reportContextMenuConf={icon:"glyphicon glyphicon-option-horizontal",switchers:[{_id:"edit",label:e.hardData.imperatives[33],onClick:function(){t.go("app.report",{id:this.parent.data._id,edit:"1"})}},{_id:"delete",label:e.hardData.imperatives[14],onClick:function(){r.deleteReports([this.parent.data])}}]},this.profileReportsContextMenu={icon:"glyphicon glyphicon-option-horizontal",switchers:[{_id:"select_all",label:e.hardData.imperatives[30],onClick:function(){o.profileCollectionBrowser.selectAll()}},{_id:"deselect_all",label:e.hardData.imperatives[29],onClick:function(){o.profileCollectionBrowser.deselectAll()}},{_id:"delete",label:e.hardData.imperatives[31],onClick:function(){var e=o.profileCollectionBrowser.getSelectedCollection();e.length>0&&r.deleteReports(e)}}]},this};e.$inject=["$rootScope","$state","reportsConf","reportsService"],angular.module("appModule").service("contextMenuConf",e)}(),function(){var e=function(){var e={_ctrlId:"appFrame",switchers:[{_id:"start"},{_id:"main"}]};return e},t=function(e,t,o){var r=o.get(),n={_ctrlId:"mainFrame",switchers:[{_id:"home",route:"/#/home",label:r.sections[0],icon:"glyphicon glyphicon-home"},{_id:"search",route:"/#/search",label:r.imperatives[17],icon:"glyphicon glyphicon-search"},{_id:"newreport",route:"/#/newreport",label:r.imperatives[32],icon:"glyphicon glyphicon-bullhorn"},{_id:"profile",icon:"glyphicon glyphicon-user"},{_id:"upgrade",icon:"glyphicon glyphicon-star",label:r.sections[25]},{_id:"about",route:"/#/about",label:r.sections[2],icon:"glyphicon glyphicon-info-sign"},{_id:"help",route:"/#/help",label:r.sections[3],icon:"glyphicon glyphicon-question-sign"},{_id:"contact",route:"/#/contact",label:r.sections[4],icon:"glyphicon glyphicon-envelope"},{_id:"report",icon:"glyphicon glyphicon-file"},{_id:"settings",label:r.sections[1],icon:"glyphicon glyphicon-cog",getRoute:function(e){var t,o;switch(this.parent._ctrlId){case"mainFrameNav":t=e.listGroups.settings.getActiveSwitcher()._id;break;case"settingsListGroup":case"settingsCategoriesDropdown":t=this._id}return o=e.tabs[t].getActiveSwitcher()._id,"/#/settings/"+t+"/"+o},validateCatId:function(e,o){return t(function(t){t(o.listGroups.settings.switcherIds.indexOf(e.catId)>-1?!0:!1)})},validateSubcatId:function(e,o){return t(function(t){t(o.tabs[e.catId].switcherIds.indexOf(e.subcatId)>-1?!0:!1)})}}]};return n};e.$inject=[],t.$inject=["$rootScope","$q","hardDataService"],angular.module("appModule").service("appFrameConf",e),angular.module("appModule").service("mainFrameConf",t)}(),function(){var e=function(e,t){var o=t.get(),r={_ctrlId:"mainFrameNav",icon:"glyphicon glyphicon-option-horizontal",switchers:[{_id:"settings"},{_id:"separator"},{_id:"about"},{_id:"help"},{_id:"contact"},{_id:"separator"},{_id:"logout",route:"/#/start/login",label:o.imperatives[12],icon:"glyphicon glyphicon-off",onClick:function(){e.logout()}}]};return r};e.$inject=["$rootScope","hardDataService"],angular.module("appModule").service("mainFrameNavConf",e)}(),function(){var e=function(e,t){var o=e.get();return{infoModal:new t({id:"infoModal"}),confirmModal:new t({id:"confirmModal"}),confirmDangerModal:new t({id:"confirmDangerModal"}),accountRequiredModal:new t({typeId:"infoModal",title:o.status[5],message:o.rejections[0]}),tryAgainLaterModal:new t({typeId:"infoModal",title:o.status[6],message:o.rejections[1]}),tryToRefreshModal:new t({typeId:"infoModal",title:o.status[6],message:o.rejections[7]}),passResetDoneModal:new t({typeId:"infoModal",title:o.labels[4],message:o.information[2]}),deactivationDoneModal:new t({typeId:"infoModal",title:o.count[7],message:o.information[6]}),confirmProceedModal:new t({typeId:"confirmModal",message:o.warnings[0]}),confirmDeactivationModal1:new t({typeId:"confirmDangerModal",title:o.labels[24],message:o.warnings[1]}),confirmDeactivationModal2:new t({typeId:"confirmDangerModal",title:o.labels[24],message:o.warnings[3]}),deleteReportModal:new t({typeId:"confirmDangerModal",title:o.labels[28]})}};e.$inject=["hardDataService","MyModal"],angular.module("appModule").service("modalsConf",e)}(),function(){var e=function(){var e={_id:"auth_token",type:"cookie",daysToExpire:30};return{authToken:e}};e.$inject=[],angular.module("appModule").service("myStorageConf",e)}(),function(){var e=function(e,t){var o=t.get(),r={_ctrlId:"settingsListGroup",switchers:[{_id:"application",label:o.sections[7],onActivate:function(){e.globalFormModels.appConfigModel.set()}},{_id:"account",label:o.sections[8],onActivate:function(){e.globalFormModels.personalDetailsModel.set(),e.globalFormModels.passwordModel.clear()}},{_id:"danger",label:o.sections[24],onActivate:function(){e.globalFormModels.deactivationModel.clear()}}]};return r};e.$inject=["$rootScope","hardDataService"],angular.module("appModule").service("settingsListGroupConf",e)}(),function(){var e=function(e,t){var o=t.get(),r={_ctrlId:"startTabs",switchers:[{_id:"login",label:o.sections[17],info:o.description[0],route:"/#/start/login",onActivate:function(){e.globalFormModels.userModel.clearErrors()}},{_id:"register",label:o.sections[18],info:o.description[1],route:"/#/start/register",onActivate:function(){e.globalFormModels.userModel.clearErrors()}},{_id:"recover",label:o.labels[4],info:o.description[2],route:"/#/start/recover",onActivate:function(){e.globalFormModels.userModel.clearErrors()}},{_id:"status",label:o.sections[23],info:o.information[8],route:"/#/start/status",onActivate:function(){e.globalFormModels.userModel.clearErrors()}}]};return r},t=function(e,t){var o=t.get(),r={application:{_ctrlId:"appTabs",switchers:[{_id:"appearance",route:"/#/settings/application/appearance",label:o.sections[10],info:o.imperatives[34],onActivate:function(){e.globalFormModels.appConfigModel.set()}},{_id:"regional",route:"/#/settings/application/regional",label:o.sections[9],info:o.description[5],onActivate:function(){e.globalFormModels.appConfigModel.set()}}]},account:{_ctrlId:"accountTabs",switchers:[{_id:"personal-details",route:"/#/settings/account/personal-details",label:o.sections[12],info:o.description[3],onActivate:function(){e.globalFormModels.personalDetailsModel.set()}},{_id:"password",route:"/#/settings/account/password",label:o.labels[2],info:o.description[4],onActivate:function(){e.globalFormModels.passwordModel.clear()}}]},danger:{_ctrlId:"dangerTabs",switchers:[{_id:"deactivate",route:"/#/settings/danger/deactivate",label:o.imperatives[26],info:o.warnings[4],onActivate:function(){e.globalFormModels.deactivationModel.clear()}}]}};return r},o=function(e){var t=function(){if(e.apiData.report)return"/#/report/"+this._id+"?id="+e.apiData.report._id},o={_ctrlId:"reportTabs",switchers:[{_id:"photos",getRoute:t,onActivate:function(){}},{_id:"comments",getRoute:t,onActivate:function(){}}],hardData:{switchers_label:["sections",[5,6]]}};return o};e.$inject=["$rootScope","hardDataService"],t.$inject=["$rootScope","hardDataService"],o.$inject=["$rootScope"],angular.module("appModule").service("startTabsConf",e),angular.module("appModule").service("settingsTabsConf",t),angular.module("appModule").service("reportTabsConf",o)}(),function(){var e=function(){var e={_ctrlId:"topNavMenu",switchers:[{_id:"home"},{_id:"search"},{_id:"newreport"}]};return e};e.$inject=[],angular.module("appModule").service("topNavMenuConf",e)}(),function(){var e=function(e,t,o,r,n,a,i,c,s,l,u,d,p,m){d.init(),e.ui=l,e.hardData=s.get(),e.Math=window.Math,e.apiData={loggedInUser:void 0,profileUser:void 0,reportUser:void 0,report:void 0,deactivationReasons:void 0,contactTypes:void 0,stats:void 0,payment:void 0},e.localData={countries:{data:void 0}},e.globalFormModels={userModel:new p.MyFormModel("userModel",["email","username","password","firstname","lastname","countryFirstLetter","country"],(!1)),appConfigModel:new p.MyFormModel("appConfigModel",["userId","language","theme"],(!0)),personalDetailsModel:new p.MyFormModel("personalDetailsModel",["_id","email","username","firstname","lastname","countryFirstLetter","country","registration_date"],(!0)),passwordModel:new p.MyFormModel("passwordModel",["currentPassword","password"],(!1)),deactivationModel:new p.MyFormModel("deactivationModel",["deactivationReasonId"],(!1)),reportSearchModel:new p.MyFormModel("reportSearchModel",["title","categoryId","subcategoryId"],(!0))},e.logout=function(t,o){u.reInitCtrls(l),e.resetGlobalFormModels(),c.setAsLoggedOut(function(){var e={tab:"login"};t&&Object.assign(e,t),a.go("app.start",e),o&&o()})},e.resetGlobalFormModels=function(){for(var t=Object.keys(e.globalFormModels),o=0;o<t.length;o++)e.globalFormModels[t[o]].set({})},e.$watch(function(){return i.authToken.getValue()},function(e){m.setDefaultHeaders({"x-access-token":e}),!e&&c.state.loggedIn&&o.location.reload()})};e.$inject=["$rootScope","$scope","$window","$timeout","$moment","$state","storageService","authService","hardDataService","ui","uiSetupService","socketService","myClass","Restangular"],angular.module("appModule").controller("AppController",e)}(),function(){var e=function(e,t,o,r){e.runTest=function(){var t=new o(r.myDataModel);console.log(t.set(e.apiData.report.plain()))}};e.$inject=["$rootScope","$scope","MyDataModel","ReportsRest"],angular.module("appModule").controller("MainController",e)}(),function(){var e=function(e,t,o,r,n){t.profileCollectionBrowser=r.profileCollectionBrowser,t.profileReportsContextMenu=new n(o.profileReportsContextMenu)};e.$inject=["$rootScope","$scope","contextMenuConf","reportsConf","MySwitchable"],angular.module("appModule").controller("ProfileController",e)}(),function(){var e=function(e,t,o,r,n,a){e.params=t,e.$watch("apiData.report",function(t){t&&t._isOwn()?(e.reportContextMenu=new a(r.reportContextMenuConf),e.reportContextMenu.data=t):e.reportContextMenu=null}),e.reportsService=o,e.commentsBrowser=n.reportCommentsBrowser};e.$inject=["$scope","$stateParams","reportsService","contextMenuConf","commentsConf","MySwitchable"],angular.module("appModule").controller("ReportController",e)}(),function(){var e=function(e,t,o,r,n){t.searchCollectionBrowser=r.searchCollectionBrowser,t.showMap=!0,t.toggleMap=function(){t.showMap=!t.showMap,t.showMap&&n.searchReportsMap.ins&&o(function(){google.maps.event.trigger(n.searchReportsMap.ins,"resize")})}};e.$inject=["$rootScope","$scope","$timeout","reportsConf","googleMapService"],angular.module("appModule").controller("SearchController",e)}(),function(){var e=function(e,t){e.$watch("ui.listGroups.settings.activeSwitcherId",function(o){angular.isDefined(o)&&(e.activeTabs=t.tabs[o])})};e.$inject=["$scope","ui"],angular.module("appModule").controller("SettingsController",e)}(),function(){var e=function(e,t){e.$watch(function(){return t.state.loggedIn},function(t){for(var o=0;o<3;o++)e.ui.tabs.start.switchers[o].isVisible=!t;e.ui.tabs.start.switchers[3].isVisible=t})};e.$inject=["$scope","authService"],angular.module("appModule").controller("StartController",e)}(),function(){angular.module("appModule").config(["$stateProvider",function(e){e.state("app.about",{url:"/about",resolve:{isAuthenticated:["authentication","resolveService",function(e,t){return t.isAuthenticated()}]},onEnter:["ui",function(e){e.frames.main.activateSwitcher("about"),e.menus.top.activateSwitcher("about"),e.frames.app.activateSwitcher("main")}]})}])}(),function(){angular.module("appModule").config(["$stateProvider",function(e){e.state("app",{"abstract":!0,resolve:{googleRecaptcha:["$q","$timeout",function(e,t){return e(function(e){var o="https://www.google.com/recaptcha/api.js?onload=captchaApiLoaded&render=explicit",r=!1;window.captchaApiLoaded=function(){e(r=!0)};var n=document.createElement("script");n.type="application/javascript",n.async=!0,n.src=o,document.body.appendChild(n),t(function(){r||e(!1)},2e4)})}],openExchangeRates:["$q","exchangeRateService",function(e,t){return e(function(o){var r=[];angular.forEach(t.config.availableRates,function(o,n){var a=e(function(e){$.getJSON(t.config.api+n+"&callback=?").then(function(o){t.data[n]=o,e(!0)},function(){e(!1)})});r.push(a)}),e.all(r).then(function(e){o(e.indexOf(!1)==-1)})})}],localData:["$q","$http","$rootScope","jsonService",function(e,t,o,r){return e(function(e){t.get("public/json/countries.json").success(function(t){r.sort.objectsByProperty(t,"name",!0,function(t){r.group.sortedObjectsByPropFirstLetter(t,"name",function(t){o.localData.countries.data=t,e(!0)})})}).error(function(){e(!1)})})}],hardData:["$q","$rootScope",function(e,t){return e(function(e){var o=function r(e){for(var t=0;t<e.length;t++)e[t].subcategories&&(e[t].subcategories=r(e[t].subcategories));return _.sortBy(e,"label")};t.hardData.reportCategories=o(t.hardData.reportCategories),e()})}],apiData:["$q","$http","$rootScope","$filter","DeactivationReasonsRest","ContactTypesRest",function(e,t,o,r,n,a){return e(function(i){var c=[];c.push(n.getList()),c.push(a.getList()),c.push(t.get("/stats")),e.all(c).then(function(e){_.every(e,["statusText","OK"])?(o.apiData.deactivationReasons=r("orderBy")(e[0].data.plain(),"index"),o.apiData.contactTypes=r("orderBy")(e[1].data.plain(),"index"),o.apiData.stats=e[2].data,i(!0)):i(!1)})})}],allResources:["$q","ui","googleRecaptcha","openExchangeRates","localData","hardData","apiData",function(e,t,o,r,n,a,i){return e(function(e,a){o&&r&&n&&i?e(!0):(a(),t.modals.tryAgainLaterModal.show())})}],authentication:["allResources","authService",function(e,t){return t.authenticate()}]}})}])}(),function(){angular.module("appModule").config(["$stateProvider",function(e){e.state("app.contact",{url:"/contact",resolve:{isAuthenticated:["authentication","resolveService",function(e,t){return t.isAuthenticated()}]},onEnter:["ui",function(e){e.frames.main.activateSwitcher("contact"),e.menus.top.activateSwitcher("contact"),e.frames.app.activateSwitcher("main")}]})}])}(),function(){angular.module("appModule").config(["$stateProvider",function(e){e.state("app.help",{url:"/help",resolve:{isAuthenticated:["authentication","resolveService",function(e,t){return t.isAuthenticated()}]},onEnter:["ui",function(e){e.frames.main.activateSwitcher("help"),e.menus.top.activateSwitcher("help"),e.frames.app.activateSwitcher("main")}]})}])}(),function(){angular.module("appModule").config(["$stateProvider",function(e){e.state("app.home",{url:"/home",resolve:{isAuthenticated:["authentication","resolveService",function(e,t){return t.isAuthenticated()}]},onEnter:["$rootScope","ui",function(e,t){e.$broadcast("initRecentlyViewedReports"),t.menus.top.activateSwitcher("home"),t.frames.main.activateSwitcher("home"),t.frames.app.activateSwitcher("main")}]})}])}(),function(){angular.module("appModule").config(["$stateProvider",function(e){e.state("app.newreport",{url:"/newreport",resolve:{isAuthenticated:["authentication","resolveService",function(e,t){return t.isAuthenticated()}]},onEnter:["ui",function(e){e.menus.top.activateSwitcher("newreport"),e.frames.main.activateSwitcher("newreport"),e.frames.app.activateSwitcher("main")}]})}])}(),function(){angular.module("appModule").config(["$stateProvider",function(e){e.state("app.profile",{url:"/profile?id",resolve:{isAuthenticated:["authentication","resolveService",function(e,t){return t.isAuthenticated()}],getUser:["isAuthenticated","$state","$stateParams","$q","UsersRest","ui",function(e,t,o,r,n,a){return r(function(e,r){n.getList({_id:o.id}).then(function(t){e(!0)},function(){r(),a.loaders.renderer.isLoading?t.go("app.start",{tab:"status"},{location:"replace"}):a.modals.tryAgainLaterModal.show()})})}]},onEnter:["ui",function(e){e.menus.top.activateSwitcher(),e.frames.main.activateSwitcher("profile"),e.frames.app.activateSwitcher("main")}]})}])}(),function(){angular.module("appModule").config(["$stateProvider",function(e){e.state("app.report",{url:"/report?id&edit",views:{tab:{templateUrl:"public/pages/lost-and-found-app-report-tab.html"}},resolve:{isAuthenticated:["authentication","resolveService","$state",function(e,t,o){return t.isAuthenticated(o.current.name)}],apiData:["isAuthenticated","$q","$rootScope","$state","$stateParams","$timeout","UsersRest","ReportsRest","authService","ui",function(e,t,o,r,n,a,i,c,s,l){return t(function(e,o){if(s.state.authenticated){var l=[];l.push(i.getList({reportId:n.id})),l.push(c.getList({_id:n.id,subject:"report"})),t.all(l).then(function(t){a(function(){e(!0)})},function(){o(),r.go("app.home")})}else o()})}]},onEnter:["apiData","$rootScope","$timeout","$stateParams","googleMapService","ui",function(e,t,o,r,n,a){e&&("1"===r.edit?t.$broadcast("editReport",{report:t.apiData.report}):n.singleReportMap.init(t.apiData.report),o(function(){a.menus.top.activateSwitcher(),a.frames.main.activateSwitcher("report"),a.frames.app.activateSwitcher("main")}))}]})}])}(),function(){angular.module("appModule").config(["$stateProvider",function(e){e.state("app.report.tab",{url:"/:tab",onEnter:["$stateParams","ui",function(e,t){t.tabs.report.activateSwitcher(e.tab)}]})}])}(),function(){angular.module("appModule").config(["$stateProvider",function(e){e.state("app.search",{url:"/search",resolve:{isAuthenticated:["authentication","resolveService",function(e,t){return t.isAuthenticated()}]},onEnter:["$timeout","googleMapService","ui",function(e,t,o){o.menus.top.activateSwitcher("search"),o.frames.main.activateSwitcher("search"),o.frames.app.activateSwitcher("main");var r=0;o.loaders.renderer.isLoading&&(r=4e3),e(function(){t.searchReportsMap.init()},r)}]})}])}(),function(){angular.module("appModule").config(["$stateProvider",function(e){e.state("app.settings1",{url:"/settings",resolve:{redirection:["$q","$timeout","$state","ui",function(e,t,o,r){return e(function(){var e=r.listGroups.settings.activeSwitcherId;t(function(){o.go("app.settings3",{catId:e,subcatId:r.tabs[e].activeSwitcherId},{location:"replace"})})})}]}})}])}(),function(){angular.module("appModule").config(["$stateProvider",function(e){e.state("app.settings2",{url:"/settings/:catId",resolve:{catId:["$timeout","$q","$state","$stateParams","ui",function(e,t,o,r,n){return t(function(t,a){var i=n.frames.main.getSwitcher("_id","settings");i.validateCatId(r,n).then(function(r){r?t():e(function(){o.go("app.settings1",{},{location:"replace"})})})})}],redirection:["catId","$timeout","$state","$stateParams","ui",function(e,t,o,r,n){t(function(){o.go("app.settings3",{catId:r.catId,subcatId:n.tabs[r.catId].activeSwitcherId},{location:"replace"})})}]}})}])}(),function(){angular.module("appModule").config(["$stateProvider",function(e){e.state("app.settings3",{url:"/settings/:catId/:subcatId",resolve:{params:["authentication","$timeout","$q","$state","$stateParams","ui",function(e,t,o,r,n,a){return o(function(e,i){var c=a.frames.main.getSwitcher("_id","settings");o.all([c.validateCatId(n,a),c.validateSubcatId(n,a)]).then(function(o){o[0]?o[1]?e():t(function(){r.go("app.settings2",{catId:n.catId},{location:"replace"})}):t(function(){r.go("app.settings1",{},{location:"replace"})})})})}],isAuthenticated:["params","resolveService",function(e,t){return t.isAuthenticated()}]},onEnter:["$stateParams","ui",function(e,t){t.menus.top.activateSwitcher("settings"),t.listGroups.settings.activateSwitcher(e.catId),t.dropdowns.settingsCategories.activateSwitcher(e.catId),t.tabs[e.catId].activateSwitcher(e.subcatId),t.frames.main.activateSwitcher("settings"),t.frames.app.activateSwitcher("main")}]})}])}(),function(){angular.module("appModule").config(["$stateProvider",function(e){e.state("app.start",{url:"/start/:tab?action",resolve:{tab:["authentication","$q","$state","$stateParams","$timeout","authService","ui",function(e,t,o,r,n,a,i){return t(function(e,t){i.tabs.start.switcherIds.indexOf(r.tab)>-1?a.state.authenticated&&"status"!=r.tab?t("status"):a.state.authenticated||"status"!=r.tab?e():t("login"):t("login")}).then(function(){i.tabs.start.activateSwitcher(r.tab),i.frames.main.activateSwitcher(),i.frames.app.activateSwitcher("start"),i.listGroups.settings.getFirstSwitcher().activate(),angular.forEach(i.listGroups.settings.switchers,function(e){i.tabs[e._id].getFirstSwitcher().activate()})},function(e){n(function(){o.go("app.start",{tab:e},{location:"replace"})})})}]},onEnter:["$rootScope","$stateParams","$timeout","ui",function(e,t,o,r){switch(t.action){case"deactivation":o(function(){r.modals.deactivationDoneModal.show()},5e3);break;case"pass_reset":"login"==t.tab&&o(function(){e.ui.modals.passResetDoneModal.show()},5e3)}}]})}])}(),function(){angular.module("appModule").config(["$stateProvider",function(e){e.state("app.upgrade",{url:"/upgrade?id",resolve:{isAuthenticated:["authentication","resolveService",function(e,t){return t.isAuthenticated()}],id:["isAuthenticated","$q","$rootScope","$state","$stateParams","authService",function(e,t,o,r,n,a){return t(function(e){n.id?e():a.state.authenticated?r.go("app.upgrade",{id:o.apiData.loggedInUser._id},{location:"replace"}):r.go("app.start",{tab:"status"},{location:"replace"})})}],getPayment:["id","$q","$http","$rootScope","$moment","storageService","ui",function(e,t,o,r,n,a,i){return t(function(e,t){if(r.apiData.loggedInUser.paymentId){var c={paymentId:r.apiData.loggedInUser.paymentId,headers:{"x-access-token":a.authToken.getValue()}};o.get("/paypal/payment",c).success(function(e){e.create_time=n(e.create_time).format("DD-MM-YYYY, HH:mm"),r.apiData.payment=e}).error(function(e){i.modals.tryAgainLaterModal.show()})}e()})}]},onEnter:["ui",function(e){e.menus.top.activateSwitcher(),e.frames.main.activateSwitcher("upgrade"),e.frames.app.activateSwitcher("main")}]})}])}(),function(){var e=function(e,t,o,r,n,a,i,c,s){var l={setup:function(){s.setBaseUrl("/api"),s.setFullResponse(!0),s.setRestangularFields({id:"_id"}),s.addResponseInterceptor(l.interceptResponse),s.addElementTransformer("users",!1,function(e){return e.username?(e.truncatedUsername=e.username.truncate(15),e.userSince=r.duration(r(new Date).diff(r(e.registration_date))).humanize(),e.countryFirstLetter=e.country[0]):e.user&&(e.user.truncatedUsername=e.user.username.truncate(15),e.user.userSince=r.duration(r(new Date).diff(r(e.user.registration_date))).humanize(),e.user.countryFirstLetter=e.user.country[0]),e}),s.addElementTransformer("reports",!1,function(e){return e.truncatedTitle=e.title.truncate(25),e.startEvent.date=new Date(e.startEvent.date),e.formattedDate=r(e.startEvent.date).format("DD-MM-YYYY"),e.formattedDateAdded=r(e.dateAdded).format("DD-MM-YYYY HH:mm"),e.pastSinceAdded=r.duration(r(new Date).diff(r(e.dateAdded))).humanize(),l.createReportFullCategoryString(e),e}),s.addElementTransformer("comments",!1,function(e){return e.pastSinceAdded=r.duration(r(new Date).diff(r(e.dateAdded))).humanize(),e})},interceptResponse:function(r,l,u,d,p,m){r.authToken&&a.authToken.setValue(r.authToken),r.msg&&o(function(){var o={title:r.msg.title,message:r.msg.info};r.msg.reload&&(o.hideCb=function(){t.location.reload()}),e.ui.modals.infoModal.show(o)},100);var f;switch(u){case"app_configs":var h=s.restangularizeElement(void 0,r.appConfig,"app_configs");e.apiData.loggedInUser.appConfig=h;break;case"users":switch(l){case"getList":p.config.params&&(p.config.params._id?e.apiData.profileUser=r[0]:p.config.params.reportId&&(e.apiData.reportUser=r[0]));break;case"post":return r.user.appConfig=r.appConfig,e.apiData.loggedInUser=r.user,s.restangularizeElement(void 0,e.apiData.loggedInUser.appConfig,"app_configs"),s.restangularizeCollection(void 0,[r.user],"users");case"put":return e.apiData.loggedInUser=r.user,r.user}break;case"reports":switch(l){case"getList":if(p.config.params)switch(p.config.params.subject){case"report":return e.apiData.report=r.report,e.apiData.loggedInUser.reportsRecentlyViewed=r.reportsRecentlyViewed,[r.report];case"recently_viewed_reports":return i.recentlyViewedCollectionBrowser.setData(r),r.collection;case"user_reports":return i.profileCollectionBrowser.setData(r),r.collection;case"reports":return i.searchCollectionBrowser.setData(r),n.searchReportsMap.addMarkers(r.collection),r.collection;case"new_reports":return i.recentlyReportedCollectionBrowser.setData(r),r.collection}break;case"post":return s.restangularizeElement(void 0,r,"reports");case"put":return r}break;case"comments":switch(l){case"getList":for(f in r.collection)r.collection[f].user=r.users[f];c.reportCommentsBrowser.setData(r)}return r.collection;case"payments":switch(l){case"getList":e.apiData.payment=r[0]}}return r},createReportFullCategoryString:function(t){var o=_.find(e.hardData.reportCategories,function(e){return e._id==t.categoryId}),r=_.find(o.subcategories,function(e){return e._id==t.subcategoryId});t.fullCategory=o.label+" / "+r.label}};return l};e.$inject=["$rootScope","$window","$timeout","$moment","googleMapService","storageService","reportsConf","commentsConf","Restangular"],angular.module("appModule").service("apiService",e)}(),function(){var e=function(e,t,o,r,n,a){var i={state:{authenticated:!1,loggedIn:!1},authenticate:function(){return o(function(e){if(i.state.authenticated)i.state.loggedIn=!0,e(!0);else{var t=r.authToken.getValue();t?a.post({authToken:t}).then(function(t){i.setAsLoggedIn(function(){e(!0)})},function(t){i.setAsLoggedOut(function(){e(!1)})}):i.setAsLoggedOut(function(){e(!1)})}})},setAsLoggedIn:function(o){i.state.authenticated=!0,i.state.loggedIn=!0;var r=e.apiData.loggedInUser.appConfig;r.language!=n.language||r.theme!=n.theme?t.location.reload():(e.globalFormModels.personalDetailsModel.set(e.apiData.loggedInUser),e.globalFormModels.appConfigModel.set(e.apiData.loggedInUser.appConfig),o&&o())},setAsLoggedOut:function(t){i.state.authenticated=!1,i.state.loggedIn=!1,r.authToken.remove(),e.apiData.loggedInUser=void 0,t&&t()}};return i};e.$inject=["$rootScope","$window","$q","storageService","sessionConst","UsersRest"],angular.module("appModule").service("authService",e)}(),function(){var e=function(e,t){var o={getCredentials:function(o,r){return r.authToken=t.authToken.getValue(),e.post("/get_aws3_upload_credentials",r,{headers:{subject:o}})},makeRequest:function(t,o){return e.post(t,o,{transformRequest:angular.identity,headers:{"Content-Type":void 0}})}};return o};e.$inject=["$http","storageService"],angular.module("appModule").service("aws3Service",e)}(),function(){var e=function(){var e={api:"http://api.fixer.io/latest?base=",availableRates:{USD:{sign:"$"},EUR:{sign:"€"},GBP:{sign:"£"}},decimalPlaces:2},t={},o={format:function(t,o){return angular.isDefined(t)&&angular.isDefined(o)?accounting.formatMoney(t,e.availableRates[o].sign+" ",e.decimalPlaces,",","."):null},convert:function(e,r,n){return Object.keys(t).length>0&&angular.isDefined(e)&&angular.isDefined(r)&&angular.isDefined(n)?(fx.settings={from:r},fx.base=t[n].base,fx.rates=t[n].rates,o.format(fx.convert(e,{to:n}),n)):null}};return{config:e,data:t,methods:o}};e.$inject=[],angular.module("appModule").service("exchangeRateService",e)}(),function(){var e=function(e,t,o,r){var n=this;return n.geo={allowed:void 0},n.singleReportMap={init:function(e){var o=new google.maps.Geocoder,r=new google.maps.Map(document.getElementById("reportMap")),n=new google.maps.LatLng(e.startEvent.geolocation.lat,e.startEvent.geolocation.lng);google.maps.event.addListener(r,"idle",function(){google.maps.event.trigger(r,"resize")}),o.geocode({placeId:e.startEvent.placeId},function(e,o){t(function(){var t=new google.maps.InfoWindow;r.setCenter(n),r.setZoom(13);var o=new google.maps.Marker({map:r,position:n});o.addListener("mouseover",function(){t.setContent(e[0].formatted_address),t.open(r,o)}),o.addListener("mouseout",function(){t.close()})},1e3)})}},n.searchReportsMap={init:function(){angular.isUndefined(n.geo.allowed)?e(function(e){navigator.geolocation.getCurrentPosition(function(t){e({geoAllowed:!0,coords:t.coords})},function(){e({geoAllowed:!1,coords:{latitude:0,longitude:0}})},{enableHighAccuracy:!0,timeout:5e3,maximumAge:0})}).then(function(e){n.searchReportsMap.ins=new google.maps.Map(document.getElementById("reportsMap"),{center:new google.maps.LatLng(e.coords.latitude,e.coords.longitude),zoom:5}),n.geo.allowed=e.geoAllowed,n.searchReportsMap.markers||n.searchReportsMap.addMarkers(r.searchCollectionBrowser.collection)}):google.maps.event.trigger(n.searchReportsMap.ins,"resize")},addMarkers:function(e){if(angular.isDefined(n.geo.allowed)){var o;n.searchReportsMap.markerCluster&&n.searchReportsMap.markerCluster.clearMarkers(),n.searchReportsMap.markers=[],t(function(){for(o=0;o<e.length;o++)n.searchReportsMap.addSingleMarker(e,o);var t=n.searchReportsMap.ins,r=n.searchReportsMap.markers,a="node_modules/js-marker-clusterer/images/m";n.searchReportsMap.markerCluster=new MarkerClusterer(t,r,{imagePath:a})},1e3)}},addSingleMarker:function(e,t){var r=new google.maps.InfoWindow,a="lost"==e[t].startEvent.group?"red-dot.png":"blue-dot.png",i=new google.maps.Marker({map:n.searchReportsMap.ins,position:new google.maps.LatLng(e[t].startEvent.geolocation.lat,e[t].startEvent.geolocation.lng),icon:"http://maps.google.com/mapfiles/ms/icons/"+a});i.addListener("mouseover",function(){r.setContent(e[t].title),r.open(n.searchReportsMap.ins,i)}),i.addListener("mouseout",function(){r.close()}),i.addListener("click",function(){o.go("app.report",{id:e[t]._id})}),n.searchReportsMap.markers.push(i)}},n};e.$inject=["$q","$timeout","$state","reportsConf"],angular.module("appModule").service("googleMapService",e)}(),function(){var e=function(e){var t={captchas:{},load:function(e,o,r){if(window.grecaptcha)return t.captchas[e]={actionName:o},window.grecaptcha.render(e,{sitekey:"6LdwIyQTAAAAABj159-NBLYxFY4vPRuqEBrYB_aE",callback:function(){r()}})},reset:function(e){window.grecaptcha&&window.grecaptcha.reset(e)},getResponse:function(e){
if(window.grecaptcha&&e)return window.grecaptcha.getResponse(e.grecaptchaId)},shouldBeVisible:function(o,r){window.grecaptcha?e.get().then(function(e){var n=e.data.badActionsCount;r(n[t.captchas[o].actionName]>=n.max)}):r(!1)}};return t};e.$inject=["sessionService"],angular.module("appModule").service("grecaptchaService",e)}(),function(){var e=function(e,t){var o={all:e,get:function(){return e[t.language||"en"]},bind:function(e){var t;if(e.hardData?t=e.hardData:e.ins&&e.ins.hardData&&(t=e.ins.hardData),t){var r=o.get();angular.forEach(t,function(t,o){var n=t[0];if(Array.isArray(t[1])){var a=t[1],i=o.split("_");if(2==i.length&&"switchers"==i[0]){var c=0;o=i[1],angular.forEach(e.ins.switchers,function(e,t){"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(e[o]=r[n][a[c++]])})}else e[o]=[],angular.forEach(a,function(t){e[o].push(r[n][t])})}else{var s=t[1];e[o]=r[n][s]}})}e.ins&&angular.forEach(e.ins.switchers,function(e,t){"object"==_typeof(e.label)&&(e.label=e.label[o.get()._id])})}};return o};e.$inject=["hardDataConst","sessionConst"],angular.module("appModule").service("hardDataService",e)}(),function(){var e=function(){var e={firstLettersArray:function(e,t,o){try{for(var r=Object.keys(e),n=[],a=[],i=0;i<r.length;++i)n.push(e[r[i]][t][0]);$.each(n,function(e,t){$.inArray(t,a)===-1&&a.push(t)}),o(a)}catch(c){o()}},firstElemOf:function(e){return Array.isArray(e)?e[0]:e[Object.keys(e)[0]]}},t={objectByProperty:function(e,t,o,r){for(var n=0;n<e.length;n++)e[n][t]==o&&r(e[n]);r(null)}},o={objectsByProperty:function(e,t,o,r){e.sort(function(e,r){return e[t]>r[t]?o?1:-1:e[t]<r[t]?o?-1:1:0}),r&&r(e)}},r={sortedObjectsByPropFirstLetter:function(e,t,o){for(var r,n=[],a=0;a<e.length;a++){var i=e[a][t][0];i!==r&&(r=i,n.push({label:r,children:[]})),n[n.length-1].children.push(e[a])}o(n)}},n={objectsByProperty:function(e,t,o){var r=Object.keys(t)[0],n=t[r],a=[];angular.forEach(e,function(e){e[r]==n&&a.push(e)}),o(a)}};return{get:e,find:t,sort:o,group:r,filter:n}};e.$inject=[],angular.module("appModule").service("jsonService",e)}(),function(e){var t=function(e){var t={home:"http://192.168.43.4:7100",work:"",school:"",current:"home"},o={allowSendingLogs:!0},r={api:[]},n=function(e){i(e,void 0)},a=function(){for(var e=Object.keys(r),t=0;t<e.length;++t)n(e[t])},i=function(r,n){if(o.allowSendingLogs){var a=t[t.current]+"/"+r;e({url:a,method:"POST",data:n,headers:{"Content-Type":"application/json"}})}},c=function(e,t,o){e&&(o?console.log(t,o):console.log(t))};return{urls:t,options:o,logs:r,reset:n,resetAll:a,post:i,log:c}};t.$inject=["$http"],e?module.exports=(new t).logs:(t.$inject=["$http"],angular.module("appModule").service("logService",t))}("undefined"!=typeof module&&module.exports),function(){var e=function(e,t,o,r){return{isAuthenticated:function(n){return e(function(e,a){o.state.authenticated?e():(a(),"app.start"==n?r.modals.accountRequiredModal.show():t.go("app.start",{tab:"status"},{location:"replace"}))})}}};e.$inject=["$q","$state","authService","ui"],angular.module("appModule").service("resolveService",e)}(),function(){var e=function(e){var t={get:function(t){return e.get("/session")}};return t};e.$inject=["$http"],angular.module("appModule").service("sessionService",e)}(),function(){var e=function(e){var t=this;return t.init=function(){t.socket=io("http://localhost:8080"),t.socket.on("UpdateAppStats",t.onUpdateAppStats)},t.onUpdateAppStats=function(t){Object.assign(e.apiData.stats,t),e.$apply()},t};e.$inject=["$rootScope"],angular.module("appModule").service("socketService",e)}(),function(){var e=function(e,t){var o={};return angular.forEach(e,function(e,r){o[r]=new t(e)}),o};e.$inject=["myStorageConf","MyStorageItem"],angular.module("appModule").service("storageService",e)}(),function(){var e=function(e,t,o,r,n,a,i,c,s,l,u){angular.forEach(t.switchers,function(e){_.assign(_.find(o.switchers,function(t){return t._id==e._id}),e),_.assign(_.find(c.switchers,function(t){return t._id==e._id}),e)});var d={frames:{app:new l.MySwitchable(e),main:new l.MySwitchable(t)},menus:{top:new l.MySwitchable(o)},listGroups:{settings:new l.MySwitchable(r)},tabs:{start:new l.MySwitchable(n),application:new l.MySwitchable(a.application),account:new l.MySwitchable(a.account),payment:new l.MySwitchable(a.payment),danger:new l.MySwitchable(a.danger),report:new l.MySwitchable(i)},dropdowns:{mainFrameNav:new l.MySwitchable(c),settingsCategories:new l.MySwitchable($.extend(!0,{_ctrlId:"settingsCategoriesDropdown","class":"dropdown"},r))},modals:s,loaders:{renderer:new l.MyLoader}};return u.bindGetRouteMethod(d),d};e.$inject=["appFrameConf","mainFrameConf","topNavMenuConf","settingsListGroupConf","startTabsConf","settingsTabsConf","reportTabsConf","mainFrameNavConf","modalsConf","myClass","uiSetupService"],angular.module("appModule").service("ui",e)}(),function(){var e=function(){var e={bindGetRouteMethod:function(e){var t=e.frames.main.getSwitcher("_id","settings");e.dropdowns.mainFrameNav.getSwitcher("_id","settings").getRoute=function(){return t.getRoute.call(this,e)},angular.forEach(e.listGroups.settings.switchers,function(o,r){o.getRoute=function(){return t.getRoute.call(this,e)},e.dropdowns.settingsCategories.switchers[r].getRoute=function(){return t.getRoute.call(this,e)}})},reInitCtrls:function(e){}};return e};e.$inject=[],angular.module("appModule").service("uiSetupService",e)}(),function(){var e=function(){var e={themes:{standard:'<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" integrity="sha384-+ENW/yibaokMnme+vBLnHMphUYxHs34h9lpdbSLuAwGkOKFRl4C34WkjazBtb7eT" crossorigin="anonymous">',darkly:'<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/darkly/bootstrap.min.css" rel="stylesheet" integrity="sha384-S7YMK1xjUjSpEnF4P8hPUcgjXYLZKK3fQW1j5ObLSl787II9p8RO9XUGehRmKsxd" crossorigin="anonymous">',cerulean:'<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" integrity="sha384-zF4BRsG/fLiTGfR9QL82DrilZxrwgY/+du4p/c7J72zZj+FLYq4zY00RylP9ZjiT" crossorigin="anonymous">',slate:'<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/slate/bootstrap.min.css" rel="stylesheet" integrity="sha384-RpX8okQqCyUNG7PlOYNybyJXYTtGQH+7rIKiVvg1DLg6jahLEk47VvpUyS+E2/uJ" crossorigin="anonymous">',cosmo:'<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" integrity="sha384-h21C2fcDk/eFsW9sC9h0dhokq5pDinLNklTKoxIZRUn3+hvmgQSffLLQ4G4l2eEr" crossorigin="anonymous">'},include:function(t){"raw"!=t&&$("head").append(e.themes[t]),$("head").append('<link rel="stylesheet" href="public/appStyles.css" />')}};return e};e.$inject=[],angular.module("appModule").service("uiThemeService",e)}(),function(){var e=function(){var e=function(e){var t;t=e.split(",")[0].indexOf("base64")>=0?atob(e.split(",")[1]):unescape(e.split(",")[1]);for(var o=e.split(",")[0].split(":")[1].split(";")[0],r=new Uint8Array(t.length),n=0;n<t.length;n++)r[n]=t.charCodeAt(n);var a=new Blob([r],{type:o});return a};return{dataURItoBlob:e}};e.$inject=[],angular.module("appModule").service("utilService",e)}(),function(){var e=function(e,t,o,r,n,a,i,c,s,l,u){return{MySwitchable:e,MySwitcher:t,MyLoader:o,MyModal:r,MySrc:n,MyStorageItem:a,MyFormModel:i,MyCollectionBrowser:c,MySrcCollection:s,MyForm:l,MySrcAction:u}};e.$inject=["MySwitchable","MySwitcher","MyLoader","MyModal","MySrc","MyStorageItem","MyFormModel","MyCollectionBrowser","MySrcCollection","MyForm","MySrcAction"],angular.module("appModule").factory("myClass",e)}(),function(){var e=function t(e,o,r,n){var a=e.get(),t=function i(e){if(Object.assign(i.prototype,$.extend(!0,{},o.prototype)),Object.assign(this,e),this.ctrls=[{name:"pager",paramName:"page"},{name:"filterer",paramName:"filter"},{name:"sorter",paramName:"sort"},{name:"orderer",paramName:"order"}],this.filterer&&(this.filterer=new r(this.filterer),this.filterer._id="filterer"),this.sorter){this.sorter=new r(this.sorter),this.sorter._id="sorter";for(var t in this.sorter.switchers)this.sorter.switchers[t].onClick=this.onClick;this.orderer=new r({switchers:[{_id:"asc",label:a.status[3]},{_id:"desc",label:a.status[4]}]}),this.orderer._id="orderer"}this.loader=new n};return t.prototype.init=function(e){var t=this;t.loader.start(!1,function(){try{t.fetchData(t.createFetchQuery()).then(function(o){if(t.noPager&&(t.meta.count=t.collection.length),t.refresher={},t.meta.count>0){for(var n=Math.ceil(t.meta.count/t.singlePageSize),a=[],i=0;i<n;i++)a.push({_id:i+1,label:"#"+(i+1)});var c;t.pager&&(c=t.pager.activeSwitcherId),t.pager=new r({_id:"pager",switchers:a}),c&&t.pager.activateSwitcher(c)}else t.pager=void 0;var s=function(e){e.onClick=function(){t.onChoose(e)}};for(var l in t.ctrls)t[t.ctrls[l].name]&&angular.forEach(t[t.ctrls[l].name].switchers,s);t.loader.stop(function(){e&&e(!0)})},function(o){t.flush(),t.loader.stop(function(){e&&e(!1)})})}catch(o){t.flush(),t.loader.stop(function(){e&&e(!1)})}})},t.prototype.setData=function(e){this.meta=e.meta,this.collection=e.collection},t.prototype.onRefreshClick=function(){var e,t=this;t.pager&&(e=t.pager.activeSwitcherId),t.init(function(){t.pager&&angular.isDefined(e)&&(e<=t.pager.switcherIds.length?t.pager.activateSwitcher(e):(t.pager=void 0,t.onRefreshClick()))})},t.prototype.createFetchQuery=function(){var e={};return this.pager&&this.pager.activeSwitcherId?e.skip=(this.pager.activeSwitcherId-1)*this.singlePageSize:e.skip=0,this.filterer&&(e.filter=this.filterer.activeSwitcherId),this.sorter&&(e.sort=this.sorter.activeSwitcherId,this.orderer&&"desc"==this.orderer.activeSwitcherId&&(e.sort="-"+e.sort)),this.orderer&&(e.order=this.orderer.activeSwitcherId),e},t.prototype.getElemNumber=function(e){if(this.pager&&this.pager.activeSwitcherId)return(this.pager.activeSwitcherId-1)*this.singlePageSize+e+1},t.prototype.onChoose=function(e){var t,o=this;e._id!=e.parent.activeSwitcherId&&(e.activate(),o.pager&&(t=o.pager.activeSwitcherId),"pager"==e.parent._id&&o.init(function(){o.pager&&angular.isDefined(t)&&o.pager.activateSwitcher(t),"pager"!==e.parent._id&&o[e.parent._id].activateSwitcher(e._id)}))},t.prototype.flush=function(){this.pager=void 0,this.filterer=void 0,this.sorter=void 0,this.orderer=void 0},t.prototype.isReady=function(){return!this.loader.isLoading&&this.refresher},t};e.$inject=["hardDataService","MyCollectionSelector","MySwitchable","MyLoader"],angular.module("appModule").factory("MyCollectionBrowser",e)}(),function(){var e=function t(){var t=function(){};return t.prototype.selectAll=function(){for(var e=0;e<this.collection.length;e++)this.collection[e].isSelected=!0},t.prototype.deselectAll=function(){for(var e=0;e<this.collection.length;e++)this.collection[e].isSelected=!1},t.prototype.getSelectedCollection=function(){for(var e=[],t=0;t<this.collection.length;t++)this.collection[t].isSelected&&e.push(this.collection[t]);return e},t};e.$inject=[],angular.module("appModule").factory("MyCollectionSelector",e)}(),function(){var e=function t(){var e=function(){this.value=void 0,this.error={type:void 0,msg:void 0}},t=function(t){var o=function r(o){for(var n in o)_.isEmpty(o[n])?o[n]=new e:r(o[n]);return t};Object.assign(this,o(t))};return t.prototype={set:function(t){var o=function r(t,o){for(var n in t)t.hasOwnProperty(n)&&o.hasOwnProperty(n)&&(o[n]instanceof e?o[n].value=t[n]:r(t[n],o[n]));return o};return o(t,this)},getValues:function(){var t=function o(t,r){for(var n in t)t.hasOwnProperty(n)&&(t[n]instanceof e?r[n]=t[n].value:o(t[n],r[n]={}));return r};return t(this,{})}},t};e.$inject=[],angular.module("appModule").factory("MyDataModel",e)}(),function(){var e=function(t,o,r,n){return e=function(e){this.ctrlId=e.ctrlId,this.model=e.model,this.reload=e.reload,this.noLoader=e.noLoader,this.redirectOnSuccess=e.redirectOnSuccess,this.submitAction=e.submitAction,this.submitSuccessCb=e.submitSuccessCb,this.submitErrorCb=e.submitErrorCb,this.onCancel=e.onCancel},e.prototype.submit=function(){var e=this;e.scope.captcha&&e.scope.captcha.visible!==!1||e.scope.loader.start(!1,function(){e.model.trimValues(e.scope.ctrlId,function(){var o={};o.captchaResponse=n.getResponse(e.scope.captcha);var a=e.submitAction(o);a&&a.then(function(t){e.redirectOnSuccess||e.model.clearErrors(function(){r(function(){e.scope.loader.stop()})}),e.submitSuccessCb&&e.submitSuccessCb(t)},function(o){o&&o.data&&o.data.errors?e.model.bindErrors(o.data.errors,function(){r(function(){e.scope.loader.stop()})}):e.model.clearErrors(function(){r(function(){e.scope.loader.stop(function(){t.ui.modals.tryAgainLaterModal.show()})})}),e.scope.captcha&&n.shouldBeVisible(e.scope.captcha.ctrlId,function(t){r(function(){e.scope.captcha.visible=t},500)}),e.submitErrorCb&&e.submitErrorCb(o)})})})},e.prototype.clear=function(){this.model.clear()},e.prototype.reset=function(){this.model.clear(),this.model.set()},e};e.$inject=["$rootScope","$window","$timeout","grecaptchaService"],angular.module("appModule").factory("MyForm",e)}(),function(){var e=function t(e){var o=function(e,t,o){this.value=e,this.error=t,this.errorType=o},t=function(e,t,o){this._id=e,this.keys=t,this.allowUseDefaults=o,this.values={},this.defaults=void 0,this.clear()};return t.prototype={set:function(e){var t,r=this;"object"==("undefined"==typeof e?"undefined":_typeof(e))?_.isEmpty(e)?r.clear():(r.allowUseDefaults&&(r.defaults=e),t=e):this.allowUseDefaults&&r.defaults&&(t=r.defaults),t&&angular.forEach(r.keys,function(e){angular.isDefined(t[e])?r.values[e].value=t[e]:r.values[e]=new o(null,null,null)})},setValue:function(e,t){this.values[e]=new o(t,null,null)},setWithRestObj:function(e){var t=this,o={};angular.forEach(t.keys,function(t){o[t]=e[t]}),t.set(o)},setRestObj:function(e,t){var o=this;angular.forEach(o.keys,function(t){e[t]=o.values[t].value}),t&&t()},clear:function(){var e=this;angular.forEach(e.keys,function(t){e.values[t]=new o(null,null,null)})},trimValues:function(e,t){var o=this;angular.forEach(o.keys,function(t){if("number"!=typeof o.values[t].value){var r=$("#"+e+" #"+t);if(r.length>0){var n=$(r).val();if(n){var a=n.trim();o.values[t].value=a,$(r).val(a)}else o.values[t].value=null}}}),t&&t()},bindErrors:function(e,t){var o=this;angular.isDefined(e)?(angular.forEach(o.keys,function(t){e[t]?(o.values[t].errorType=e[t].kind,o.values[t].error=e[t].message):(o.values[t].errorType=null,o.values[t].error=null)}),t&&t()):t&&t()},clearErrors:function(e){var t=this;angular.forEach(t.keys,function(e){t.values[e].error=null,t.values[e].errorType=null}),e&&e()},getValue:function(e){return this.values[e].value},getValues:function(){var e=this,t={};return angular.forEach(e.keys,function(o){t[o]=e.values[o].value}),t}},t};e.$inject=["$timeout"],angular.module("appModule").factory("MyFormModel",e)}(),function(){var e=function t(e){var t=function(){this.isLoading=!1};return t.prototype.minLoadTime=500,t.prototype.start=function(t,o){var r=this;r.isLoading=!0,e(function(){o&&o(),t&&r.stop()},r.minLoadTime)},t.prototype.stop=function(e){this.isLoading=!1,e&&e()},t};e.$inject=["$timeout"],angular.module("appModule").factory("MyLoader",e)}(),function(){var e=function t(e,o){var t=function(e){Object.assign(this,e)};return t.prototype.prepareToShow=function(t,o){var r;this.typeId&&(r=e.ui.modals[this.typeId],r.flush()),r?(Object.assign(r,this),Object.assign(r,t),o(r)):(Object.assign(this,t),o(this))},t.prototype.show=function(t){var r=this;r.prepareToShow(t,function(t){e.isAnyModalOpen?($(".modal").modal("hide"),o(function(){$("#"+t.id).modal("show")},t.timeout)):o(function(){$("#"+t.id).modal("show")})})},t.prototype.hide=function(e){$("#"+this.id).modal("hide"),e&&o(function(){e()},this.timeout)},t.prototype.accept=function(){var e=this;$("#"+e.id).modal("hide"),e.acceptCb&&o(function(){e.acceptCb()},e.timeout)},t.prototype.dismiss=function(){var e=this;$("#"+e.id).modal("hide"),e.dismissCb&&o(function(){e.dismissCb()},e.timeout)},t.prototype.flush=function(){var e=Object.keys(this);for(var t in e)"id"!=e[t]&&(this[e[t]]=void 0)},t.prototype.timeout=500,t};e.$inject=["$rootScope","$timeout"],angular.module("appModule").factory("MyModal",e)}(),function(){var e=function t(e,o,r,n){var a=500,t=function(e){e&&(this.defaultUrl=e.defaultUrl,this.constructUrl=e.constructUrl,this.uploadRequest=e.uploadRequest,this.removeRequest=e.removeRequest),this.loader=new n};return t.prototype.load=function(e,t,n){var i=this;if(!e&&i.constructUrl&&(e=i.constructUrl(i.index)),t&&(i.url=void 0),e!=i.url)return i.loader.start(),i.deferred=o.defer(),i.deferred.promise.then(function(e){e||i.defaultUrl&&(i.url=i.defaultUrl),i.loader.stop(),n&&n(e)}),r(function(){i.url=e},a),i.deferred.promise},t.prototype.loadSecondary=function(){this.defaultUrl&&this.load(this.defaultUrl)},t.prototype.isDefaultUrlLoaded=function(){if(this.defaultUrl)return this.url==this.defaultUrl},t.prototype.update=function(e,t,r){var n=this;return o(function(o){n.loader.start(!1,function(){n.uploadRequest(e,r).then(function(e){e.success?(t?n.loader.stop():n.load(e.url,!0),o(!0)):(n.loader.stop(),o(!1))})})})},t.prototype.remove=function(e,t){var r=this;return e||(e={}),o(function(o){r.loader.start(!1,function(){e._id=r._id,r.removeRequest(e).then(function(e){e?t&&r.loadSecondary():r.loader.stop(),o(e)})})})},t};e.$inject=["$rootScope","$q","$timeout","MyLoader"],angular.module("appModule").factory("MySrc",e)}(),function(){var e=function t(e,o){var t=function(e){e&&(this.acceptedFiles=e.acceptedFiles,this.maxFiles=e.maxFiles,this.maxFileSize=e.maxFileSize,this.getFilesCount=e.getFilesCount)};return t.prototype.validate=function(e,t){var r=this;switch(e){case"updateSingle":return o(function(e){var o=r.getValidFileTypes();if(1==t.length){if(o.indexOf(t[0].type)==-1)return void e({success:!1,msgId:"WRONG_FILE_TYPE"});if(t[0].size>r.maxFileSize)return void e({success:!1,msgId:"FILE_TOO_LARGE"});e({success:!0})}else e({success:!1,msgId:"UPLOADING_TOO_MANY_FILES"})});case"addToSet":return o(function(e){if(t&&t.length>0){var o=_.uniqBy(t,"name");if(o.length==t.length){var n=r.getFilesCount();if(n<r.maxFiles){var a=r.maxFiles-n;if(t.length<=a){for(var i=r.getValidFileTypes(),c=0;c<t.length;c++){if(i.indexOf(t[c].type)==-1)return void e({success:!1,msgId:"WRONG_FILE_TYPE"});if(t[c].size>r.maxFileSize)return void e({success:!1,msgId:"FILE_TOO_LARGE"})}e({success:!0})}else e({success:!1,msgId:"UPLOADING_TOO_MANY_FILES"})}else e({success:!1,msgId:"MAX_FILES_UPLOADED"})}else e({success:!1,msgId:"INPUT_FILES_CONSISTS_OF_DUPLICATES"})}else e({success:!1,msgId:"NO_FILES_LOADED"})});case"delete":return o(function(e){e({success:!0})});default:return o(function(e){e({success:!1})})}},t.prototype.getValidFileTypes=function(){return this.acceptedFiles.split(",")},t.prototype.displayModalMessage=function(t,o){var r,n=e.globalFormModels.personalDetailsModel.getValue("username");switch(t){case"confirmDeletion":r={title:e.hardData.labels[28],acceptCb:o},e.ui.modals.confirmProceedModal.show(r);break;case"MAX_FILES_UPLOADED":r={title:n,message:e.hardData.rejections[4]},e.ui.modals.infoModal.show(r);break;case"UPLOADING_TOO_MANY_FILES":r={title:n,message:e.hardData.rejections[5]},e.ui.modals.infoModal.show(r);break;case"filenameAlreadyExists":r={title:n,message:e.hardData.rejections[6]},e.ui.modals.infoModal.show(r);break;case"WRONG_FILE_TYPE":r={title:n,message:e.hardData.rejections[2]},e.ui.modals.infoModal.show(r);break;case"FILE_TOO_LARGE":r={title:n,message:e.hardData.rejections[3]+this.maxFileSize/1024/1024+" Mb."},e.ui.modals.infoModal.show(r)}},t.createFormDataObject=function(e,t){var o=new FormData;return angular.forEach(e,function(e,t){o.append(t,e)}),o.append("file",t),o},t};e.$inject=["$rootScope","$q"],angular.module("appModule").factory("MySrcAction",e)}(),function(){var e=function t(e,o,r,n,a){var t=function i(e){Object.assign(i.prototype,r.prototype),e&&(this.remove=e.remove,this.srcArgs={defaultUrl:e.defaultUrl,constructUrl:e.constructUrl,uploadRequest:e.uploadRequest,removeRequest:e.removeRequest}),this.collection=[],this.loader=new a};return t.prototype.init=function(e,t){var r=this;e.length>0?r.loader.start(!1,function(){r.collection.length=0;var a=[];for(var i in e){var c=new n(r.srcArgs);c.index=Number(i),Object.assign(c,e[i]),r.collection.push(c),a.push(r.collection[i].load(c.constructUrl(i)))}o.all(a).then(function(e){r.loader.stop(),t&&t(e)})}):(r.collection.length=0,t&&t())},t.prototype.updateSingle=function(e,t){var o=this,r=new n(o.srcArgs);r.index=e.src.index,o.collection[r.index]=r,r.uploadRequest(e,void 0,0).then(function(e){e||(o.collection[src.index]=src),t&&t(e)})},t.prototype.addToSet=function(e,t){var r=this;r.loader.start(!1,function(){var a=[],i=r.collection.length;for(var c in e.inputData)if(e.inputData[c]instanceof File){var s=new n(r.srcArgs);s.index=Number(c)+i,r.collection.push(s),a.push(s.uploadRequest(e,c,Number(c)))}o.all(a).then(function(e){for(var o=e.length-1;o>=0;o--)e[o]||r.collection.splice(Number(o)+i,1);t&&t(e)})})},t.prototype.removeFromSet=function(t,o){var r=this;0===t.collection.length?e.ui.modals.infoModal.show({title:e.apiData.loggedInUser.username,message:e.hardData.rejections[8],hideCb:function(){o(!1)}}):e.ui.modals.confirmProceedModal.show({title:e.hardData.labels[28],acceptCb:function(){r.loader.start(!1,function(){var e=[];for(var n in t.collection)e.push(t.collection[n].index);r.remove(e).then(function(e){o&&o(!0,e.data)},function(e){o&&o(!1,e.data)})})},hideCb:function(){o&&o()}})},t.prototype.moveSingle=function(e,t,o){var r=this;r.collection.length>1&&r.loader.start(!1,function(){switch(t=r.collection.splice(t.index,1)[0],e){case"moveLeft":t.index>0?r.collection.splice(t.index-1,0,t):r.collection.splice(r.collection.length,0,t);break;case"moveRight":t.index<r.collection.length?r.collection.splice(t.index+1,0,t):r.collection.splice(0,0,t)}for(var n in r.collection)r.collection[n].index=Number(n);o&&o()})},t};e.$inject=["$rootScope","$q","MyCollectionSelector","MySrc","MyLoader"],angular.module("appModule").factory("MySrcCollection",e)}(),function(){var e=function t(e){var t=function(e){this._id=e._id,this.type=e.type,angular.isDefined(e.daysToExpire)&&(this.daysToExpire=e.daysToExpire)};return t.prototype.getValue=function(){switch(this.type){case"cookie":return e.cookie.get(this._id);case"localStorageItem":return e.get(this._id)}},t.prototype.setValue=function(t){switch(this.type){case"cookie":e.cookie.set(this._id,t,this.daysToExpire);break;case"localStorageItem":e.set(this._id,t)}},t.prototype.remove=function(){switch(this.type){case"cookie":e.cookie.remove(this._id);break;case"localStorageItem":e.remove(this._id)}},t};e.$inject=["localStorageService"],angular.module("appModule").factory("MyStorageItem",e)}(),function(){var e=function t(e,o,r){var t=function(e){Object.assign(this,$.extend(!0,{},e)),this.instantiateSwitchers()};return t.prototype.instantiateSwitchers=function(t,o){var r=this;t&&(r.switchers=t),r.switchers&&(r.switcherIds=[],angular.forEach(r.switchers,function(t,o){"object"==("undefined"==typeof t?"undefined":_typeof(t))&&(r.switchers[o]=new e(t,r),r.switcherIds.push(t._id))}),r.activeSwitcherId=r.switcherIds[0]),o&&o()},t.prototype.activateSwitcher=function(e){var t;switch(e){case"prev":t=this.getActiveSwitcherIndex(),t>0?this.switchers[t-1].activate():this.switchers[this.switchers.length-1].activate();break;case"next":t=this.getActiveSwitcherIndex(),t<this.switchers.length-1?this.switchers[t+1].activate():this.switchers[0].activate();break;default:var o=this.getSwitcher("_id",e);o?o.activate():this.activeSwitcherId=void 0}},t.prototype.getSwitcher=function(e,t){var o=this;return o.switchers?_.find(o.switchers,function(o){return o[e]==t}):null},t.prototype.getActiveSwitcher=function(){var e=this;return _.find(e.switchers,function(t){return t._id==e.activeSwitcherId})},t.prototype.getActiveSwitcherIndex=function(){for(var e=this.getActiveSwitcher(),t=0;t<this.switchers.length;t++)if(this.switchers[t]._id==e._id)return t;return-1},t.prototype.getFirstSwitcher=function(){return _.head(this.switchers)},t};e.$inject=["MySwitcher","jsonService","hardDataService"],angular.module("appModule").factory("MySwitchable",e)}(),function(){var e=function t(){var t=function(e,t){Object.assign(this,e),this.parent=t};return t.prototype.activate=function(e){this.parent.activeSwitcherId=this._id,!e&&this.onActivate&&this.onActivate()},t};e.$inject=[],angular.module("appModule").factory("MySwitcher",e)}(),function(){var e=function(e){return e.service("app_configs")};e.$inject=["Restangular"],angular.module("appModule").factory("AppConfigsRest",e)}(),function(){var e=function(e){return e.service("comments")};e.$inject=["Restangular"],angular.module("appModule").factory("CommentsRest",e)}(),function(){var e=function(e,t){var o=e.service("contact_types");return o};e.$inject=["Restangular","storageService"],angular.module("appModule").factory("ContactTypesRest",e)}(),function(){var e=function(e){return e.service("deactivation_reasons")};e.$inject=["Restangular"],angular.module("appModule").factory("DeactivationReasonsRest",e)}(),function(){var e=function(e){return e.service("payments")};e.$inject=["Restangular"],angular.module("appModule").factory("PaymentsRest",e)}(),function(){var e=function(e,t){var o=t.service("users");return t.extendModel("users",function(t){return t._isTheOneLoggedIn=function(){if(e.apiData.loggedInUser)return t._id==e.apiData.loggedInUser._id},t}),o};e.$inject=["$rootScope","Restangular"],angular.module("appModule").factory("UsersRest",e)}(),function(){var e=angular.module("appModule");e.directive("formActionBtns",function(){var e={restrict:"E",templateUrl:"public/directives/^/btns/formActionBtns/formActionBtns.html",transclude:!0,scope:{myForm:"="},controller:function(e){var t=["loginForm","registerForm","recoverForm","passwordForm","deactivationForm","reportSearchForm","contactForm","editReportForm","newReportForm","commentForm","upgradeForm"],o=["regionalForm","appearanceForm","personalDetailsForm","editReportForm","newReportForm","upgradeForm"],r=["editReportForm","newReportForm"];switch(e.myForm.showClearBtn=t.indexOf(e.myForm.ctrlId)>-1,e.myForm.showResetBtn=o.indexOf(e.myForm.ctrlId)>-1,e.myForm.showCancelBtn=r.indexOf(e.myForm.ctrlId)>-1,e.myForm.ctrlId){case"editReportForm":case"newReportForm":e.myForm.submitBtnPhraseIndex=4;break;case"loginForm":case"registerForm":case"recoverForm":case"commentForm":e.myForm.submitBtnPhraseIndex=3;break;case"contactForm":e.myForm.submitBtnPhraseIndex=4;break;case"regionalForm":case"appearanceForm":case"personalDetailsForm":case"passwordForm":e.myForm.submitBtnPhraseIndex=5;break;case"reportSearchForm":e.myForm.submitBtnPhraseIndex=17;break;case"upgradeForm":e.myForm.submitBtnPhraseIndex=36}e.onSubmit=function(){e.myForm.submit()},e.onClear=function(){e.myForm.clear()},e.onReset=function(){e.myForm.reset()},e.onCancel=function(){e.myForm.onCancel()}},compile:function(e,t){return function(e,t,o){}}};return e})}(),function(){var e=angular.module("appModule");e.directive("scrollTopBtn",function(){var e={restrict:"E",templateUrl:"public/directives/^/btns/scrollTopBtn/scrollTopBtn.html",controller:function(e){e.scroll=function(){$("html, body").animate({scrollTop:0},"fast")}}};return e})}(),function(){var e=angular.module("appModule");e.directive("appearanceForm",["$rootScope","AppConfigsRest","MyForm","Restangular",function(e,t,o,r){var n={restrict:"E",templateUrl:"public/directives/^/forms/appearanceForm/appearanceForm.html",scope:!0,controller:function(t){var n=e.globalFormModels.appConfigModel;t.myForm=new o({ctrlId:"appearanceForm",model:n,reload:!0,submitAction:function(t){n.setValue("userId",e.globalFormModels.personalDetailsModel.getValue("_id"));var o=r.copy(e.apiData.loggedInUser.appConfig);return n.setRestObj(o),o.put()}})}};return n}])}(),function(){var e=angular.module("appModule");e.directive("contactForm",["$rootScope","$http","$timeout","ContactTypesRest","myClass",function(e,t,o,r,n){var a={restrict:"E",templateUrl:"public/directives/^/forms/contactForm/contactForm.html",scope:!0,controller:function(e){var t=new n.MyFormModel("contactForm",["contactType","contactMsg"],(!1));e.myForm=new n.MyForm({ctrlId:"contactForm",model:t,submitAction:function(e){return r.post(t.getValues())},submitSuccessCb:function(e){t.clear()}})},compile:function(t,o){return function(t,o,r){t.$watch(function(){return e.apiData.contactTypes},function(e){t.contactTypes=e})}}};return a}])}(),function(){var e=angular.module("appModule");e.directive("deactivationForm",["$rootScope","$timeout","$filter","ui","DeactivationReasonsRest","myClass",function(e,t,o,r,n,a){var i={restrict:"E",templateUrl:"public/directives/^/forms/deactivationForm/deactivationForm.html",scope:!0,controller:function(t){var o=e.globalFormModels.deactivationModel;t.myForm=new a.MyForm({ctrlId:"deactivationForm",model:o,submitAction:function(t,r){return e.apiData.loggedInUser.remove(o.getValues())},submitSuccessCb:function(t){e.logout({action:"deactivation"})}}),t.onDeactivateClick=function(){t.myForm.model.getValue("deactivationReasonId")&&e.ui.modals.confirmDeactivationModal1.show({acceptCb:function(){e.ui.modals.confirmDeactivationModal2.show({acceptCb:function(){t.myForm.submit()}})}})}},compile:function(t,o){return function(t,o,r){t.$watch(function(){return e.apiData.deactivationReasons},function(e){t.deactivationReasons=e})}}};return i}])}(),function(){var e=angular.module("appModule");e.directive("loginForm",["$rootScope","$timeout","$state","authService","MyForm","UsersRest",function(e,t,o,r,n,a){var i={restrict:"E",templateUrl:"public/directives/^/forms/loginForm/loginForm.html",scope:!0,controller:function(i){var c=e.globalFormModels.userModel;i.myForm=new n({ctrlId:"loginForm",model:c,submitAction:function(e){var t={username:c.getValue("username"),password:c.getValue("password")};return a.post(t,void 0,{captcha_response:e.captchaResponse})},submitSuccessCb:function(e){r.setAsLoggedIn(function(){t(function(){o.go("app.start",{tab:"status"})})})},submitErrorCb:function(e){r.setAsLoggedOut()}})}};return i}])}(),function(){var e=angular.module("appModule");e.directive("passwordForm",["$rootScope","MyForm","Restangular",function(e,t,o){var r={restrict:"E",templateUrl:"public/directives/^/forms/passwordForm/passwordForm.html",scope:!0,controller:function(r){var n=e.globalFormModels.passwordModel;r.myForm=new t({ctrlId:"passwordForm",model:n,submitAction:function(t){var r=o.copy(e.apiData.loggedInUser);return r.currentPassword=n.getValue("currentPassword"),r.password=n.getValue("password"),r.put()},submitSuccessCb:function(e){n.clear()}})}};return r}])}(),function(){var e=angular.module("appModule");e.directive("personalDetailsForm",["$rootScope","MyForm","Restangular",function(e,t,o){var r={restrict:"E",templateUrl:"public/directives/^/forms/personalDetailsForm/personalDetailsForm.html",scope:!0,controller:function(r){r.countries=e.localData.countries,r.myForm=new t({ctrlId:"personalDetailsForm",model:e.globalFormModels.personalDetailsModel,submitAction:function(t){var n=o.copy(e.apiData.loggedInUser);return r.myForm.model.setRestObj(n),n.put()}})}};return r}])}(),function(){var e=angular.module("appModule");e.directive("recoverForm",["$rootScope","$http","MyForm",function(e,t,o){var r={restrict:"E",templateUrl:"public/directives/^/forms/recoverForm/recoverForm.html",scope:!0,controller:function(r){var n=e.globalFormModels.userModel;r.myForm=new o({ctrlId:"recoverForm",model:n,submitAction:function(e){return t.post("/recover",{email:n.getValue("email")},{headers:{captcha_response:e.captchaResponse}})},submitSuccessCb:function(t){e.ui.modals.infoModal.show({title:t.data.msg.title,message:t.data.msg.info})}})}};return r}])}(),function(){var e=angular.module("appModule");e.directive("regionalForm",["$rootScope","AppConfigsRest","MyForm","Restangular",function(e,t,o,r){var n={restrict:"E",templateUrl:"public/directives/^/forms/regionalForm/regionalForm.html",scope:!0,controller:function(t){var n=e.globalFormModels.appConfigModel;
t.myForm=new o({ctrlId:"regionalForm",model:n,reload:!0,submitAction:function(t){n.setValue("userId",e.globalFormModels.personalDetailsModel.getValue("_id"));var o=r.copy(e.apiData.loggedInUser.appConfig);return n.setRestObj(o),o.put()}})}};return n}])}(),function(){var e=angular.module("appModule");e.directive("registerForm",["$rootScope","$timeout","$state","authService","MyForm","UsersRest",function(e,t,o,r,n,a){var i={restrict:"E",templateUrl:"public/directives/^/forms/registerForm/registerForm.html",scope:!0,controller:function(i){i.countries=e.localData.countries;var c=e.globalFormModels.userModel;i.myForm=new n({ctrlId:"registerForm",model:c,submitAction:function(e){return a.post(c.getValues(),void 0,{captcha_response:e.captchaResponse})},submitSuccessCb:function(e){r.setAsLoggedIn(function(){t(function(){o.go("app.start",{tab:"status"})})})},submitErrorCb:function(e){r.setAsLoggedOut()}})}};return i}])}(),function(){var e=angular.module("appModule");e.directive("reportForm",["$rootScope","$timeout","$state","myClass","reportsService","Restangular",function(e,t,o,r,n,a){var i={restrict:"E",templateUrl:"public/directives/^/forms/reportForm/reportForm.html",scope:{action:"@"},controller:function(o){o.ui=e.ui,o.apiData=e.apiData,o.hardData=e.hardData,o.autocomplete={};var a=new Date;o.maxDate=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0,0),o.minDate=new Date(2e3,0,1),o.myModel=new r.MyFormModel("reportFormModel",n.formModelFields,(!0)),o.myModel.set({date:o.maxDate}),o.myForm=new r.MyForm({ctrlId:o.action+"Form",model:o.myModel,submitAction:n.getFormSubmitAction(o),onCancel:function(){t(function(){o.myForm.reset()}),window.history.back()}})},compile:function(t,o){return function(t,o,r){switch(t.action){case"editReport":e.$$listeners.editReport||e.$on("editReport",function(e,o){if(o.report){var r=new google.maps.Geocoder;r.geocode({placeId:o.report.startEvent.placeId},function(e,r){t.myModel.set({title:o.report.title,categoryId:o.report.categoryId,subcategoryId:o.report.subcategoryId,subsubcategoryId:o.report.subsubcategoryId,serialNo:o.report.serialNo,description:o.report.description,group:o.report.startEvent.group,date:o.report.startEvent.date,geolocation:e[0].formatted_address,details:o.report.startEvent.details})})}}),t.$on("$destroy",function(){e.$$listeners.editReport=null})}}}};return i}])}(),function(){var e=angular.module("appModule");e.directive("reportSearchForm",["$rootScope","myClass",function(e,t){var o={restrict:"E",templateUrl:"public/directives/^/forms/reportSearchForm/reportSearchForm.html",scope:!0,controller:function(o){o.reportCategories=e.hardData.reportCategories,o.myForm=new t.MyForm({ctrlId:"reportSearchForm",noLoader:!0,model:e.globalFormModels.reportSearchModel,submitAction:function(t){e.$broadcast("initSearchReports")}})}};return o}])}(),function(){var e=angular.module("appModule");e.directive("upgradeForm",["$http","$window","hardDataService","exchangeRateService","PaymentsRest","myClass",function(e,t,o,r,n,a){var i="USD",c="5.00",s=(new Date).getFullYear(),l={restrict:"E",templateUrl:"public/directives/^/forms/upgradeForm/upgradeForm.html",scope:{},controller:function(e){e.hardData=o.get(),e.currentYear=s;var r=["paymentMethod","creditCardType","creditCardNumber","creditCardExpireMonth","creditCardExpireYear","cvv2","firstname","lastname","amount","currency"];e.myModel=new a.MyFormModel("upgradePaymentModel",r,(!0)),e.myModel.set({paymentMethod:"credit_card",currency:i,amount:c,creditCardExpireMonth:1,creditCardExpireYear:s}),e.myForm=new a.MyForm({ctrlId:"upgradeForm",redirectOnSuccess:!0,model:e.myModel,submitAction:function(t){if("credit_card"==e.myModel.getValue("paymentMethod"))return n.post(e.myModel.getValues());var o={paymentMethod:e.myModel.getValue("paymentMethod"),amount:e.myModel.getValue("amount"),currency:e.myModel.getValue("currency")};return n.post(o)},submitSuccessCb:function(o){switch(e.myModel.getValue("paymentMethod")){case"credit_card":t.location.reload();break;case"paypal":t.open(o.data.url,"_self")}},submitErrorCb:function(e){console.log(e)}})},compile:function(e,t){return function(e,t,o){var n={};n[i]=c,angular.forEach(e.hardData.payment.currencies,function(e){if(e.value!=i){var t=r.methods.convert(c,i,e.value);n[e.value]=accounting.unformat(t)}}),e.$watch("myModel.values.currency.value",function(t,o){t!=o&&e.myModel.setValue("amount",n[t])})}}};return l}])}(),function(){var e=angular.module("appModule");e.directive("confirmDangerModal",function(){var e={restrict:"E",templateUrl:"public/directives/^/modals/confirmDangerModal/confirmDangerModal.html",scope:{ins:"="}};return e})}(),function(){var e=angular.module("appModule");e.directive("confirmModal",function(){var e={restrict:"E",templateUrl:"public/directives/^/modals/confirmModal/confirmModal.html",scope:{ins:"="}};return e})}(),function(){var e=angular.module("appModule");e.directive("infoModal",function(){var e={restrict:"E",templateUrl:"public/directives/^/modals/infoModal/infoModal.html",scope:{ins:"="}};return e})}(),function(){var e=angular.module("appModule");e.directive("imgCropWindow",["$rootScope","$window","$timeout","MySrcAction","MyModal","MyLoader","NUMS",function(e,t,o,r,n,a,i){var c="#cropImg",s="#cropInput",l=function(e){$(s).val(void 0),$(c).cropper("destroy"),$(c).attr("src",""),e.selectedFile=void 0},u={restrict:"E",templateUrl:"public/directives/^/windows/imgCropWindow/imgCropWindow.html",scope:{},controller:function(t){var l=new r({acceptedFiles:"image/png,image/jpg,image/jpeg",maxFileSize:i.photoMaxSize});t.modalWindow=new n({id:"imgCropModal",title:e.hardData.sections[19]}),t.loader=new a,t.selectedFile=void 0,t.mode="crop",t.onBrowseClick=function(){$(s).click()},t.onFileSelected=function(e){1==e.target.files.length&&l.validate("updateSingle",[e.target.files[0]]).then(function(r){r.success?t.loader.start(!1,function(){t.selectedFile=e.target.files[0],t.mode="crop",t.$apply(),$(c).cropper("replace",URL.createObjectURL(e.target.files[0])),o(function(){t.loader.stop()},a.prototype.minLoadTime)}):l.displayModalMessage(r.msgId)})},t.onZoomInClick=function(){$(c).cropper("zoom",.1)},t.onZoomOutClick=function(){$(c).cropper("zoom",-.1)},t.onRotateClick=function(){$(c).cropper("rotate",90)},t.onResetClick=function(){$(c).cropper("reset")},t.onSwitchModeClick=function(){"crop"==t.mode?(t.mode="move",$(c).cropper("setDragMode","move")):"move"==t.mode&&(t.mode="crop",$(c).cropper("setDragMode","crop"))}},compile:function(e,o){return function(e,o,r){e.$on("displayImgCropWindow",function(t,o){l(e),e.modalWindow.show({acceptCb:function(){if(e.selectedFile){var t=$(c).cropper("getCroppedCanvas").toDataURL(e.selectedFile.type);o.acceptCb(t)}}}),$(c).cropper({viewMode:1,aspectRatio:1,autoCropArea:.5,minCropBoxWidth:50,minCropBoxHeight:50,background:!1})}),angular.element(t).bind("resize",function(){e.selectedFile&&$(c).cropper("replace",URL.createObjectURL(e.selectedFile))})}}};return u}])}(),function(){var e=angular.module("appModule");e.directive("appStats",["$rootScope",function(e){var t={restrict:"E",templateUrl:"public/directives/^/tables/appStats/appStats.html",scope:!0,controller:function(t){t.hardData=e.hardData,t.apiData=e.apiData},compile:function(e,t){return function(e,t,o){}}};return t}])}(),function(){var e=angular.module("appModule");e.directive("auctionNumBox",["$rootScope","$sce","exchangeRateService",function(e,t,o){var r={restrict:"E",templateUrl:"public/directives/AUCTION/auctionNumBox/auctionNumBox.html",scope:{auction:"=auction"},controller:function(t){t.hardData=e.hardData,t.exchangeRateService=o,t.numValues=[{name:"initialValue",message:""},{name:"bidIncrement",message:""},{name:"minSellPrice",message:""}]},compile:function(e,r){return function(e,r,n){e.$watch(function(){return e.auction},function(r){if(r){var n=o.config.availableRates;for(var a in e.numValues){var i="";for(var c in n)if(c!=e.auction.currency){var s=o.methods.convert(e.auction[e.numValues[a].name],e.auction.currency,c);i+=s+"<br />"}e.numValues[a].message=t.trustAsHtml(i)}}})}}};return r}])}(),function(){var e=angular.module("appModule");e.directive("comments",["$rootScope","commentsConf","myClass","CommentsRest",function(e,t,o,r){var n={restrict:"E",templateUrl:"public/directives/COMMENT/comments/comments.html",scope:{ctrlId:"@"},controller:function(n){n.apiData=e.apiData,n.hardData=e.hardData,n.myForm=new o.MyForm({ctrlId:"commentForm",model:new o.MyFormModel("commentModel",["userId","content"],(!1)),submitAction:function(t){var o=e.globalFormModels.personalDetailsModel.getValue("_id");return n.myForm.model.setValue("userId",o),r.post(n.myForm.model.getValues(),{reportId:e.apiData.report._id})},submitSuccessCb:function(t){n.myForm.model.clear(),e.$broadcast("initReportComments")}}),n.init=function(){n.collectionBrowser=t.reportCommentsBrowser,n.commentContextMenuConf=t.commentContextMenuConf,n.collectionBrowser.init()},n.collectionBrowser||n.init()},compile:function(t,o){return function(t,o,r){e.$$listeners["init"+t.ctrlId]||e.$on("init"+t.ctrlId,function(e,o){t.init()}),t.$on("$destroy",function(){e.$$listeners["init"+t.ctrlId]=null})}}};return n}])}(),function(){var e=function(e,t,o,r){var n=t.get();return this.commentContextMenuConf={icon:"glyphicon glyphicon-option-horizontal",switchers:[{_id:"edit",label:n.imperatives[33],onClick:function(){}},{_id:"delete",label:n.imperatives[14],onClick:function(){this.parent.data.remove({reportId:e.apiData.report._id}).then(function(){e.$broadcast("initReportComments")})}}]},this.reportCommentsBrowser=new r.MyCollectionBrowser({singlePageSize:10,fetchData:function(t){if(e.apiData.report)return t.reportId=e.apiData.report._id,o.getList(t)}}),this};e.$inject=["$rootScope","hardDataService","CommentsRest","myClass"],angular.module("appModule").service("commentsConf",e)}(),function(){var e=angular.module("appModule");e.directive("myAlert",function(){var e={restrict:"E",template:'<div class="myAlert alert no_selection" ng-class="ctrlClass" role="alert" ng-bind="message" my-directive></div>',scope:{ctrlClass:"=",hardData:"="}};return e})}(),function(){var e=angular.module("appModule");e.directive("myBtn",["$rootScope",function(e){return{restrict:"E",replace:!0,templateUrl:"public/directives/my/myBtn/myBtn.html",scope:{ctrlClass:"=",clickAction:"=",clickArgs:"=",clickContext:"=",showModalId:"@",explicitLabel:"=",hardData:"="},controller:["$scope",function(e){}],compile:function(t,o){return function(t,o,r){t.showModalId?t.onClick=function(){e.$broadcast(t.showModalId)}:"function"==typeof t.clickAction&&(t.onClick=function(){t.clickContext?t.clickAction.call(t.clickContext,t.clickArgs):t.clickAction(t.clickArgs)})}}}}])}(),function(){var e=angular.module("appModule");e.directive("myCaptcha",["$timeout","grecaptchaService",function(e,t){var o={restrict:"E",template:'<div id="{{ ctrlId }}" ng-show="visible" style="margin-bottom: 20px;" my-directive></div>',scope:{ctrlId:"=",actionName:"="},controller:function(e,o){o(function(){e.grecaptchaId=t.load(e.ctrlId,e.actionName,function(){o(function(){e.visible=!1},1e3)})})},compile:function(o,r){return function(o,r,n){var a=$(r).parents(".myForm:first"),i=$(a).scope();o.$watch("visible",function(e){e===!0&&t.reset(o.grecaptchaId)}),e(function(){t.shouldBeVisible(o.ctrlId,function(e){i.captcha=o,o.visible=e})})}}};return o}])}(),function(){var e=angular.module("appModule");e.directive("myCollectionBrowser",["$rootScope",function(e){var t={restrict:"E",transclude:{frontctrls:"?frontctrls",endctrls:"?endctrls",extractrls:"?extractrls",elems:"?elems"},templateUrl:"public/directives/my/myCollectionBrowser/myCollectionBrowser.html",scope:{ins:"=",noScrollTopBtn:"="},controller:function(t){t.hardData=e.hardData}};return t}])}(),function(){var e=angular.module("appModule");e.directive("myCollectionElem",["$rootScope","MySwitchable",function(e,t){var o={restrict:"E",templateUrl:"public/directives/my/myCollectionElem/myCollectionElem.html",transclude:{titleSection:"?titleSection",avatarSection:"?avatarSection",infoSection:"?infoSection"},scope:{data:"=",contextMenuConf:"=",isSelectable:"="},controller:function(e){e.contextMenuConf&&(e.contextMenu=new t(e.contextMenuConf),e.contextMenu.data=e.data)},compile:function(e,t){return function(e,t,o){}}};return o}])}(),function(){var e=angular.module("appModule");e.directive("myContextMenu",function(){var e={restrict:"E",templateUrl:"public/directives/my/myContextMenu/myContextMenu.html",scope:{ins:"="},controller:function(e){},compile:function(e,t){return function(e,t,o){}}};return e})}(),function(){var e=angular.module("appModule");e.directive("myDateInput",function(){var e={restrict:"E",templateUrl:"public/directives/my/myDateInput/myDateInput.html",scope:{ctrlId:"=",ctrlMaxLength:"=",ctrlMinValue:"=",ctrlMaxValue:"=",model:"=",hardData:"=",hideErrors:"=",isRequired:"="},controller:function(e){},compile:function(e,t){return function(e,t,o){}}};return e})}(),function(){var e=angular.module("appModule");e.directive("myDirective",["$rootScope","$timeout","hardDataService",function(e,t,o){var r={restrict:"A",controller:function(e){o.bind(e)}};return r}])}(),function(){var e=angular.module("appModule");e.directive("myDropDown",function(){return{restrict:"E",templateUrl:"public/directives/my/myDropDown/myDropDown.html",scope:{ins:"=",openDirection:"=",ctrlClass:"="}}})}(),function(){var e=angular.module("appModule");e.directive("myElemSelector",function(){var e={restrict:"E",templateUrl:"public/directives/my/myElemSelector/myElemSelector.html",scope:{isSelected:"="},controller:function(){},compile:function(e,t){return function(e,t,o){var r=$(t).find("button").get()[0];$(r).on("click",function(){e.isSelected=!e.isSelected,e.$apply()})}}};return e})}(),function(){var e=angular.module("appModule");e.directive("myForm",["MyLoader",function(e){return{restrict:"E",transclude:!0,templateUrl:"public/directives/my/myForm/myForm.html",scope:{ins:"=",hardData:"="},controller:["$scope",function(t){t.ins.scope=t,t.loader=new e,t.ins.model.clear(),t.ins.model.set()}],compile:function(e,t){return function(e,t,o){}}}}])}(),function(){var e=angular.module("appModule");e.directive("myFormErrorIcon",function(){var e={restrict:"E",templateUrl:"public/directives/my/myFormErrorIcon/myFormErrorIcon.html",scope:{args:"="}};return e})}(),function(){var e=angular.module("appModule");e.directive("myGooglePlaceAutoComplete",function(){var e={restrict:"E",templateUrl:"public/directives/my/myGooglePlaceAutoComplete/myGooglePlaceAutoComplete.html",scope:{ctrlId:"=",model:"=",hardData:"=",hideErrors:"=",autocomplete:"="},controller:function(e){},compile:function(e,t){return function(e,t,o){var r=function(){var o=$(t).find("input").get()[0];e.autocomplete.ins=new google.maps.places.Autocomplete(o),e.autocomplete.label=null,e.autocomplete.ins.addListener("place_changed",function(){var t=e.autocomplete.ins.getPlace();t&&(e.autocomplete.label=t.formatted_address,e.$apply())})};e.$watch("model.value",function(t,o){if(t){var r=new google.maps.Geocoder;r.geocode({address:t},function(t,o){"OK"==o&&e.autocomplete.ins.set("place",t[0])})}else e.autocomplete.label=null}),r()}}};return e})}(),function(){var e=angular.module("appModule");e.directive("myInput",function(){var e={restrict:"E",templateUrl:"public/directives/my/myInput/myInput.html",scope:{ctrlId:"=",ctrlType:"=",ctrlMaxLength:"=",ctrlMinValue:"=",ctrlMaxValue:"=",model:"=",hardData:"=",hideErrors:"=",isDisabled:"="},controller:function(e){},compile:function(e,t){return function(e,t,o){}}};return e})}(),function(){var e=angular.module("appModule");e.directive("myLabel",function(){var e={restrict:"E",templateUrl:"public/directives/my/myLabel/myLabel.html",scope:{text:"=",cssClass:"="}};return e})}(),function(){var e=angular.module("appModule");e.directive("myListGroup",function(){return{restrict:"E",templateUrl:"public/directives/my/myListGroup/myListGroup.html",scope:{ins:"="}}})}(),function(){var e=angular.module("appModule");e.directive("myLoader",["$timeout",function(e){var t={restrict:"E",templateUrl:"public/directives/my/myLoader/myLoader.html",scope:{fixedCentered:"=",absCentered:"="}};return t}])}(),function(){var e=angular.module("appModule");e.directive("myModal",["$rootScope","$timeout",function(e,t){return{restrict:"E",templateUrl:"public/directives/my/myModal/myModal.html",transclude:{header:"?myModalHeader",body:"?myModalBody",footer:"?myModalFooter"},scope:{ins:"=",slideInFromLeft:"="},controller:["$scope",function(e){}],compile:function(o,r){return function(o,r,n){$(".modal").on("show.bs.modal",function(){e.isAnyModalOpen=!0}),$(".modal").on("hide.bs.modal",function(){e.isAnyModalOpen=!1,o.ins.hideCb&&t(function(){o.ins.hideCb()},500)})}}}}])}(),function(){var e=angular.module("appModule");e.directive("myNavDropDown",function(){var e={restrict:"E",templateUrl:"public/directives/my/myNavDropDown/myNavDropDown.html",scope:{ins:"="}};return e})}(),function(){var e=angular.module("appModule");e.directive("myNavMenu",function(){var e={restrict:"E",replace:!0,templateUrl:"public/directives/my/myNavMenu/myNavMenu.html",scope:{ins:"="}};return e})}(),function(){var e=angular.module("appModule");e.directive("myPanel",["ui",function(e){var t={restrict:"E",templateUrl:"public/directives/my/myPanel/myPanel.html",transclude:{titleSection:"?titleSection",actionSection:"?actionSection",bodySection:"?bodySection"},scope:{transHeading:"="}};return t}])}(),function(){var e=angular.module("appModule");e.directive("myPopOverIcon",function(){var e={restrict:"E",transclude:{icon:"span"},templateUrl:"public/directives/my/myPopOverIcon/myPopOverIcon.html",scope:{hardData:"="}};return e})}(),function(){var e=angular.module("appModule");e.directive("mySelect",["jsonService",function(e){return{restrict:"E",templateUrl:"public/directives/my/mySelect/mySelect.html",scope:{ctrlId:"=",model:"=",collection:"=",nestedCollectionFieldName:"=",propNames:"=",optionZero:"=",hardData:"=",hideErrors:"="},link:function(t,o,r){var n=$(o).parents("my-selects-group").get();if(n.length>0){var a=$($(o).parent()[0].children).index(o);if(t.onSelect=function(){for(var e=$(o).parent()[0].children.length,t=a+1;t<e;t++){var r=$($($(o).parent()[0].children[t]).find("select")[0]).scope();r.model.value="",r.collection=void 0}},a>0){var i=$($($(o).parent()[0].children[a-1]).find("select")[0]).scope();t.$watch(function(){return i.model.value},function(o){if(o){var r=i.collection;e.find.objectByProperty(r,i.propNames.optionValue,o,function(e){e&&(t.collection=e[t.nestedCollectionFieldName])})}else t.collection=void 0})}switch(a){case 0:t.$watch("$parent.$parent.collection",function(e){e&&(t.collection=e)}),t.$watch("model.value",function(e){t.optionZero||e||!t.collection||(t.model.value=t.collection[0][t.propNames.optionValue])})}}}}}])}(),function(){var e=angular.module("appModule");e.directive("mySelectsGroup",["hardDataService",function(e){var t={restrict:"E",templateUrl:"public/directives/my/mySelectsGroup/mySelectsGroup.html",transclude:!0,scope:{collection:"=",model:"=",hardData:"="}};return t}])}(),function(){var e=angular.module("appModule");e.directive("mySrc",["$timeout","MySwitchable",function(e,t){var o={restrict:"E",templateUrl:"public/directives/my/mySrc/mySrc.html",scope:{ins:"=",type:"@",isSelectable:"&",contextMenuConf:"=",hrefTarget:"@"},controller:function(e){(e.isSelectable()||e.contextMenuConf)&&(e.onMouseEnter=function(){e.srcCtrlsVisible=!0},e.onMouseLeave=function(){e.srcCtrlsVisible=!1}),e.isSelectable()&&(e.ins.isSelected=!1),e.contextMenuConf&&(e.contextMenu=new t(e.contextMenuConf),e.contextMenu.data=e.ins)},compile:function(e,t){return function(e,t,o){var r=$(t).find(e.type).get()[0];$(r).bind("load",function(){e.$apply(),e.ins.deferred.resolve(!0)}),$(r).bind("error",function(){e.$apply(),e.ins.deferred.resolve(!1)})}}};return o}])}(),function(){var e=angular.module("appModule");e.directive("mySrcSlides",["MySwitchable",function(e){var t={restrict:"E",templateUrl:"public/directives/my/mySrcSlides/mySrcSlides.html",scope:{mySrcCollection:"=",srcType:"@"},controller:function(e){},compile:function(t,o){return function(t,o,r){t.$watchCollection("mySrcCollection.collection",function(o){if(o){var r=[];for(var n in o)r.push({_id:o[n].index,index:o[n].index});t.mySwitchable=new e({switchers:r}),t.mySrcCollection.switchable=t.mySwitchable}})}}};return t}])}(),function(){var e=angular.module("appModule");e.directive("mySrcThumbs",["$rootScope","MySwitchable","MyModal",function(e,t,o){var r={restrict:"E",templateUrl:"public/directives/my/mySrcThumbs/mySrcThumbs.html",scope:{srcThumbsCollection:"=",srcSlidesCollection:"=",mainContextMenuConf:"=",srcContextMenuConf:"=",browsingWindowId:"@",srcType:"@",isSrcSelectable:"&"},controller:function(e){e.srcSlidesModal=new o({id:e.browsingWindowId}),e.mainContextMenuConf&&(e.mainContextMenu=new t(e.mainContextMenuConf))},compile:function(e,t){return function(e,t,o){e.browsingWindowId&&(e.$watchCollection("srcThumbsCollection.collection",function(t){if(t){var o=function(){e.srcSlidesCollection.switchable&&(e.srcSlidesCollection.switchable.switchers[this.index].activate(),e.srcSlidesModal.show())};for(var r in t)t[r].onClick=o}}),e.$watch("srcSlidesCollection.switchable",function(t){if(t){var o=function(){e.srcSlidesModal.title=e.srcSlidesCollection.collection[this.index].filename};for(var r in t.switchers)t.switchers[r].onActivate=o}}))}}};return r}])}(),function(){var e=angular.module("appModule");e.directive("myTabs",function(){return{restrict:"E",templateUrl:"public/directives/my/myTabs/myTabs.html",scope:{ins:"="}}})}(),function(){var e=angular.module("appModule");e.directive("myTextArea",function(){var e={restrict:"E",templateUrl:"public/directives/my/myTextArea/myTextArea.html",scope:{ctrlId:"=",ctrlMaxLength:"=",model:"=",hardData:"="}};return e})}(),function(){var e=angular.module("appModule");e.directive("reportAvatar",["reportAvatarService","reportAvatarConf","MySrc",function(e,t,o){var r={restrict:"E",templateUrl:"public/directives/REPORT/reportAvatar/reportAvatar.html",scope:{report:"=",noLink:"&"},controller:function(e){e.src=new o({defaultUrl:t.defaultUrl})},compile:function(t,o){return function(t,o,r){t.$watch(function(){return t.report},function(o){o&&(t.noLink()||(t.src.href="/#/report/photos?id="+o._id),t.src.load(e.constructPhotoUrl(t,!0)))})}}};return r}])}(),function(){var e=function(){var e={defaultUrl:"public/imgs/item.png"};return e};e.$inject=[],angular.module("appModule").service("reportAvatarConf",e)}(),function(){var e=function(e){var t={constructPhotoUrl:function(t,o){return t.report.avatarFileName?o?e.AWS3_RESIZED_UPLOADS_BUCKET_URL+"resized-"+t.report.userId+"/reports/"+t.report._id+"/"+t.report.avatarFileName:e.AWS3_UPLOADS_BUCKET_URL+t.report.userId+"/reports/"+t.report._id+"/"+t.report.avatarFileName:t.src.defaultUrl}};return t};e.$inject=["URLS"],angular.module("appModule").service("reportAvatarService",e)}(),function(){var e=angular.module("appModule");e.directive("reportPhotos",["$rootScope","reportPhotosService","reportPhotosConf","MySrcCollection","MySrcAction","NUMS",function(e,t,o,r,n,a){var i={restrict:"E",templateUrl:"public/directives/REPORT/reportPhotos/reportPhotos.html",scope:{report:"=",editable:"&"},controller:function(t){t.srcAction=new n({acceptedFiles:"image/png,image/jpg,image/jpeg",maxFiles:a.reportMaxPhotos,maxFileSize:a.photoMaxSize,getFilesCount:function(){return e.apiData.report.photos.length}}),t.mainContextMenuConf=o.getMainContextMenuConf(t),t.srcContextMenuConf=o.getSrcContextMenuConf(t)},compile:function(e,n){return function(e,n,a){e.$watch(function(){return e.report},function(n){n&&(e.srcThumbsCollection=new r({defaultUrl:o.defaultUrl,constructUrl:function(o){return t.constructPhotoUrl(e.report.userId,e.report._id,e.report.photos[o].filename,!0)},uploadRequest:t.uploadRequest,remove:function(t){for(var o=t.length-1;o>=0;o--)e.report.photos.splice(t[o],1);return e.report.put()}}),e.srcSlidesCollection=new r({defaultUrl:o.defaultUrl,constructUrl:function(o){return t.constructPhotoUrl(e.report.userId,e.report._id,e.report.photos[o].filename,!1)}}),e.srcThumbsCollection.init(e.report.photos),e.srcSlidesCollection.init(e.report.photos,function(){for(var t in e.srcSlidesCollection.collection)e.srcSlidesCollection.collection[t].href=e.srcSlidesCollection.collection[t].url}))})}}};return i}])}(),function(){var e=function(e,t){var o={defaultUrl:"public/imgs/item.png",getMainContextMenuConf:function(o){var r=function(){if(o.srcThumbsCollection)return 0===o.srcThumbsCollection.collection.length};return{icon:"glyphicon glyphicon-option-horizontal",switchers:[{_id:"update",label:e.hardData.imperatives[16],onClick:function(){o.srcAction.getFilesCount()<o.srcAction.maxFiles?e.$broadcast("displayMultipleFilesInput",{cb:function(e){t.update("addToSet",o,e)}}):o.srcAction.displayModalMessage("MAX_FILES_UPLOADED")}},{_id:"delete",label:e.hardData.imperatives[14],onClick:function(){t["delete"]("multiple",o)},isHidden:r},{_id:"refresh",label:e.hardData.imperatives[19],onClick:function(){o.srcThumbsCollection.init(o.report.photos)},isHidden:r},{_id:"select_all",label:e.hardData.imperatives[30],onClick:function(){o.srcThumbsCollection.selectAll()},isHidden:r},{_id:"deselect_all",label:e.hardData.imperatives[29],onClick:function(){o.srcThumbsCollection.deselectAll()},isHidden:r}]}},getSrcContextMenuConf:function(o){var r=function(e){o.srcThumbsCollection.moveSingle(e._id,e.parent.data,function(){t.afterUpdateSync(o)})};return{icon:"glyphicon glyphicon-option-horizontal",switchers:[{_id:"updateSingle",label:e.hardData.imperatives[5],onClick:function(){var r=this;e.$broadcast("displaySingleFileInput",{cb:function(e){t.update("updateSingle",o,e,r.parent.data)}})}},{_id:"delete",label:e.hardData.imperatives[14],onClick:function(){t["delete"]("single",o,this.parent.data)}},{_id:"refresh",label:e.hardData.imperatives[19],onClick:function(){this.parent.data.load(void 0,!0)}},{_id:"moveLeft",label:e.hardData.imperatives[20],onClick:function(){r(this)},isHidden:function(){if(o.srcThumbsCollection)return o.srcThumbsCollection.collection.length<2}},{_id:"moveRight",label:e.hardData.imperatives[21],onClick:function(){r(this)},isHidden:function(){if(o.srcThumbsCollection)return o.srcThumbsCollection.collection.length<2}},{_id:"set_as_avatar",label:e.hardData.imperatives[28],onClick:function(){o.report.avatarFileName=this.parent.data.filename,t.afterUpdateSync(o)}}]}}};return o};e.$inject=["$rootScope","reportPhotosService"],angular.module("appModule").service("reportPhotosConf",e)}(),function(){var e=function(e,t,o,r,n,a,i){var c={constructPhotoUrl:function(e,t,o,r){return r?i.AWS3_RESIZED_UPLOADS_BUCKET_URL+"resized-"+e+"/reports/"+t+"/"+o:i.AWS3_UPLOADS_BUCKET_URL+e+"/reports/"+t+"/"+o},uploadRequest:function(n,a){var i=this;return t(function(t){var s=n.credentials[a],l=n.inputData[a],u=r.createFormDataObject(s.awsFormData,l);o.makeRequest(s.awsUrl,u).success(function(o){i.filename=s.awsFilename,i.size=l.size;var r=e.apiData.report;t({success:!0,url:c.constructPhotoUrl(r.userId,r._id,i.filename,!0)})}).error(function(e){t({success:!1})})})},update:function(t,r,n,a){r.srcAction.validate(t,n).then(function(i){if(i.success){var s=[];for(var l in n)n[l]instanceof File&&s.push(n[l].type);o.getCredentials("report_photos",{reportId:e.apiData.report._id,fileTypes:s}).then(function(e){var o={inputData:n,credentials:e.data,src:a};r.srcThumbsCollection[t](o,function(e){c.afterUpdateSync(r)})})}else r.srcAction.displayModalMessage(i.msgId)})},"delete":function(t,o,r,a){var i;switch(t){case"single":i=[r];break;case"multiple":i=o.srcThumbsCollection.getSelectedCollection()}o.srcThumbsCollection.removeFromSet({collection:i},function(t,o){t&&n.getList({_id:e.apiData.report._id})})},afterUpdateSync:function(t,o){var r=a.copy(e.apiData.report);r.photos=[];for(var n in t.srcThumbsCollection.collection)r.photos[n]={filename:t.srcThumbsCollection.collection[n].filename,size:t.srcThumbsCollection.collection[n].size};r.put().then(function(t){e.apiData.report=t.data,o&&o(!0)},function(e){o&&o(!1)})}};return c};e.$inject=["$rootScope","$q","aws3Service","MySrcAction","ReportsRest","Restangular","URLS"],angular.module("appModule").service("reportPhotosService",e)}(),function(){var e=angular.module("appModule");e.directive("reports",["$rootScope","reportsConf","reportsService","contextMenuConf",function(e,t,o,r){var n={restrict:"E",templateUrl:"public/directives/REPORT/reports/reports.html",scope:{ctrlId:"@",noAvatar:"=",noInfo:"="},controller:function(t){t.hardData=e.hardData,t.apiData=e.apiData,t.reportContextMenuConf=r.reportContextMenuConf},compile:function(r,n){return function(r,n,a){switch(r.ctrlId){case"UserReports":e.$$listeners.initUserReports||e.$on("initUserReports",function(e,t){o.initUserReports(r,t.userId)}),r.$on("$destroy",function(){e.$$listeners.initUserReports=null}),r.$watch("apiData.profileUser._id",function(e){angular.isDefined(e)&&o.initUserReports(r,e)});break;case"SearchReports":e.$$listeners.initSearchReports||e.$on("initSearchReports",function(e,o){r.collectionBrowser=t.searchCollectionBrowser,r.collectionBrowser.init()}),r.$on("$destroy",function(){e.$$listeners.initSearchReports=null}),r.collectionBrowser=t.searchCollectionBrowser,r.collectionBrowser.init();break;case"RecentlyViewedReports":e.$$listeners.initRecentlyViewedReports||e.$on("initRecentlyViewedReports",function(e,o){r.collectionBrowser=t.recentlyViewedCollectionBrowser,r.collectionBrowser.init()}),r.$on("$destroy",function(){e.$$listeners.initRecentlyViewedReports=null}),r.collectionBrowser=t.recentlyViewedCollectionBrowser,r.collectionBrowser.init();break;case"NewReports":r.collectionBrowser=t.recentlyReportedCollectionBrowser,r.collectionBrowser.init()}}}};return n}])}(),function(){var e=function(e,t,o,r){var n=t.get();return this.searchCollectionBrowser=new o.MyCollectionBrowser({singlePageSize:25,filterer:{switchers:[{_id:"all",label:n.status[1]},{_id:"lost",label:n.reportGroups[0].label2},{_id:"found",label:n.reportGroups[1].label2}]},sorter:{switchers:[{_id:"title",label:n.status[7]},{_id:"date",label:n.status[8]}]},fetchData:function(t){var o=e.globalFormModels.reportSearchModel.getValues();return t.subject="reports",t.title=o.title,t.categoryId=o.categoryId,t.subcategoryId=o.subcategoryId,r.getList(t)}}),this.profileCollectionBrowser=new o.MyCollectionBrowser({singlePageSize:25,filterer:{switchers:[{_id:"all",label:n.status[1]},{_id:"lost",label:n.reportGroups[0].label2},{_id:"found",label:n.reportGroups[1].label2}]},sorter:{switchers:[{_id:"title",label:n.status[7]},{_id:"date",label:n.status[8]}]},fetchData:function(t){return t.subject="user_reports",t.userId=e.apiData.profileUser._id,r.getList(t)}}),this.recentlyReportedCollectionBrowser=new o.MyCollectionBrowser({singlePageSize:5,noPager:!0,fetchData:function(e){return e.subject="new_reports",e.sort="-dateAdded",e.limit=5,r.getList(e)}}),this.recentlyViewedCollectionBrowser=new o.MyCollectionBrowser({singlePageSize:5,hideRefresher:!0,fetchData:function(e){return e.subject="recently_viewed_reports",e.limit=5,r.getList(e)}}),this};e.$inject=["$rootScope","hardDataService","myClass","ReportsRest"],angular.module("appModule").service("reportsConf",e)}(),function(){var e=function(e,t,o,r,n){var a=o.service("reports");return a.myDataModel={categoryId:{},subcategoryId:{},subsubcategoryId:{},title:{},serialNo:{},description:{},startEvent:{group:{},date:{},geolocation:{},details:{}}},o.extendModel("reports",function(t){return t._isOwn=function(){return this.userId==e.globalFormModels.personalDetailsModel.getValue("_id")},t}),a};e.$inject=["$rootScope","$stateParams","Restangular","storageService","MyDataModel"],angular.module("appModule").factory("ReportsRest",e)}(),function(){var e=function(e,t,o,r,n,a,i,c){var s=this;return s.formModelFields=["group","categoryId","subcategoryId","subsubcategoryId","title","serialNo","description","date","geolocation","details"],s.getFormSubmitAction=function(o){
switch(o.action){case"newReport":return function(r){o.myForm.submitSuccessCb=function(e){o.myForm.reset(),t.go("app.report",{id:e.data._id})};var n=o.myModel.getValues();n.userId=e.globalFormModels.personalDetailsModel.getValue("_id");var a=o.autocomplete.ins.getPlace();return a?(n.geolocation={lat:a.geometry.location.lat(),lng:a.geometry.location.lng()},n.placeId=a.place_id):n.geolocation=null,i.post(n)};case"editReport":return function(r){o.myForm.submitSuccessCb=function(o){e.apiData.report=o.data,t.go("app.report",{id:o.data._id,edit:void 0})},o.myForm.submitErrorCb=function(t){e.apiData.report=n};var n=c.copy(e.apiData.report);return o.myModel.setRestObj(n),n.put()}}},s.deleteReports=function(r){r&&r.length>0&&e.ui.modals.deleteReportModal.show({message:function(){return e.hardData.warnings[2]}(),acceptCb:function(){var a=[],i=!0,c=!1,s=void 0;try{for(var l,u=r[Symbol.iterator]();!(i=(l=u.next()).done);i=!0){var d=l.value;a.push(d.remove({userId:d.userId}))}}catch(p){c=!0,s=p}finally{try{!i&&u["return"]&&u["return"]()}finally{if(c)throw s}}n.all(a).then(function(r){switch(t.current.name){case"app.profile":e.$broadcast("initUserReports",{userId:o.id});break;case"app.report":window.history.back()}})}})},s.initUserReports=function(t,o){t.collectionBrowser=a.profileCollectionBrowser,o==e.apiData.loggedInUser._id?t.elemContextMenuConf=t.reportContextMenuConf:$scope.elemContextMenuConf=void 0,t.collectionBrowser.onRefreshClick()},s};e.$inject=["$rootScope","$state","$stateParams","$timeout","$q","reportsConf","ReportsRest","Restangular"],angular.module("appModule").service("reportsService",e)}(),function(){var e=angular.module("appModule");e.directive("userAvatar",["userAvatarService","userAvatarConf","MySrc","ui",function(e,t,o,r){var n={restrict:"E",templateUrl:"public/directives/USER/userAvatar/userAvatar.html",scope:{user:"=",editable:"=",noLink:"&",withLabel:"="},controller:function(r){r.src=new o({defaultUrl:t.defaultUrl,uploadRequest:e.uploadRequest,removeRequest:e.removeRequest}),r.srcContextMenuConf=t.getSrcContextMenuConf(r)},compile:function(t,o){return function(t,o,r){t.$watch(function(){return t.user},function(o){o&&(t.withLabel&&(t.src.label=t.user.truncatedUsername),t.noLink()||(t.src.href="/#/profile?id="+t.user._id),e.loadPhoto(t))})}}};return n}])}(),function(){var e=function(e,t,o){var r={defaultUrl:"public/imgs/avatar.png",getSrcContextMenuConf:function(r){return{icon:"glyphicon glyphicon-option-horizontal",switchers:[{_id:"update",label:e.hardData.imperatives[5],onClick:function(){e.$broadcast("displayImgCropWindow",{acceptCb:function(e){r.src.update({file:o.dataURItoBlob(e)},!0).then(function(e){e&&t.loadPhoto(r,!0)})}})}},{_id:"delete",label:e.hardData.imperatives[14],onClick:function(){r.src.remove(void 0,!0)},isHidden:function(){return r.src.isDefaultUrlLoaded()}},{_id:"refresh",label:e.hardData.imperatives[19],onClick:function(){t.loadPhoto(r,!0)}}]}}};return r};e.$inject=["$rootScope","userAvatarService","utilService"],angular.module("appModule").service("userAvatarConf",e)}(),function(){var e=function(e,t,o,r,n,a){var i={loadPhoto:function(e,t){e.src.load(i.constructPhotoUrl(e,!0),t,function(o){o||e.src.load(i.constructPhotoUrl(e,!1),t)})},constructPhotoUrl:function(e,t){return 0===e.user.photos.length?e.src.defaultUrl:t?a.AWS3_RESIZED_UPLOADS_BUCKET_URL+"resized-"+e.user._id+"/"+e.user.photos[0].filename:a.AWS3_UPLOADS_BUCKET_URL+e.user._id+"/"+e.user.photos[0].filename},uploadRequest:function(a){var c=this;return t(function(t){o.getCredentials("user_avatar",{fileTypes:[a.file.type]}).then(function(s){var l=r.createFormDataObject(s.data[0].awsFormData,a.file);o.makeRequest(s.data[0].awsUrl,l).success(function(o){e.apiData.profileUser.photos[0]={filename:s.data[0].awsFilename,size:a.file.size},e.apiData.profileUser.put().then(function(o){e.apiData.loggedInUser=n.copy(e.apiData.profileUser),t({success:!0,url:i.constructPhotoUrl({src:c,user:e.apiData.profileUser},!0)})},function(e){t({success:!1})})}).error(function(e){t({success:!1})})},function(e){t({success:!1})})})},removeRequest:function(){return t(function(t){e.apiData.profileUser.photos=[],e.apiData.profileUser.put().then(function(){e.apiData.loggedInUser=n.copy(e.apiData.profileUser),t(!0)},function(){t(!1)})})}};return i};e.$inject=["$rootScope","$q","aws3Service","MySrcAction","Restangular","URLS"],angular.module("appModule").service("userAvatarService",e)}(),function(){var e=angular.module("appModule");e.directive("userBadge",["$rootScope","$state","authService",function(e,t,o){return{restrict:"E",templateUrl:"public/directives/USER/userBadge/userBadge.html",scope:!0,controller:["$scope",function(r){r.authState=o.state,r.label1=e.hardData.status[0],r.onLogoutClick=function(){e.logout()},r.onContinueClick=function(){t.go("app.home")}}]}}])}(),function(){var e=angular.module("appModule");e.directive("singleFileInput",function(){var e={restrict:"E",template:'<input id="singleFileInput" name="file" type="file" />',scope:!0,controller:function(e){},compile:function(e,t){return function(e,t,o){var r,n=$(t).find("#singleFileInput").get()[0];e.$on("displaySingleFileInput",function(e,t){r=t.cb,$(n).val(void 0),$(n).click()}),$(n).on("change",function(e){e.target.files.length>0&&r(e.target.files)})}}};return e}),e.directive("multipleFilesInput",function(){var e={restrict:"E",template:'<input id="multipleFilesInput" name="file" type="file" multiple />',scope:!0,controller:function(e){},compile:function(e,t){return function(e,t,o){var r,n=$(t).find("#multipleFilesInput").get()[0];e.$on("displayMultipleFilesInput",function(e,t){r=t.cb,$(n).val(void 0),$(n).click()}),$(n).on("change",function(e){e.target.files.length>0&&r(e.target.files)})}}};return e})}();