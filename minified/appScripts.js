"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};!function(){var e=angular.injector(["ng"]).get("$q"),t=angular.injector(["ng"]).get("$http"),o=angular.module("appModule",["ui.bootstrap","ui.router","ngAnimate","restangular","LocalStorageModule","angular-momentjs"]);e.all([t.get("public/json/hard_coded/hard_coded_en.json"),t.get("public/json/hard_coded/hard_coded_pl.json"),t.get("/session")]).then(function(e){o.constant("hardDataConst",{en:e[0].data,pl:e[1].data}),o.constant("sessionConst",e[2].data),angular.element(document).ready(function(){angular.bootstrap(document,["appModule"])})})}(),function(){angular.module("appModule").config(["$urlRouterProvider","$locationProvider","localStorageServiceProvider",function(e,t,o){e.otherwise("/home"),t.html5Mode(!1).hashPrefix(""),o.setPrefix("laf"),String.prototype.truncate=function(e){var t=this.toString();return t.length>e?t.substr(0,e)+"...":t}}])}(),function(){var e={AWS3_UPLOADS_BUCKET_URL:"https://s3.amazonaws.com/laf.useruploads/",AWS3_RESIZED_UPLOADS_BUCKET_URL:"https://s3.amazonaws.com/laf.useruploadsresized/"},t={itemMaxPhotos:15,photoMaxSize:1048576};angular.module("appModule").constant("URLS",e),angular.module("appModule").constant("NUMS",t)}(),function(){var e=angular.module("appModule");e.filter("filterByCategory",function(){return function(e,t){if(t){var o=[];return angular.forEach(e,function(e){e.name[0]==t&&o.push(e)}),o}return e}})}(),function(){angular.module("appModule").run(["$rootScope","$location","$timeout","$state","$moment","apiService","logService","ui","uiThemeService","sessionConst",function(e,t,o,n,i,r,a,c,s,l){r.setup(),s.include(l.theme),i.locale(l.language),"scrollRestoration"in history&&(history.scrollRestoration="manual"),e.$on("$stateChangeStart",function(e,t,o,n,i){n.name.split(".")[0]!=t.name.split(".")[0]&&c.loaders.renderer.start(),n!=t&&($(".modal").modal("hide"),$(".navbar-collapse").collapse("hide"))}),e.$on("$stateChangeSuccess",function(e,t,i,r,a){r.scrollY=window.scrollY,o(function(){var e;switch(t.name){case"main.profile":case"main.item":e=t.id==i.id?n.current.scrollY:0,t.id=i.id;break;case"main.search":e=n.current.scrollY;break;default:e=0}$("html, body").animate({scrollTop:e},"fast")}),o(function(){c.loaders.renderer.stop()},3e3)})}])}(),function(){var e=function(e,t,o){var n=o.get(),i={_ctrlId:"mainFrame",switchers:[{_id:"home",route:"/#/home",label:n.phrases[35],icon:"glyphicon glyphicon-home"},{_id:"search",route:"/#/search",label:n.phrases[83],icon:"glyphicon glyphicon-search"},{_id:"report",route:"/#/report",label:n.phrases[141],icon:"glyphicon glyphicon-bullhorn"},{_id:"profile",label:n.phrases[38],icon:"glyphicon glyphicon-user"},{_id:"about",route:"/#/about",label:n.phrases[40],icon:"glyphicon glyphicon-info-sign"},{_id:"help",route:"/#/help",label:n.phrases[41],icon:"glyphicon glyphicon-question-sign"},{_id:"contact",route:"/#/contact",label:n.phrases[42],icon:"glyphicon glyphicon-envelope"},{_id:"item",label:n.phrases[62],icon:"glyphicon glyphicon-shopping-cart"},{_id:"editem",label:n.phrases[68],icon:"glyphicon glyphicon-edit"},{_id:"settings",label:n.phrases[39],icon:"glyphicon glyphicon-cog",getRoute:function(e){var t,o;switch(this.parent._ctrlId){case"mainFrameNav":t=e.listGroups.settings.getActiveSwitcher()._id;break;case"settingsListGroup":case"settingsCategoriesDropdown":t=this._id}return o=e.tabs[t].getActiveSwitcher()._id,"/#/settings/"+t+"/"+o},validateCatId:function(e,o){return t(function(t){t(o.listGroups.settings.switcherIds.indexOf(e.catId)>-1?!0:!1)})},validateSubcatId:function(e,o){return t(function(t){t(o.tabs[e.catId].switcherIds.indexOf(e.subcatId)>-1?!0:!1)})}}]};return i};e.$inject=["$rootScope","$q","hardDataService"],angular.module("appModule").service("mainFrameConf",e)}(),function(){var e=function(e,t){var o=t.get(),n={_ctrlId:"mainFrameNav",icon:"glyphicon glyphicon-option-horizontal",switchers:[{_id:"settings"},{_id:"separator"},{_id:"about"},{_id:"help"},{_id:"contact"},{_id:"separator"},{_id:"logout",route:"/#/guest/login",label:o.phrases[12],icon:"glyphicon glyphicon-off",onClick:function(){e.logout()}}]};return n};e.$inject=["$rootScope","hardDataService"],angular.module("appModule").service("mainFrameNavConf",e)}(),function(){var e=function(e,t){var o=e.get();return{infoModal:new t({id:"infoModal"}),confirmModal:new t({id:"confirmModal"}),confirmDangerModal:new t({id:"confirmDangerModal"}),tryAgainLaterModal:new t({typeId:"infoModal",title:o.phrases[57],message:o.sentences[20]}),tryToRefreshModal:new t({typeId:"infoModal",title:o.phrases[57],message:o.sentences[34]}),passResetDoneModal:new t({typeId:"infoModal",title:o.phrases[96],message:o.sentences[58]}),deactivationDoneModal:new t({typeId:"infoModal",title:o.phrases[59],message:o.sentences[28]}),confirmProceedModal:new t({typeId:"confirmModal",message:o.sentences[18]}),confirmDeactivationModal1:new t({typeId:"confirmDangerModal",title:o.phrases[56],message:o.sentences[14]}),confirmDeactivationModal2:new t({typeId:"confirmDangerModal",title:o.phrases[56],message:o.sentences[15]}),deleteItemModal:new t({typeId:"confirmDangerModal",title:o.phrases[65]})}};e.$inject=["hardDataService","MyModal"],angular.module("appModule").service("modalsConf",e)}(),function(){var e=function(){var e={_id:"auth_token",type:"cookie",daysToExpire:30};return{authToken:e}};e.$inject=[],angular.module("appModule").service("myStorageConf",e)}(),function(){var e=function(e,t){var o=t.get(),n={_ctrlId:"settingsListGroup",switchers:[{_id:"application",label:o.phrases[43],onActivate:function(){e.globalFormModels.appConfigModel.set()}},{_id:"account",label:o.phrases[44],onActivate:function(){e.globalFormModels.personalDetailsModel.set(),e.globalFormModels.passwordModel.clear()}},{_id:"danger",label:o.phrases[46],onActivate:function(){e.globalFormModels.deactivationModel.clear()}}]};return n};e.$inject=["$rootScope","hardDataService"],angular.module("appModule").service("settingsListGroupConf",e)}(),function(){var e=function(e){var t={_ctrlId:"guestTabs",switchers:[{_id:"login",route:"/#/guest/login",onActivate:function(){e.globalFormModels.userModel.clearErrors()}},{_id:"register",route:"/#/guest/register",onActivate:function(){e.globalFormModels.userModel.clearErrors()}},{_id:"recover",route:"/#/guest/recover",onActivate:function(){e.globalFormModels.userModel.clearErrors()}},{_id:"status",route:"/#/guest/status",onActivate:function(){e.globalFormModels.userModel.clearErrors()}}],hardData:{switchers_label:["phrases",[47,48,21,49]],switchers_info:["sentences",[4,5,6,7]]}};return t},t=function(e,t){var o=t.get(),n={application:{_ctrlId:"appTabs",switchers:[{_id:"appearance",route:"/#/settings/application/appearance",label:o.phrases[73],info:o.sentences[54],onActivate:function(){e.globalFormModels.appConfigModel.set()}},{_id:"regional",route:"/#/settings/application/regional",label:o.phrases[50],info:o.sentences[8],onActivate:function(){e.globalFormModels.appConfigModel.set()}}]},account:{_ctrlId:"accountTabs",switchers:[{_id:"personal-details",route:"/#/settings/account/personal-details",label:o.phrases[51],info:o.sentences[9],onActivate:function(){e.globalFormModels.personalDetailsModel.set()}},{_id:"password",route:"/#/settings/account/password",label:o.phrases[52],info:o.sentences[10],onActivate:function(){e.globalFormModels.passwordModel.clear()}}]},payment:{_ctrlId:"paymentTabs",switchers:[{_id:"paypal",route:"/#/settings/payment/paypal",label:o.phrases[54],info:o.sentences[12]}]},danger:{_ctrlId:"dangerTabs",switchers:[{_id:"deactivate",route:"/#/settings/danger/deactivate",label:o.phrases[55],info:o.sentences[13],onActivate:function(){e.globalFormModels.deactivationModel.clear()}}]}};return n},o=function(e){var t=function(){if(e.apiData.item)return"/#/item/"+this._id+"?id="+e.apiData.item._id},o={_ctrlId:"itemTabs",switchers:[{_id:"photos",getRoute:t,onActivate:function(){}},{_id:"comments",getRoute:t,onActivate:function(){}}],hardData:{switchers_label:["phrases",[70,58]]}};return o};e.$inject=["$rootScope"],t.$inject=["$rootScope","hardDataService"],o.$inject=["$rootScope"],angular.module("appModule").service("guestTabsConf",e),angular.module("appModule").service("settingsTabsConf",t),angular.module("appModule").service("itemTabsConf",o)}(),function(){var e=function(){var e={_ctrlId:"topNavMenu",switchers:[{_id:"home"},{_id:"search"},{_id:"report"}]};return e};e.$inject=[],angular.module("appModule").service("topNavMenuConf",e)}(),function(){var e=function(e,t,o,n,i,r,a,c,s,l,u,d,p){e.socket=io("http://localhost:8080"),e.ui=l,e.hardData=s.get(),e.Math=window.Math,e.apiData={loggedInUser:void 0,profileUser:void 0,itemUser:void 0,item:void 0,itemCategories:void 0,deactivationReasons:void 0,contactTypes:void 0},e.globalFormModels={userModel:new d.MyFormModel("userModel",["email","username","password","firstname","lastname","countryFirstLetter","country"],(!1)),appConfigModel:new d.MyFormModel("appConfigModel",["userId","language","theme"],(!0)),personalDetailsModel:new d.MyFormModel("personalDetailsModel",["_id","email","username","firstname","lastname","countryFirstLetter","country","registration_date"],(!0)),passwordModel:new d.MyFormModel("passwordModel",["currentPassword","password"],(!1)),deactivationModel:new d.MyFormModel("deactivationModel",["deactivationReasonId"],(!1)),itemSearchModel:new d.MyFormModel("itemSearchModel",["title","categoryId","subcategoryId"],(!0))},e.logout=function(t,o){u.reInitCtrls(l),e.resetGlobalFormModels(),c.setAsLoggedOut(function(){var e={tab:"login"};t&&Object.assign(e,t),r.go("guest.1",e),o&&o()})},e.resetGlobalFormModels=function(){for(var t=Object.keys(e.globalFormModels),o=0;o<t.length;o++)e.globalFormModels[t[o]].set({})},e.$watch(function(){return a.authToken.getValue()},function(e){p.setDefaultHeaders({"x-access-token":e}),!e&&c.state.loggedIn&&o.location.reload()})};e.$inject=["$rootScope","$scope","$window","$timeout","$moment","$state","storageService","authService","hardDataService","ui","uiSetupService","myClass","Restangular"],angular.module("appModule").controller("AppController",e)}(),function(){var e=function(e,t){e.$watch(function(){return t.state.loggedIn},function(t){for(var o=0;o<3;o++)e.ui.tabs.guest.switchers[o].isVisible=!t;e.ui.tabs.guest.switchers[3].isVisible=t})};e.$inject=["$scope","authService"],angular.module("appModule").controller("GuestController",e)}(),function(){var e=function(e,t,o,n,i,r){t.itemsService=o,t.commentsBrowser=i.itemCommentsBrowser,t.$watch(function(){return e.apiData.item},function(e){e&&e._isOwn()?(t.itemContextMenu=new r(n.itemContextMenuConf),t.itemContextMenu.data=e):t.itemContextMenu=null})};e.$inject=["$rootScope","$scope","itemsService","itemsConf","commentsConf","MySwitchable"],angular.module("appModule").controller("ItemController",e)}(),function(){var e=function(e,t){e.$watch("ui.listGroups.settings.activeSwitcherId",function(o){angular.isDefined(o)&&(e.activeTabs=t.tabs[o])})};e.$inject=["$scope","ui"],angular.module("appModule").controller("SettingsController",e)}(),function(){angular.module("appModule").config(["$stateProvider",function(e){e.state("guest.1",{url:"/guest/:tab?action",resolve:{tab:["countries","$q","$state","$stateParams","ui",function(e,t,o,n,i){return t(function(e,t){var r=i.tabs.guest.switcherIds;r.indexOf(n.tab)>-1?e():o.go("guest.1",{tab:"login"},{location:"replace"})})}],authentication:["tab","$q","$state","$stateParams","authService",function(e,t,o,n,i){return t(function(e){i.authenticate(function(t){t&&"status"!=n.tab?o.go("guest.1",{tab:"status"},{location:"replace"}):e()})})}]},onEnter:["$state","$stateParams","$timeout","ui",function(e,t,o,n){n.tabs.guest.activateSwitcher(t.tab),n.frames.main.activateSwitcher(),o(function(){"deactivation"==e.params.action&&o(function(){n.modals.deactivationDoneModal.show()},500)},2500)}]})}])}(),function(){angular.module("appModule").config(["$stateProvider",function(e){e.state("guest",{"abstract":!0,views:{view1:{templateUrl:"public/pages/lost-and-found-app-guest.html"}},resolve:{captchaApi:["$q","ui","utilService",function(e,t,o){return e(function(e,t){try{grecaptcha&&e()}catch(n){window.captchaApiLoaded=function(){e()},o.loadScript("https://www.google.com/recaptcha/api.js?onload=captchaApiLoaded&render=explicit")}})}],countries:["captchaApi","$q","$rootScope","ui","fileService",function(e,t,o,n,i){return t(function(e,t){i.countries.data?e():i.countries.readFile(function(t){t?i.countries.alterData(function(){e()}):n.loaders.renderer.stop(function(){o.ui.modals.tryToRefreshModal.show()})})})}]},onEnter:["$rootScope","$state","$timeout","ui",function(e,t,o,n){o(function(){"login"==t.params.tab&&"pass_reset"==t.params.action&&o(function(){e.ui.modals.passResetDoneModal.show()},500)},2500)}]})}])}(),function(){angular.module("appModule").config(["$stateProvider",function(e){e.state("main.about",{url:"/about",onEnter:["ui",function(e){e.frames.main.activateSwitcher("about"),e.menus.top.activateSwitcher("about")}]})}])}(),function(){angular.module("appModule").config(["$stateProvider",function(e){e.state("main.contact",{url:"/contact",onEnter:["ui",function(e){e.frames.main.activateSwitcher("contact"),e.menus.top.activateSwitcher("contact")}]})}])}(),function(){angular.module("appModule").config(["$stateProvider",function(e){e.state("main.editem",{url:"/editem?id",resolve:{getItem:["itemCategories","$q","$stateParams","ItemsRest",function(e,t,o,n){return t(function(e){n.getList({_id:o.id}).then(function(t){e(t.data[0])},function(){e(!1)})})}]},onEnter:["getItem","$rootScope","$timeout","ui",function(e,t,o,n){var i=0;n.loaders.renderer.isLoading&&(i=3e3),o(function(){t.$broadcast("editItem",{item:e}),n.menus.top.activateSwitcher(),e?n.frames.main.activateSwitcher("editem"):(n.frames.main.activateSwitcher(),n.modals.tryAgainLaterModal.show())},i)}]})}])}(),function(){angular.module("appModule").config(["$stateProvider",function(e){e.state("main.help",{url:"/help",onEnter:["ui",function(e){e.frames.main.activateSwitcher("help"),e.menus.top.activateSwitcher("help")}]})}])}(),function(){angular.module("appModule").config(["$stateProvider",function(e){e.state("main.home",{url:"/home",onEnter:["ui",function(e){e.menus.top.activateSwitcher("home"),e.frames.main.activateSwitcher("home")}]})}])}(),function(){angular.module("appModule").config(["$stateProvider",function(e){e.state("main.item",{url:"/item/:tab?id",resolve:{getItem:["itemCategories","$stateParams","$q","ItemsRest",function(e,t,o,n){return o(function(e){n.getList({_id:t.id}).then(function(){e(!0)},function(){e(!1)})})}],getUser:["getItem","$stateParams","$q","UsersRest",function(e,t,o,n){return o(function(e){n.getList({itemId:t.id}).then(function(){e(!0)},function(){e(!1)})})}]},onEnter:["getItem","getUser","$timeout","$stateParams","ui",function(e,t,o,n,i){var r=0;i.loaders.renderer.isLoading&&(r=3e3),o(function(){i.menus.top.activateSwitcher(),e&&t?(i.frames.main.activateSwitcher("item"),i.tabs.item.activateSwitcher(n.tab)):(i.frames.main.activateSwitcher(),i.modals.tryAgainLaterModal.show())},r)}]})}])}(),function(){angular.module("appModule").config(["$stateProvider",function(e){e.state("main",{"abstract":!0,views:{view1:{templateUrl:"public/pages/lost-and-found-app-main.html"}},resolve:{authentication:["$timeout","$state","$q","authService","ui",function(e,t,o,n,i){return o(function(o,i){n.authenticate(function(n,i){n?o():e(function(){t.go("guest.1",{tab:"login"},{location:"replace"})})})})}],openExchangeRates:["authentication","$rootScope","$q","ui","exchangeRateService",function(e,t,o,n,i){return o(function(e,r){var a=[];angular.forEach(i.config.availableRates,function(e,t){var n=o(function(e,o){$.getJSON(i.config.api+t+"&callback=?").then(function(o){i.data[t]=o,e(!0)},function(){e(!1)})});a.push(n)}),o.all(a).then(function(o){o.indexOf(!1)==-1?e():n.loaders.renderer.stop(function(){t.ui.modals.tryToRefreshModal.show()})})})}],countries:["openExchangeRates","$rootScope","$q","ui","fileService",function(e,t,o,n,i){return o(function(e,o){i.countries.data?e():i.countries.readFile(function(o){o?i.countries.alterData(function(){e()}):n.loaders.renderer.stop(function(){t.ui.modals.tryToRefreshModal.show()})})})}],deactivationReasons:["countries","$rootScope","$q","$filter","DeactivationReasonsRest",function(e,t,o,n,i){return o(function(e){i.getList().then(function(o){t.apiData.deactivationReasons=n("orderBy")(o.data.plain(),"index"),e(!0)},function(){t.apiData.deactivationReasons=void 0,e(!1)})})}],contactTypes:["deactivationReasons","$rootScope","$q","$filter","ui","ContactTypesRest",function(e,t,o,n,i,r){return o(function(e){r.getList().then(function(o){t.apiData.contactTypes=n("orderBy")(o.data.plain(),"index"),e(!0)},function(){t.apiData.contactTypes=void 0,e(!1)})})}],itemCategories:["contactTypes","$q","$rootScope","ItemCategoriesRest","ui",function(e,t,o,n,i){return t(function(e,t){n.getList().then(function(t){o.apiData.itemCategories=t.data.plain(),e()},function(){i.loaders.renderer.stop(function(){o.ui.modals.tryToRefreshModal.show()})})})}]},onEnter:["$timeout","ui",function(e,t){t.listGroups.settings.getFirstSwitcher().activate(),angular.forEach(t.listGroups.settings.switchers,function(e){t.tabs[e._id].getFirstSwitcher().activate()})}]})}])}(),function(){angular.module("appModule").config(["$stateProvider",function(e){e.state("main.profile",{url:"/profile?id",resolve:{getUser:["itemCategories","$stateParams","$q","UsersRest",function(e,t,o,n){return o(function(e){n.getList({_id:t.id}).then(function(t){e(!0)},function(){e(!1)})})}]},onEnter:["getUser","$rootScope","$timeout","ui",function(e,t,o,n){var i=0;n.loaders.renderer.isLoading&&(i=3e3),o(function(){n.menus.top.activateSwitcher(),e?n.frames.main.activateSwitcher("profile"):(n.frames.main.activateSwitcher(),n.modals.tryAgainLaterModal.show())},i)}]})}])}(),function(){angular.module("appModule").config(["$stateProvider",function(e){e.state("main.report",{url:"/report",resolve:{_ui:["itemCategories","$q","ui",function(e,t,o){return t(function(e){o.menus.top.activateSwitcher("report"),o.frames.main.activateSwitcher("report"),e()})}]},onEnter:function(){}})}])}(),function(){angular.module("appModule").config(["$stateProvider",function(e){e.state("main.search",{url:"/search",resolve:{_ui:["itemCategories","$q","ui",function(e,t,o){return t(function(e){o.menus.top.activateSwitcher("search"),o.frames.main.activateSwitcher("search"),e()})}]},onEnter:["$rootScope",function(e){}]})}])}(),function(){angular.module("appModule").config(["$stateProvider",function(e){e.state("main.settings1",{url:"/settings",resolve:{redirection:["$q","$timeout","$state","ui",function(e,t,o,n){return e(function(){var e=n.listGroups.settings.activeSwitcherId;t(function(){o.go("main.settings3",{catId:e,subcatId:n.tabs[e].activeSwitcherId},{location:"replace"})})})}]}})}])}(),function(){angular.module("appModule").config(["$stateProvider",function(e){e.state("main.settings2",{url:"/settings/:catId",resolve:{catId:["$timeout","$q","$state","$stateParams","ui",function(e,t,o,n,i){return t(function(t,r){var a=i.frames.main.getSwitcher("_id","settings");a.validateCatId(n,i).then(function(n){n?t():e(function(){o.go("main.settings1",{},{location:"replace"})})})})}],redirection:["catId","$timeout","$state","$stateParams","ui",function(e,t,o,n,i){t(function(){o.go("main.settings3",{catId:n.catId,subcatId:i.tabs[n.catId].activeSwitcherId},{location:"replace"})})}]}})}])}(),function(){angular.module("appModule").config(["$stateProvider",function(e){e.state("main.settings3",{url:"/settings/:catId/:subcatId",resolve:{params:["$timeout","$q","$state","$stateParams","ui",function(e,t,o,n,i){return t(function(r,a){var c=i.frames.main.getSwitcher("_id","settings");t.all([c.validateCatId(n,i),c.validateSubcatId(n,i)]).then(function(t){t[0]?t[1]?r():e(function(){o.go("main.settings2",{catId:n.catId},{location:"replace"})}):e(function(){o.go("main.settings1",{},{location:"replace"})})})})}]},onEnter:["$stateParams","ui",function(e,t){t.menus.top.activateSwitcher("settings"),t.listGroups.settings.activateSwitcher(e.catId),t.dropdowns.settingsCategories.activateSwitcher(e.catId),t.tabs[e.catId].activateSwitcher(e.subcatId),t.frames.main.activateSwitcher("settings")}]})}])}(),function(){var e=function(e,t,o,n,i,r,a,c){var s={setup:function(){c.setBaseUrl("/api"),c.setFullResponse(!0),c.setRestangularFields({id:"_id"}),c.addResponseInterceptor(s.interceptResponse),c.addElementTransformer("users",!1,function(e){return e.username?(e.truncatedUsername=e.username.truncate(15),e.formattedRegistrationDate=n(e.registration_date).format("DD-MM-YYYY HH:mm"),e.countryFirstLetter=e.country[0]):e.user&&(e.user.truncatedUsername=e.user.username.truncate(15),e.user.formattedRegistrationDate=n(e.user.registration_date).format("DD-MM-YYYY HH:mm"),e.user.countryFirstLetter=e.user.country[0]),e}),c.addElementTransformer("items",!1,function(e){return e.truncatedTitle=e.title.truncate(25),e.date=new Date(e.date),e.formattedDateAdded=n(e.dateAdded).format("DD-MM-YYYY HH:mm"),e.pastSinceAdded=n.duration(n(new Date).diff(n(e.dateAdded))).humanize(),s.createItemFullCategoryString(e),e}),c.addElementTransformer("comments",!1,function(e){return e.pastSinceAdded=n.duration(n(new Date).diff(n(e.dateAdded))).humanize(),e})},interceptResponse:function(n,s,l,u,d,p){n.authToken&&i.authToken.setValue(n.authToken),n.msg&&o(function(){var o={title:n.msg.title,message:n.msg.info};n.msg.reload&&(o.hideCb=function(){t.location.reload()}),e.ui.modals.infoModal.show(o)},100);var m;switch(l){case"app_configs":var f=c.restangularizeElement(void 0,n.appConfig,"app_configs");e.apiData.loggedInUser.appConfig=f;break;case"users":switch(s){case"getList":d.config.params&&(d.config.params._id?e.apiData.profileUser=n[0]:d.config.params.itemId&&(e.apiData.itemUser=n[0]));break;case"post":return n.user.appConfig=n.appConfig,e.apiData.loggedInUser=n.user,c.restangularizeElement(void 0,e.apiData.loggedInUser.appConfig,"app_configs"),c.restangularizeCollection(void 0,[n.user],"users");case"put":return e.apiData.loggedInUser=n.user,n.user}break;case"items":switch(s){case"getList":if(d.config.params)return d.config.params._id?(e.apiData.item||(e.apiData.item=n[0]),n):d.config.params.userId?(r.profileCollectionBrowser.setData(n),n.collection):(r.searchCollectionBrowser.setData(n),n.collection);break;case"put":return n}break;case"comments":switch(s){case"getList":for(m in n.collection)n.collection[m].user=n.users[m];a.itemCommentsBrowser.setData(n)}return n.collection}return n},createItemFullCategoryString:function(t){var o=_.find(e.apiData.itemCategories,function(e){return e._id==t.categoryId}),n=_.find(o.subcategories,function(e){return e._id==t.subcategoryId});t.fullCategory=o.label+" / "+n.label}};return s};e.$inject=["$rootScope","$window","$timeout","$moment","storageService","itemsConf","commentsConf","Restangular"],angular.module("appModule").service("apiService",e)}(),function(){var e=function(e,t,o,n,i){var r={state:{authenticated:!1,loggedIn:!1},authenticate:function(e){if(r.state.authenticated)r.state.loggedIn=!0,e(!0);else{var t=o.authToken.getValue();t?i.post({authToken:t}).then(function(t){r.setAsLoggedIn(function(){e(!0,t)})},function(t){r.setAsLoggedOut(function(){e(!1,t)})}):r.setAsLoggedOut(function(){e(!1)})}},setAsLoggedIn:function(o){r.state.authenticated=!0,r.state.loggedIn=!0;var i=e.apiData.loggedInUser.appConfig;i.language!=n.language||i.theme!=n.theme?t.location.reload():(e.globalFormModels.personalDetailsModel.set(e.apiData.loggedInUser),e.globalFormModels.appConfigModel.set(e.apiData.loggedInUser.appConfig),o&&o())},setAsLoggedOut:function(t){r.state.authenticated=!1,r.state.loggedIn=!1,o.authToken.remove(),e.apiData.loggedInUser=void 0,t&&t()}};return r};e.$inject=["$rootScope","$window","storageService","sessionConst","UsersRest"],angular.module("appModule").service("authService",e)}(),function(){var e=function(e,t){var o={getCredentials:function(o,n){return n.authToken=t.authToken.getValue(),e.post("/get_aws3_upload_credentials",n,{headers:{subject:o}})},makeRequest:function(t,o){return e.post(t,o,{transformRequest:angular.identity,headers:{"Content-Type":void 0}})}};return o};e.$inject=["$http","storageService"],angular.module("appModule").service("aws3Service",e)}(),function(){var e=function(){var e={api:"http://api.fixer.io/latest?base=",availableRates:{USD:{sign:"$"},EUR:{sign:"€"},GBP:{sign:"£"}},decimalPlaces:2},t={},o={format:function(t,o){return angular.isDefined(t)&&angular.isDefined(o)?accounting.formatMoney(t,e.availableRates[o].sign+" ",e.decimalPlaces,",","."):null},convert:function(e,n,i){return Object.keys(t).length>0&&angular.isDefined(e)&&angular.isDefined(n)&&angular.isDefined(i)?(fx.settings={from:n},fx.base=t[i].base,fx.rates=t[i].rates,o.format(fx.convert(e,{to:i}),i)):null}};return{config:e,data:t,methods:o}};e.$inject=[],angular.module("appModule").service("exchangeRateService",e)}(),function(){var e=function(e,t){var o=new e.MyFile("public/json/countries.json",function(e){t.sort.objectsByProperty(o.data,"name",!0,function(n){t.group.sortedObjectsByPropFirstLetter(n,"name",function(t){o.data=t,e()})})});return{countries:o}};e.$inject=["myClass","jsonService"],angular.module("appModule").service("fileService",e)}(),function(){var e=function(e){var t={captchas:{},load:function(e,o,n){if(window.grecaptcha)return t.captchas[e]={actionName:o},window.grecaptcha.render(e,{sitekey:"6LdwIyQTAAAAABj159-NBLYxFY4vPRuqEBrYB_aE",callback:function(){n()}})},reset:function(e){window.grecaptcha&&window.grecaptcha.reset(e)},getResponse:function(e){if(window.grecaptcha&&e)return window.grecaptcha.getResponse(e.grecaptchaId)},shouldBeVisible:function(o,n){window.grecaptcha?e.get().then(function(e){var i=e.data.badActionsCount;n(i[t.captchas[o].actionName]>=i.max)}):n(!1)}};return t};e.$inject=["sessionService"],angular.module("appModule").service("grecaptchaService",e)}(),function(){var e=function(e,t){var o={all:e,get:function(){return e[t.language||"en"]},bind:function(e){var t;if(e.hardData?t=e.hardData:e.ins&&e.ins.hardData&&(t=e.ins.hardData),t){var n=o.get();angular.forEach(t,function(t,o){var i=t[0];if(Array.isArray(t[1])){var r=t[1],a=o.split("_");if(2==a.length&&"switchers"==a[0]){var c=0;o=a[1],angular.forEach(e.ins.switchers,function(e,t){"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(e[o]=n[i][r[c++]])})}else e[o]=[],angular.forEach(r,function(t){e[o].push(n[i][t])})}else{var s=t[1];e[o]=n[i][s]}})}e.ins&&angular.forEach(e.ins.switchers,function(e,t){"object"==_typeof(e.label)&&(e.label=e.label[o.get()._id])})}};return o};e.$inject=["hardDataConst","sessionConst"],angular.module("appModule").service("hardDataService",e)}(),function(){var e=function(){var e={firstLettersArray:function(e,t,o){try{for(var n=Object.keys(e),i=[],r=[],a=0;a<n.length;++a)i.push(e[n[a]][t][0]);$.each(i,function(e,t){$.inArray(t,r)===-1&&r.push(t)}),o(r)}catch(c){o()}},firstElemOf:function(e){return Array.isArray(e)?e[0]:e[Object.keys(e)[0]]}},t={objectByProperty:function(e,t,o,n){for(var i=0;i<e.length;i++)e[i][t]==o&&n(e[i]);n(null)}},o={objectsByProperty:function(e,t,o,n){e.sort(function(e,n){return e[t]>n[t]?o?1:-1:e[t]<n[t]?o?-1:1:0}),n&&n(e)}},n={sortedObjectsByPropFirstLetter:function(e,t,o){for(var n,i=[],r=0;r<e.length;r++){var a=e[r][t][0];a!==n&&(n=a,i.push({label:n,children:[]})),i[i.length-1].children.push(e[r])}o(i)}},i={objectsByProperty:function(e,t,o){var n=Object.keys(t)[0],i=t[n],r=[];angular.forEach(e,function(e){e[n]==i&&r.push(e)}),o(r)}};return{get:e,find:t,sort:o,group:n,filter:i}};e.$inject=[],angular.module("appModule").service("jsonService",e)}(),function(e){var t=function(e){var t={home:"http://192.168.43.4:7100",work:"",school:"",current:"home"},o={allowSendingLogs:!0},n={api:[]},i=function(e){a(e,void 0)},r=function(){for(var e=Object.keys(n),t=0;t<e.length;++t)i(e[t])},a=function(n,i){if(o.allowSendingLogs){var r=t[t.current]+"/"+n;e({url:r,method:"POST",data:i,headers:{"Content-Type":"application/json"}})}},c=function(e,t,o){e&&(o?console.log(t,o):console.log(t))};return{urls:t,options:o,logs:n,reset:i,resetAll:r,post:a,log:c}};t.$inject=["$http"],e?module.exports=(new t).logs:(t.$inject=["$http"],angular.module("appModule").service("logService",t))}("undefined"!=typeof module&&module.exports),function(){var e=function(e){var t={get:function(t){return e.get("/session")}};return t};e.$inject=["$http"],angular.module("appModule").service("sessionService",e)}(),function(){var e=function(e,t){var o={};return angular.forEach(e,function(e,n){o[n]=new t(e)}),o};e.$inject=["myStorageConf","MyStorageItem"],angular.module("appModule").service("storageService",e)}(),function(){var e=function(e,t,o,n,i,r,a,c,s,l){angular.forEach(e.switchers,function(e){_.assign(_.find(t.switchers,function(t){return t._id==e._id}),e),_.assign(_.find(a.switchers,function(t){return t._id==e._id}),e)});var u={frames:{main:new s.MySwitchable(e)},menus:{top:new s.MySwitchable(t)},listGroups:{settings:new s.MySwitchable(o)},tabs:{guest:new s.MySwitchable(n),application:new s.MySwitchable(i.application),account:new s.MySwitchable(i.account),payment:new s.MySwitchable(i.payment),danger:new s.MySwitchable(i.danger),item:new s.MySwitchable(r)},dropdowns:{mainFrameNav:new s.MySwitchable(a),settingsCategories:new s.MySwitchable($.extend(!0,{_ctrlId:"settingsCategoriesDropdown","class":"dropdown"},o))},modals:c,loaders:{renderer:new s.MyLoader}};return l.bindGetRouteMethod(u),u};e.$inject=["mainFrameConf","topNavMenuConf","settingsListGroupConf","guestTabsConf","settingsTabsConf","itemTabsConf","mainFrameNavConf","modalsConf","myClass","uiSetupService"],angular.module("appModule").service("ui",e)}(),function(){var e=function(){var e={bindGetRouteMethod:function(e){var t=e.frames.main.getSwitcher("_id","settings");e.dropdowns.mainFrameNav.getSwitcher("_id","settings").getRoute=function(){return t.getRoute.call(this,e)},angular.forEach(e.listGroups.settings.switchers,function(o,n){o.getRoute=function(){return t.getRoute.call(this,e)},e.dropdowns.settingsCategories.switchers[n].getRoute=function(){return t.getRoute.call(this,e)}})},reInitCtrls:function(e){}};return e};e.$inject=[],angular.module("appModule").service("uiSetupService",e)}(),function(){var e=function(){var e={themes:{standard:'<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" integrity="sha384-+ENW/yibaokMnme+vBLnHMphUYxHs34h9lpdbSLuAwGkOKFRl4C34WkjazBtb7eT" crossorigin="anonymous">',darkly:'<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/darkly/bootstrap.min.css" rel="stylesheet" integrity="sha384-S7YMK1xjUjSpEnF4P8hPUcgjXYLZKK3fQW1j5ObLSl787II9p8RO9XUGehRmKsxd" crossorigin="anonymous">',cerulean:'<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" integrity="sha384-zF4BRsG/fLiTGfR9QL82DrilZxrwgY/+du4p/c7J72zZj+FLYq4zY00RylP9ZjiT" crossorigin="anonymous">',slate:'<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/slate/bootstrap.min.css" rel="stylesheet" integrity="sha384-RpX8okQqCyUNG7PlOYNybyJXYTtGQH+7rIKiVvg1DLg6jahLEk47VvpUyS+E2/uJ" crossorigin="anonymous">',cosmo:'<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" integrity="sha384-h21C2fcDk/eFsW9sC9h0dhokq5pDinLNklTKoxIZRUn3+hvmgQSffLLQ4G4l2eEr" crossorigin="anonymous">'},include:function(t){"raw"!=t&&$("head").append(e.themes[t]),$("head").append('<link rel="stylesheet" href="public/appStyles.css" />')}};return e};e.$inject=[],angular.module("appModule").service("uiThemeService",e)}(),function(){var e=function(){var e=function(e){var t=document.createElement("script");t.type="application/javascript",t.async=!0,t.src=e,document.body.appendChild(t)},t=function(e){var t;t=e.split(",")[0].indexOf("base64")>=0?atob(e.split(",")[1]):unescape(e.split(",")[1]);
for(var o=e.split(",")[0].split(":")[1].split(";")[0],n=new Uint8Array(t.length),i=0;i<t.length;i++)n[i]=t.charCodeAt(i);var r=new Blob([n],{type:o});return r};return{loadScript:e,dataURItoBlob:t}};e.$inject=[],angular.module("appModule").service("utilService",e)}(),function(){var e=function(e,t,o,n,i,r,a,c,s,l,u,d){return{MySwitchable:e,MySwitcher:t,MyLoader:o,MyModal:n,MyFile:i,MySrc:r,MyStorageItem:a,MyFormModel:c,MyCollectionBrowser:s,MySrcCollection:l,MyForm:u,MySrcAction:d}};e.$inject=["MySwitchable","MySwitcher","MyLoader","MyModal","MyFile","MySrc","MyStorageItem","MyFormModel","MyCollectionBrowser","MySrcCollection","MyForm","MySrcAction"],angular.module("appModule").factory("myClass",e)}(),function(){var e=function t(e,o,n,i){var r=e.get(),t=function a(e){if(Object.assign(a.prototype,o.prototype),Object.assign(this,e),this.ctrls=[{name:"pager",paramName:"page"},{name:"filterer",paramName:"filter"},{name:"sorter",paramName:"sort"},{name:"orderer",paramName:"order"}],this.filterer&&(this.filterer=new n(this.filterer),this.filterer._id="filterer"),this.sorter){this.sorter=new n(this.sorter),this.sorter._id="sorter",this.sorter.togglerLabel=r.phrases[90];for(var t in this.sorter.switchers)this.sorter.switchers[t].onClick=this.onClick;this.orderer=new n({switchers:[{_id:"asc",label:r.phrases[87]},{_id:"desc",label:r.phrases[88]}]}),this.orderer._id="orderer"}this.loader=new i};return t.prototype.init=function(e){var t=this;t.loader.start(!1,function(){try{t.fetchData(t.createFetchQuery()).then(function(o){if(t.meta.count>0){for(var i=Math.ceil(t.meta.count/t.singlePageSize),a=[],c=0;c<i;c++)a.push({_id:c+1,label:"#"+(c+1)});var s;t.pager&&(s=t.pager.activeSwitcherId),t.pager=new n({_id:"pager",switchers:a}),t.pager.togglerLabel=r.phrases[89],s&&t.pager.activateSwitcher(s)}else t.pager=void 0;var l=function(e){e.onClick=function(){t.onChoose(e)}};for(var u in t.ctrls)t[t.ctrls[u].name]&&angular.forEach(t[t.ctrls[u].name].switchers,l);t.updateRefresher(),t.loader.stop(function(){e&&e(!0)})},function(o){t.flush(),t.loader.stop(function(){e&&e(!1)})})}catch(o){t.flush(),t.loader.stop(function(){e&&e(!1)})}})},t.prototype.setData=function(e){this.meta=e.meta,this.collection=e.collection},t.prototype.onRefreshClick=function(){var e,t=this;t.pager&&(e=t.pager.activeSwitcherId),t.init(function(){t.pager&&angular.isDefined(e)&&t.pager.activateSwitcher(e)})},t.prototype.createFetchQuery=function(){var e={};return this.pager&&this.pager.activeSwitcherId?e.skip=(this.pager.activeSwitcherId-1)*this.singlePageSize:e.skip=0,this.filterer&&(e.filter=this.filterer.activeSwitcherId),this.sorter&&(e.sort=this.sorter.activeSwitcherId,this.orderer&&"desc"==this.orderer.activeSwitcherId&&(e.sort="-"+e.sort)),this.orderer&&(e.order=this.orderer.activeSwitcherId),e},t.prototype.updateRefresher=function(){this.refresher={},this.collection&&(this.meta.count>0?this.refresher.refresherLabel=r.phrases[92]+" "+this.meta.count:this.refresher.refresherLabel=r.phrases[64]),this.meta.count>0?this.refresher["class"]="btn-info":this.refresher["class"]="btn-warning"},t.prototype.getElemNumber=function(e){if(this.pager&&this.pager.activeSwitcherId)return(this.pager.activeSwitcherId-1)*this.singlePageSize+e+1},t.prototype.onChoose=function(e){var t,o=this;e._id!=e.parent.activeSwitcherId&&(e.activate(),o.pager&&(t=o.pager.activeSwitcherId),"pager"==e.parent._id&&o.init(function(){o.pager&&angular.isDefined(t)&&o.pager.activateSwitcher(t),"pager"!==e.parent._id&&o[e.parent._id].activateSwitcher(e._id)}))},t.prototype.flush=function(){this.pager=void 0,this.filterer=void 0,this.sorter=void 0,this.orderer=void 0},t.prototype.isReady=function(){return!this.loader.isLoading&&this.refresher},t};e.$inject=["hardDataService","MyCollectionSelector","MySwitchable","MyLoader"],angular.module("appModule").factory("MyCollectionBrowser",e)}(),function(){var e=function t(){var t=function(){};return t.prototype.selectAll=function(){for(var e in this.collection)this.collection[e].isSelected=!0},t.prototype.deselectAll=function(){for(var e in this.collection)this.collection[e].isSelected=!1},t.prototype.getSelectedCollection=function(){var e=[],t=!0,o=!1,n=void 0;try{for(var i,r=this.collection[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){var a=i.value;a.isSelected&&e.push(a)}}catch(c){o=!0,n=c}finally{try{!t&&r["return"]&&r["return"]()}finally{if(o)throw n}}return e},t};e.$inject=[],angular.module("appModule").factory("MyCollectionSelector",e)}(),function(){var e=function t(e){var t=function(e,t){this.url=e,this.alterData=t,this.data=void 0};return t.prototype.readFile=function(t){var o=this;e.get(o.url).success(function(e){o.data=e,t&&t(!0)}).error(function(){o.data=void 0,t&&t(!1)})},t};e.$inject=["$http"],angular.module("appModule").factory("MyFile",e)}(),function(){var e=function(t,o,n,i){return e=function(e){this.ctrlId=e.ctrlId,this.model=e.model,this.reload=e.reload,this.noLoader=e.noLoader,this.submitAction=e.submitAction,this.submitSuccessCb=e.submitSuccessCb,this.submitErrorCb=e.submitErrorCb},e.prototype.submit=function(){var e=this;e.scope.captcha&&e.scope.captcha.visible!==!1||e.scope.loader.start(!1,function(){e.model.trimValues(e.scope.ctrlId,function(){var o={};o.captchaResponse=i.getResponse(e.scope.captcha);var r=e.submitAction(o);r&&r.then(function(t){e.model.clearErrors(function(){n(function(){e.scope.loader.stop()})}),e.submitSuccessCb&&e.submitSuccessCb(t)},function(o){o&&o.data&&o.data.errors?e.model.bindErrors(o.data.errors,function(){n(function(){e.scope.loader.stop()})}):e.model.clearErrors(function(){n(function(){e.scope.loader.stop(function(){t.ui.modals.tryAgainLaterModal.show()})})}),e.scope.captcha&&i.shouldBeVisible(e.scope.captcha.ctrlId,function(t){n(function(){e.scope.captcha.visible=t},500)}),e.submitErrorCb&&e.submitErrorCb(o)})})})},e.prototype.clear=function(){this.model.clear()},e.prototype.reset=function(){this.model.clear(),this.model.set(),this.scope.$broadcast("reset")},e};e.$inject=["$rootScope","$window","$timeout","grecaptchaService"],angular.module("appModule").factory("MyForm",e)}(),function(){var e=function t(e){var o=function(e,t,o){this.value=e,this.error=t,this.errorType=o},t=function(e,t,o,n){this._id=e,this.keys=t,this.values={},this.defaults=void 0,this.allowUseDefaults=o,this.onSetCallback=n,this.clear()};return t.prototype={set:function(e){var t=this;"object"==("undefined"==typeof e?"undefined":_typeof(e))?(t.allowUseDefaults&&Object.keys(e).length>0&&(t.defaults=e),_.isEmpty(e)?angular.forEach(t.keys,function(e){t.values[e].value=null}):angular.forEach(t.keys,function(o){angular.isDefined(e[o])?t.values[o].value=e[o]:t.values[o].value=null})):this.allowUseDefaults&&t.defaults&&angular.forEach(t.keys,function(e){angular.isDefined(t.defaults[e])?t.values[e].value=t.defaults[e]:t.values[e].value=null})},setValue:function(e,t){this.values[e].value=t},clear:function(){var e=this;angular.forEach(e.keys,function(t){e.values[t]=new o(null,null,null)})},trimValues:function(e,t){var o=this;angular.forEach(o.keys,function(t){if("number"!=typeof o.values[t].value){var n=$("#"+e+" #"+t);if(n.length>0){var i=$(n).val();if(i){var r=i.trim();o.values[t].value=r,$(n).val(r)}else o.values[t].value=null}}}),t&&t()},getValues:function(){var e=this,t={};return angular.forEach(e.keys,function(o){t[o]=e.values[o].value}),t},getValue:function(e){return this.values[e].value},bindErrors:function(e,t){var o=this;angular.isDefined(e)?(angular.forEach(o.keys,function(t){e[t]?(o.values[t].errorType=e[t].kind,o.values[t].error=e[t].message):(o.values[t].errorType=null,o.values[t].error=null)}),t&&t()):t&&t()},clearErrors:function(e){var t=this;angular.forEach(t.keys,function(e){t.values[e].error=null,t.values[e].errorType=null}),e&&e()},setRestObj:function(e,t){var o=this;angular.forEach(o.keys,function(t){e[t]=o.values[t].value}),t&&t()}},t};e.$inject=["$timeout"],angular.module("appModule").factory("MyFormModel",e)}(),function(){var e=function t(e){var t=function(){this.isLoading=!1};return t.prototype.minLoadTime=500,t.prototype.start=function(t,o){var n=this;n.isLoading=!0,e(function(){o&&o(),t&&n.stop()},n.minLoadTime)},t.prototype.stop=function(e){this.isLoading=!1,e&&e()},t};e.$inject=["$timeout"],angular.module("appModule").factory("MyLoader",e)}(),function(){var e=function t(e,o){var t=function(e){Object.assign(this,e)};return t.prototype.prepareToShow=function(t,o){var n;this.typeId&&(n=e.ui.modals[this.typeId],n.flush()),n?(Object.assign(n,this),Object.assign(n,t),o(n)):(Object.assign(this,t),o(this))},t.prototype.show=function(t){var n=this;n.prepareToShow(t,function(t){e.isAnyModalOpen?($(".modal").modal("hide"),o(function(){$("#"+t.id).modal("show")},t.timeout)):o(function(){$("#"+t.id).modal("show")})})},t.prototype.hide=function(e){$("#"+this.id).modal("hide"),e&&o(function(){e()},this.timeout)},t.prototype.accept=function(){var e=this;$("#"+e.id).modal("hide"),e.acceptCb&&o(function(){e.acceptCb()},e.timeout)},t.prototype.dismiss=function(){var e=this;$("#"+e.id).modal("hide"),e.dismissCb&&o(function(){e.dismissCb()},e.timeout)},t.prototype.flush=function(){var e=Object.keys(this);for(var t in e)"id"!=e[t]&&(this[e[t]]=void 0)},t.prototype.timeout=500,t};e.$inject=["$rootScope","$timeout"],angular.module("appModule").factory("MyModal",e)}(),function(){var e=function t(e,o,n,i){var r=500,t=function(e){e&&(this.defaultUrl=e.defaultUrl,this.constructUrl=e.constructUrl,this.uploadRequest=e.uploadRequest,this.removeRequest=e.removeRequest),this.loader=new i};return t.prototype.load=function(e,t,i){var a=this;if(!e&&a.constructUrl&&(e=a.constructUrl(a.index)),t&&(a.url=void 0),e!=a.url)return a.loader.start(),a.deferred=o.defer(),a.deferred.promise.then(function(e){e||a.defaultUrl&&(a.url=a.defaultUrl),a.loader.stop(),i&&i(e)}),n(function(){a.url=e},r),a.deferred.promise},t.prototype.loadSecondary=function(){this.defaultUrl&&this.load(this.defaultUrl)},t.prototype.isDefaultUrlLoaded=function(){if(this.defaultUrl)return this.url==this.defaultUrl},t.prototype.update=function(e,t,n){var i=this;return o(function(o){i.loader.start(!1,function(){i.uploadRequest(e,n).then(function(e){e.success?(t?i.loader.stop():i.load(e.url,!0),o(!0)):(i.loader.stop(),o(!1))})})})},t.prototype.remove=function(e,t){var n=this;return e||(e={}),o(function(o){n.loader.start(!1,function(){e._id=n._id,n.removeRequest(e).then(function(e){e?t&&n.loadSecondary():n.loader.stop(),o(e)})})})},t};e.$inject=["$rootScope","$q","$timeout","MyLoader"],angular.module("appModule").factory("MySrc",e)}(),function(){var e=function t(e,o){var t=function(e){e&&(this.acceptedFiles=e.acceptedFiles,this.maxFiles=e.maxFiles,this.maxFileSize=e.maxFileSize,this.getFilesCount=e.getFilesCount)};return t.prototype.validate=function(e,t){var n=this;switch(e){case"updateSingle":return o(function(e){var o=n.getValidFileTypes();if(1==t.length){if(o.indexOf(t[0].type)==-1)return void e({success:!1,msgId:"WRONG_FILE_TYPE"});if(t[0].size>n.maxFileSize)return void e({success:!1,msgId:"FILE_TOO_LARGE"});e({success:!0})}else e({success:!1,msgId:"UPLOADING_TOO_MANY_FILES"})});case"addToSet":return o(function(e){if(t&&t.length>0){var o=_.uniqBy(t,"name");if(o.length==t.length){var i=n.getFilesCount();if(i<n.maxFiles){var r=n.maxFiles-i;if(t.length<=r){for(var a=n.getValidFileTypes(),c=0;c<t.length;c++){if(a.indexOf(t[c].type)==-1)return void e({success:!1,msgId:"WRONG_FILE_TYPE"});if(t[c].size>n.maxFileSize)return void e({success:!1,msgId:"FILE_TOO_LARGE"})}e({success:!0})}else e({success:!1,msgId:"UPLOADING_TOO_MANY_FILES"})}else e({success:!1,msgId:"MAX_FILES_UPLOADED"})}else e({success:!1,msgId:"INPUT_FILES_CONSISTS_OF_DUPLICATES"})}else e({success:!1,msgId:"NO_FILES_LOADED"})});case"delete":return o(function(e){e({success:!0})});default:return o(function(e){e({success:!1})})}},t.prototype.getValidFileTypes=function(){return this.acceptedFiles.split(",")},t.prototype.displayModalMessage=function(t,o){var n,i=e.globalFormModels.personalDetailsModel.getValue("username");switch(t){case"confirmDeletion":n={title:e.hardData.phrases[109],acceptCb:o},e.ui.modals.confirmProceedModal.show(n);break;case"MAX_FILES_UPLOADED":n={title:i,message:e.hardData.sentences[30]},e.ui.modals.infoModal.show(n);break;case"UPLOADING_TOO_MANY_FILES":n={title:i,message:e.hardData.sentences[31]},e.ui.modals.infoModal.show(n);break;case"filenameAlreadyExists":n={title:i,message:e.hardData.sentences[32]},e.ui.modals.infoModal.show(n);break;case"WRONG_FILE_TYPE":n={title:i,message:e.hardData.sentences[25]},e.ui.modals.infoModal.show(n);break;case"FILE_TOO_LARGE":n={title:i,message:e.hardData.sentences[26]+this.maxFileSize/1024/1024+" Mb."},e.ui.modals.infoModal.show(n)}},t.createFormDataObject=function(e,t){var o=new FormData;return angular.forEach(e,function(e,t){o.append(t,e)}),o.append("file",t),o},t};e.$inject=["$rootScope","$q"],angular.module("appModule").factory("MySrcAction",e)}(),function(){var e=function t(e,o,n,i,r){var t=function a(e){Object.assign(a.prototype,n.prototype),e&&(this.remove=e.remove,this.srcArgs={defaultUrl:e.defaultUrl,constructUrl:e.constructUrl,uploadRequest:e.uploadRequest,removeRequest:e.removeRequest}),this.collection=[],this.loader=new r};return t.prototype.init=function(e,t){var n=this;e.length>0?n.loader.start(!1,function(){n.collection.length=0;var r=[];for(var a in e){var c=new i(n.srcArgs);c.index=Number(a),Object.assign(c,e[a]),n.collection.push(c),r.push(n.collection[a].load(c.constructUrl(a)))}o.all(r).then(function(e){n.loader.stop(),t&&t(e)})}):(n.collection.length=0,t&&t())},t.prototype.updateSingle=function(e,t){var o=this,n=new i(o.srcArgs);n.index=e.src.index,o.collection[n.index]=n,n.uploadRequest(e,void 0,0).then(function(e){e||(o.collection[src.index]=src),t&&t(e)})},t.prototype.addToSet=function(e,t){var n=this;n.loader.start(!1,function(){var r=[],a=n.collection.length;for(var c in e.inputData)if(e.inputData[c]instanceof File){var s=new i(n.srcArgs);s.index=Number(c)+a,n.collection.push(s),r.push(s.uploadRequest(e,c,Number(c)))}o.all(r).then(function(e){for(var o=e.length-1;o>=0;o--)e[o]||n.collection.splice(Number(o)+a,1);t&&t(e)})})},t.prototype.removeFromSet=function(t,o){var n=this;0===t.collection.length?e.ui.modals.infoModal.show({title:e.apiData.loggedInUser.username,message:e.hardData.sentences[35],hideCb:function(){o(!1)}}):e.ui.modals.confirmProceedModal.show({title:e.hardData.phrases[109],acceptCb:function(){n.loader.start(!1,function(){var e=[];for(var i in t.collection)e.push(t.collection[i].index);n.remove(e).then(function(e){o&&o(!0,e.data)},function(e){o&&o(!1,e.data)})})},hideCb:function(){o&&o()}})},t.prototype.moveSingle=function(e,t,o){var n=this;n.collection.length>1&&n.loader.start(!1,function(){switch(t=n.collection.splice(t.index,1)[0],e){case"moveLeft":t.index>0?n.collection.splice(t.index-1,0,t):n.collection.splice(n.collection.length,0,t);break;case"moveRight":t.index<n.collection.length?n.collection.splice(t.index+1,0,t):n.collection.splice(0,0,t)}for(var i in n.collection)n.collection[i].index=Number(i);o&&o()})},t};e.$inject=["$rootScope","$q","MyCollectionSelector","MySrc","MyLoader"],angular.module("appModule").factory("MySrcCollection",e)}(),function(){var e=function t(e){var t=function(e){this._id=e._id,this.type=e.type,angular.isDefined(e.daysToExpire)&&(this.daysToExpire=e.daysToExpire)};return t.prototype.getValue=function(){switch(this.type){case"cookie":return e.cookie.get(this._id);case"localStorageItem":return e.get(this._id)}},t.prototype.setValue=function(t){switch(this.type){case"cookie":e.cookie.set(this._id,t,this.daysToExpire);break;case"localStorageItem":e.set(this._id,t)}},t.prototype.remove=function(){switch(this.type){case"cookie":e.cookie.remove(this._id);break;case"localStorageItem":e.remove(this._id)}},t};e.$inject=["localStorageService"],angular.module("appModule").factory("MyStorageItem",e)}(),function(){var e=function t(e,o,n){var t=function(e){Object.assign(this,$.extend(!0,{},e)),this.instantiateSwitchers()};return t.prototype.instantiateSwitchers=function(t,o){var n=this;t&&(n.switchers=t),n.switchers&&(n.switcherIds=[],angular.forEach(n.switchers,function(t,o){"object"==("undefined"==typeof t?"undefined":_typeof(t))&&(n.switchers[o]=new e(t,n),n.switcherIds.push(t._id))}),n.activeSwitcherId=n.switcherIds[0]),o&&o()},t.prototype.activateSwitcher=function(e){var t;switch(e){case"prev":t=this.getActiveSwitcherIndex(),t>0?this.switchers[t-1].activate():this.switchers[this.switchers.length-1].activate();break;case"next":t=this.getActiveSwitcherIndex(),t<this.switchers.length-1?this.switchers[t+1].activate():this.switchers[0].activate();break;default:var o=this.getSwitcher("_id",e);o?o.activate():this.activeSwitcherId=void 0}},t.prototype.getSwitcher=function(e,t){var o=this;return o.switchers?_.find(o.switchers,function(o){return o[e]==t}):null},t.prototype.getActiveSwitcher=function(){var e=this;return _.find(e.switchers,function(t){return t._id==e.activeSwitcherId})},t.prototype.getActiveSwitcherIndex=function(){for(var e=this.getActiveSwitcher(),t=0;t<this.switchers.length;t++)if(this.switchers[t]._id==e._id)return t;return-1},t.prototype.getFirstSwitcher=function(){return _.head(this.switchers)},t};e.$inject=["MySwitcher","jsonService","hardDataService"],angular.module("appModule").factory("MySwitchable",e)}(),function(){var e=function t(){var t=function(e,t){Object.assign(this,e),this.parent=t};return t.prototype.activate=function(e){this.parent.activeSwitcherId=this._id,!e&&this.onActivate&&this.onActivate()},t};e.$inject=[],angular.module("appModule").factory("MySwitcher",e)}(),function(){var e=function(e){return e.service("app_configs")};e.$inject=["Restangular"],angular.module("appModule").factory("AppConfigsRest",e)}(),function(){var e=function(e){return e.service("comments")};e.$inject=["Restangular"],angular.module("appModule").factory("CommentsRest",e)}(),function(){var e=function(e,t){var o=e.service("contact_types");return o};e.$inject=["Restangular","storageService"],angular.module("appModule").factory("ContactTypesRest",e)}(),function(){var e=function(e){return e.service("deactivation_reasons")};e.$inject=["Restangular"],angular.module("appModule").factory("DeactivationReasonsRest",e)}(),function(){var e=function(e){return e.service("item_categories")};e.$inject=["Restangular"],angular.module("appModule").factory("ItemCategoriesRest",e)}(),function(){var e=function(e,t){var o=t.service("users");return t.extendModel("users",function(t){return t._isTheOneLoggedIn=function(){return t._id==e.apiData.loggedInUser._id},t}),o};e.$inject=["$rootScope","Restangular"],angular.module("appModule").factory("UsersRest",e)}(),function(){var e=angular.module("appModule");e.directive("formActionBtns",function(){var e={restrict:"E",templateUrl:"public/directives/^/btns/formActionBtns/formActionBtns.html",transclude:!0,scope:{myForm:"="},controller:function(e){var t=["loginForm","registerForm","recoverForm","passwordForm","deactivationForm","itemSearchForm","contactForm","itemForm","commentForm"],o=["regionalForm","appearanceForm","personalDetailsForm","itemForm"],n=["itemForm"];switch(e.myForm.showClearBtn=t.indexOf(e.myForm.ctrlId)>-1,e.myForm.showResetBtn=o.indexOf(e.myForm.ctrlId)>-1,e.myForm.showCancelBtn=n.indexOf(e.myForm.ctrlId)>-1,e.myForm.ctrlId){case"itemForm":e.myForm.submitBtnPhraseIndex=1;break;case"loginForm":case"registerForm":case"recoverForm":case"commentForm":e.myForm.submitBtnPhraseIndex=3;break;case"contactForm":e.myForm.submitBtnPhraseIndex=4;break;case"regionalForm":case"appearanceForm":case"personalDetailsForm":case"passwordForm":e.myForm.submitBtnPhraseIndex=5;break;case"itemSearchForm":e.myForm.submitBtnPhraseIndex=83}e.onSubmit=function(){e.myForm.submit()},e.onClear=function(){e.myForm.clear()},e.onReset=function(){e.myForm.reset()},e.onCancel=function(){e.myForm.onCancel()}},compile:function(e,t){return function(e,t,o){}}};return e})}(),function(){var e=angular.module("appModule");e.directive("scrollTopBtn",function(){var e={restrict:"E",templateUrl:"public/directives/^/btns/scrollTopBtn/scrollTopBtn.html",controller:function(e){e.scroll=function(){$("html, body").animate({scrollTop:0},"fast")}}};return e})}(),function(){var e=angular.module("appModule");e.directive("appearanceForm",["$rootScope","AppConfigsRest","MyForm","Restangular",function(e,t,o,n){var i={restrict:"E",templateUrl:"public/directives/^/forms/appearanceForm/appearanceForm.html",scope:!0,controller:function(t){var i=e.globalFormModels.appConfigModel;t.myForm=new o({ctrlId:"appearanceForm",model:i,reload:!0,submitAction:function(t){i.setValue("userId",e.globalFormModels.personalDetailsModel.getValue("_id"));var o=n.copy(e.apiData.loggedInUser.appConfig);return i.setRestObj(o),o.put()}})}};return i}])}(),function(){var e=angular.module("appModule");e.directive("contactForm",["$rootScope","$http","$timeout","ContactTypesRest","myClass",function(e,t,o,n,i){var r={restrict:"E",templateUrl:"public/directives/^/forms/contactForm/contactForm.html",scope:!0,controller:function(e){var t=new i.MyFormModel("contactForm",["contactType","contactMsg"],(!1));e.myForm=new i.MyForm({ctrlId:"contactForm",model:t,submitAction:function(e){return n.post(t.getValues())},submitSuccessCb:function(e){t.clear()}})},compile:function(t,o){return function(t,o,n){t.$watch(function(){return e.apiData.contactTypes},function(e){t.contactTypes=e})}}};return r}])}(),function(){var e=angular.module("appModule");e.directive("deactivationForm",["$rootScope","$timeout","$filter","ui","DeactivationReasonsRest","myClass",function(e,t,o,n,i,r){var a={restrict:"E",templateUrl:"public/directives/^/forms/deactivationForm/deactivationForm.html",scope:!0,controller:function(t){var o=e.globalFormModels.deactivationModel;t.myForm=new r.MyForm({ctrlId:"deactivationForm",model:o,submitAction:function(t,n){return e.apiData.loggedInUser.remove(o.getValues())},submitSuccessCb:function(t){e.logout({action:"deactivation"})}}),t.onDeactivateClick=function(){t.myForm.model.getValue("deactivationReasonId")&&e.ui.modals.confirmDeactivationModal1.show({acceptCb:function(){e.ui.modals.confirmDeactivationModal2.show({acceptCb:function(){t.myForm.submit()}})}})}},compile:function(t,o){return function(t,o,n){t.$watch(function(){return e.apiData.deactivationReasons},function(e){t.deactivationReasons=e})}}};return a}])}(),function(){var e=angular.module("appModule");e.directive("itemForm",["$rootScope","$state","$stateParams","myClass","ItemsRest","Restangular",function(e,t,o,n,i,r){var a={restrict:"E",templateUrl:"public/directives/^/forms/itemForm/itemForm.html",scope:{action:"@"},controller:function(o){o.minDate=new Date(2e3,0,1),o.maxDate=new Date,o.itemTypes=e.hardData.itemTypes,o.itemCategories=e.apiData.itemCategories,o.myModel=new n.MyFormModel("itemForm",["userId","date","typeId","categoryId","subcategoryId","title","description"],(!0)),o.myModel.set({date:new Date}),o.myForm=new n.MyForm({ctrlId:"itemForm",model:o.myModel}),o.myForm.submitAction=function(n){switch(o.action){case"report":return o.myModel.setValue("userId",e.globalFormModels.personalDetailsModel.getValue("_id")),o.myModel.getValue("date")||o.myModel.setValue("date",o.myModel.defaults.date),o.myForm.submitSuccessCb=function(e){o.myForm.reset(),t.go("main.item",{tab:"photos",id:e.data._id})},i.post(o.myModel.getValues());case"edit":var a=r.copy(e.apiData.item);return o.myModel.setRestObj(a),o.myForm.submitSuccessCb=function(o){e.apiData.item=o.data,t.go("main.item",{tab:"photos",id:o.data._id})},o.myForm.submitErrorCb=function(t){e.apiData.item=a},a.put()}},o.myForm.onCancel=function(){window.history.back()}},compile:function(t,o){return function(t,o,n){switch(t.action){case"edit":e.$$listeners.editItem||e.$on("editItem",function(e,o){o.item&&t.myModel.set(o.item)})}}}};return a}])}(),function(){var e=angular.module("appModule");e.directive("itemSearchForm",["$rootScope","myClass",function(e,t){var o={restrict:"E",templateUrl:"public/directives/^/forms/itemSearchForm/itemSearchForm.html",scope:!0,controller:function(o){o.itemCategories=e.apiData.itemCategories,o.myForm=new t.MyForm({ctrlId:"itemSearchForm",noLoader:!0,model:e.globalFormModels.itemSearchModel,submitAction:function(t){e.$broadcast("initSearchItems")}})}};return o}])}(),function(){var e=angular.module("appModule");e.directive("loginForm",["$rootScope","$timeout","$state","authService","MyForm","UsersRest",function(e,t,o,n,i,r){var a={restrict:"E",templateUrl:"public/directives/^/forms/loginForm/loginForm.html",scope:!0,controller:function(a){var c=e.globalFormModels.userModel;a.myForm=new i({ctrlId:"loginForm",model:c,submitAction:function(e){var t={username:c.getValue("username"),password:c.getValue("password")};return r.post(t,void 0,{captcha_response:e.captchaResponse})},submitSuccessCb:function(e){n.setAsLoggedIn(function(){t(function(){o.go("guest.1",{tab:"status"})})})},submitErrorCb:function(e){n.setAsLoggedOut()}})}};return a}])}(),function(){var e=angular.module("appModule");e.directive("passwordForm",["$rootScope","MyForm","Restangular",function(e,t,o){var n={restrict:"E",templateUrl:"public/directives/^/forms/passwordForm/passwordForm.html",scope:!0,controller:function(n){var i=e.globalFormModels.passwordModel;n.myForm=new t({ctrlId:"passwordForm",model:i,submitAction:function(t){var n=o.copy(e.apiData.loggedInUser);return n.currentPassword=i.getValue("currentPassword"),n.password=i.getValue("password"),n.put()},submitSuccessCb:function(e){i.clear()}})}};return n}])}(),function(){var e=angular.module("appModule");e.directive("personalDetailsForm",["$rootScope","fileService","MyForm","Restangular",function(e,t,o,n){var i={restrict:"E",templateUrl:"public/directives/^/forms/personalDetailsForm/personalDetailsForm.html",scope:!0,controller:function(i){i.countries=t.countries,i.myForm=new o({ctrlId:"personalDetailsForm",model:e.globalFormModels.personalDetailsModel,submitAction:function(t){var o=n.copy(e.apiData.loggedInUser);return i.myForm.model.setRestObj(o),o.put()}})}};return i}])}(),function(){var e=angular.module("appModule");e.directive("recoverForm",["$rootScope","$http","MyForm",function(e,t,o){var n={restrict:"E",templateUrl:"public/directives/^/forms/recoverForm/recoverForm.html",scope:!0,controller:function(n){var i=e.globalFormModels.userModel;n.myForm=new o({ctrlId:"recoverForm",model:i,submitAction:function(e){return t.post("/recover",{email:i.getValue("email")},{headers:{captcha_response:e.captchaResponse}})},submitSuccessCb:function(t){e.ui.modals.infoModal.show({title:t.data.msg.title,message:t.data.msg.info})}})}};return n}])}(),function(){var e=angular.module("appModule");e.directive("regionalForm",["$rootScope","AppConfigsRest","MyForm","Restangular",function(e,t,o,n){var i={restrict:"E",templateUrl:"public/directives/^/forms/regionalForm/regionalForm.html",scope:!0,controller:function(t){var i=e.globalFormModels.appConfigModel;t.myForm=new o({ctrlId:"regionalForm",model:i,reload:!0,submitAction:function(t){i.setValue("userId",e.globalFormModels.personalDetailsModel.getValue("_id"));var o=n.copy(e.apiData.loggedInUser.appConfig);return i.setRestObj(o),o.put()}})}};return i}])}(),function(){var e=angular.module("appModule");e.directive("registerForm",["$rootScope","$timeout","$state","authService","fileService","MyForm","UsersRest",function(e,t,o,n,i,r,a){var c={restrict:"E",templateUrl:"public/directives/^/forms/registerForm/registerForm.html",scope:!0,controller:function(c){c.countries=i.countries;var s=e.globalFormModels.userModel;c.myForm=new r({ctrlId:"registerForm",model:s,submitAction:function(e){return a.post(s.getValues(),void 0,{captcha_response:e.captchaResponse})},submitSuccessCb:function(e){n.setAsLoggedIn(function(){t(function(){o.go("guest.1",{tab:"status"})})})},submitErrorCb:function(e){n.setAsLoggedOut()}})}};return c}])}(),function(){var e=angular.module("appModule");e.directive("confirmDangerModal",function(){var e={restrict:"E",templateUrl:"public/directives/^/modals/confirmDangerModal/confirmDangerModal.html",scope:{ins:"="}};return e})}(),function(){var e=angular.module("appModule");e.directive("confirmModal",function(){var e={restrict:"E",templateUrl:"public/directives/^/modals/confirmModal/confirmModal.html",scope:{ins:"="}};return e})}(),function(){var e=angular.module("appModule");e.directive("infoModal",function(){var e={restrict:"E",templateUrl:"public/directives/^/modals/infoModal/infoModal.html",scope:{ins:"="}};return e})}(),function(){var e=angular.module("appModule");e.directive("imgCropWindow",["$rootScope","$window","$timeout","MySrcAction","MyModal","MyLoader","NUMS",function(e,t,o,n,i,r,a){var c="#cropImg",s="#cropInput",l=function(e){$(s).val(void 0),$(c).cropper("destroy"),$(c).attr("src",""),e.selectedFile=void 0},u={restrict:"E",templateUrl:"public/directives/^/windows/imgCropWindow/imgCropWindow.html",scope:{},controller:function(t){var l=new n({acceptedFiles:"image/png,image/jpg,image/jpeg",maxFileSize:a.photoMaxSize});t.modalWindow=new i({id:"imgCropModal",title:e.hardData.phrases[53]}),t.loader=new r,t.selectedFile=void 0,t.mode="crop",t.onBrowseClick=function(){$(s).click()},t.onFileSelected=function(e){1==e.target.files.length&&l.validate("updateSingle",[e.target.files[0]]).then(function(n){n.success?t.loader.start(!1,function(){t.selectedFile=e.target.files[0],t.mode="crop",t.$apply(),$(c).cropper("replace",URL.createObjectURL(e.target.files[0])),o(function(){t.loader.stop()},r.prototype.minLoadTime)}):l.displayModalMessage(n.msgId)})},t.onZoomInClick=function(){$(c).cropper("zoom",.1)},t.onZoomOutClick=function(){$(c).cropper("zoom",-.1)},t.onRotateClick=function(){$(c).cropper("rotate",90)},t.onResetClick=function(){$(c).cropper("reset")},t.onSwitchModeClick=function(){"crop"==t.mode?(t.mode="move",$(c).cropper("setDragMode","move")):"move"==t.mode&&(t.mode="crop",$(c).cropper("setDragMode","crop"))}},compile:function(e,o){return function(e,o,n){e.$on("displayImgCropWindow",function(t,o){l(e),e.modalWindow.show({acceptCb:function(){if(e.selectedFile){var t=$(c).cropper("getCroppedCanvas").toDataURL(e.selectedFile.type);o.acceptCb(t)}}}),$(c).cropper({viewMode:1,aspectRatio:1,autoCropArea:.5,minCropBoxWidth:50,minCropBoxHeight:50,background:!1})}),angular.element(t).bind("resize",function(){e.selectedFile&&$(c).cropper("replace",URL.createObjectURL(e.selectedFile))})}}};return u}])}(),function(){var e=angular.module("appModule");e.directive("auctionNumBox",["$rootScope","$sce","exchangeRateService",function(e,t,o){var n={restrict:"E",templateUrl:"public/directives/AUCTION/auctionNumBox/auctionNumBox.html",scope:{auction:"=auction"},controller:function(t){t.hardData=e.hardData,t.exchangeRateService=o,t.numValues=[{name:"initialValue",message:""},{name:"bidIncrement",message:""},{name:"minSellPrice",message:""}]},compile:function(e,n){return function(e,n,i){e.$watch(function(){return e.auction},function(n){if(n){var i=o.config.availableRates;for(var r in e.numValues){var a="";for(var c in i)if(c!=e.auction.currency){var s=o.methods.convert(e.auction[e.numValues[r].name],e.auction.currency,c);a+=s+"<br />"}e.numValues[r].message=t.trustAsHtml(a)}}})}}};return n}])}(),function(){var e=angular.module("appModule");e.directive("comments",["$rootScope","commentsConf","myClass","CommentsRest",function(e,t,o,n){var i={restrict:"E",templateUrl:"public/directives/COMMENT/comments/comments.html",scope:{ctrlId:"@"},controller:function(i){i.apiData=e.apiData,i.hardData=e.hardData,i.myForm=new o.MyForm({ctrlId:"commentForm",model:new o.MyFormModel("commentModel",["userId","content"],(!1)),submitAction:function(t){var o=e.globalFormModels.personalDetailsModel.getValue("_id");return i.myForm.model.setValue("userId",o),n.post(i.myForm.model.getValues(),{itemId:e.apiData.item._id})},submitSuccessCb:function(t){i.myForm.model.clear(),e.$broadcast("initItemComments")}}),i.init=function(){i.collectionBrowser=t.itemCommentsBrowser,i.commentContextMenuConf=t.commentContextMenuConf,
i.collectionBrowser.init()},i.collectionBrowser||i.init()},compile:function(t,o){return function(t,o,n){e.$$listeners["init"+t.ctrlId]||e.$on("init"+t.ctrlId,function(e,o){t.init()}),t.$on("$destroy",function(){e.$$listeners["init"+t.ctrlId]=null})}}};return i}])}(),function(){var e=function(e,t,o,n){var i=t.get();return this.commentContextMenuConf={icon:"glyphicon glyphicon-option-horizontal",switchers:[{_id:"edit",label:i.phrases[68],onClick:function(){}},{_id:"delete",label:i.phrases[14],onClick:function(){this.parent.data.remove({itemId:e.apiData.item._id}).then(function(){e.$broadcast("initItemComments")})}}]},this.itemCommentsBrowser=new n.MyCollectionBrowser({singlePageSize:10,fetchData:function(t){if(e.apiData.item)return t.itemId=e.apiData.item._id,o.getList(t)}}),this};e.$inject=["$rootScope","hardDataService","CommentsRest","myClass"],angular.module("appModule").service("commentsConf",e)}(),function(){var e=angular.module("appModule");e.directive("itemAvatar",["itemAvatarService","itemAvatarConf","MySrc",function(e,t,o){var n={restrict:"E",templateUrl:"public/directives/ITEM/itemAvatar/itemAvatar.html",scope:{item:"="},controller:function(e){e.src=new o({defaultUrl:t.defaultUrl})},compile:function(t,o){return function(t,o,n){t.$watch(function(){return t.item},function(o){o&&(t.src.href="/#/item/photos?id="+o._id,t.src.load(e.constructPhotoUrl(t,!0)))})}}};return n}])}(),function(){var e=function(){var e={defaultUrl:"public/imgs/item.png"};return e};e.$inject=[],angular.module("appModule").service("itemAvatarConf",e)}(),function(){var e=function(e){var t={constructPhotoUrl:function(t,o){return t.item.avatarFileName?o?e.AWS3_RESIZED_UPLOADS_BUCKET_URL+"resized-"+t.item.userId+"/items/"+t.item._id+"/"+t.item.avatarFileName:e.AWS3_UPLOADS_BUCKET_URL+t.item.userId+"/items/"+t.item._id+"/"+t.item.avatarFileName:t.src.defaultUrl}};return t};e.$inject=["URLS"],angular.module("appModule").service("itemAvatarService",e)}(),function(){var e=angular.module("appModule");e.directive("itemIconMenu",["$rootScope","ui",function(e,t){var o={restrict:"E",templateUrl:"public/directives/ITEM/itemIconMenu/itemIconMenu.html",scope:{item:"="},controller:function(o){o.personalDetailsModel=e.globalFormModels.personalDetailsModel,o.mainFrame=t.frames.main}};return o}])}(),function(){var e=angular.module("appModule");e.directive("itemPhotos",["$rootScope","itemPhotosService","itemPhotosConf","MySrcCollection","MySrcAction","NUMS",function(e,t,o,n,i,r){var a={restrict:"E",templateUrl:"public/directives/ITEM/itemPhotos/itemPhotos.html",scope:{item:"=",editable:"&"},controller:function(t){t.srcAction=new i({acceptedFiles:"image/png,image/jpg,image/jpeg",maxFiles:r.itemMaxPhotos,maxFileSize:r.photoMaxSize,getFilesCount:function(){return e.apiData.item.photos.length}}),t.mainContextMenuConf=o.getMainContextMenuConf(t),t.srcContextMenuConf=o.getSrcContextMenuConf(t)},compile:function(e,i){return function(e,i,r){e.$watch(function(){return e.item},function(i){i&&(e.srcThumbsCollection=new n({defaultUrl:o.defaultUrl,constructUrl:function(o){return t.constructPhotoUrl(e.item.userId,e.item._id,e.item.photos[o].filename,!0)},uploadRequest:t.uploadRequest,remove:function(t){for(var o=t.length-1;o>=0;o--)e.item.photos.splice(t[o],1);return e.item.put()}}),e.srcSlidesCollection=new n({defaultUrl:o.defaultUrl,constructUrl:function(o){return t.constructPhotoUrl(e.item.userId,e.item._id,e.item.photos[o].filename,!1)}}),e.srcThumbsCollection.init(e.item.photos),e.srcSlidesCollection.init(e.item.photos,function(){for(var t in e.srcSlidesCollection.collection)e.srcSlidesCollection.collection[t].href=e.srcSlidesCollection.collection[t].url}))})}}};return a}])}(),function(){var e=function(e,t){var o={defaultUrl:"public/imgs/item.png",getMainContextMenuConf:function(o){var n=function(){if(o.srcThumbsCollection)return 0===o.srcThumbsCollection.collection.length};return{icon:"glyphicon glyphicon-option-horizontal",switchers:[{_id:"update",label:e.hardData.phrases[16],onClick:function(){o.srcAction.getFilesCount()<o.srcAction.maxFiles?e.$broadcast("displayMultipleFilesInput",{cb:function(e){t.update("addToSet",o,e)}}):o.srcAction.displayModalMessage("MAX_FILES_UPLOADED")}},{_id:"delete",label:e.hardData.phrases[14],onClick:function(){t["delete"]("multiple",o)},isHidden:n},{_id:"refresh",label:e.hardData.phrases[106],onClick:function(){o.srcThumbsCollection.init(o.item.photos)},isHidden:n},{_id:"select_all",label:e.hardData.phrases[107],onClick:function(){o.srcThumbsCollection.selectAll()},isHidden:n},{_id:"deselect_all",label:e.hardData.phrases[110],onClick:function(){o.srcThumbsCollection.deselectAll()},isHidden:n}]}},getSrcContextMenuConf:function(o){var n=function(e){o.srcThumbsCollection.moveSingle(e._id,e.parent.data,function(){t.afterUpdateSync(o)})};return{icon:"glyphicon glyphicon-option-horizontal",switchers:[{_id:"updateSingle",label:e.hardData.phrases[5],onClick:function(){var n=this;e.$broadcast("displaySingleFileInput",{cb:function(e){t.update("updateSingle",o,e,n.parent.data)}})}},{_id:"delete",label:e.hardData.phrases[14],onClick:function(){t["delete"]("single",o,this.parent.data)}},{_id:"refresh",label:e.hardData.phrases[106],onClick:function(){this.parent.data.load(void 0,!0)}},{_id:"moveLeft",label:e.hardData.phrases[135],onClick:function(){n(this)},isHidden:function(){if(o.srcThumbsCollection)return o.srcThumbsCollection.collection.length<2}},{_id:"moveRight",label:e.hardData.phrases[136],onClick:function(){n(this)},isHidden:function(){if(o.srcThumbsCollection)return o.srcThumbsCollection.collection.length<2}},{_id:"set_as_avatar",label:e.hardData.phrases[108],onClick:function(){o.item.avatarFileName=this.parent.data.filename,t.afterUpdateSync(o)}}]}}};return o};e.$inject=["$rootScope","itemPhotosService"],angular.module("appModule").service("itemPhotosConf",e)}(),function(){var e=function(e,t,o,n,i,r,a){var c={constructPhotoUrl:function(e,t,o,n){return n?a.AWS3_RESIZED_UPLOADS_BUCKET_URL+"resized-"+e+"/items/"+t+"/"+o:a.AWS3_UPLOADS_BUCKET_URL+e+"/items/"+t+"/"+o},uploadRequest:function(i,r){var a=this;return t(function(t){var s=i.credentials[r],l=i.inputData[r],u=n.createFormDataObject(s.awsFormData,l);o.makeRequest(s.awsUrl,u).success(function(o){a.filename=s.awsFilename,a.size=l.size;var n=e.apiData.item;t({success:!0,url:c.constructPhotoUrl(n.userId,n._id,a.filename,!0)})}).error(function(e){t({success:!1})})})},update:function(t,n,i,r){n.srcAction.validate(t,i).then(function(a){if(a.success){var s=[];for(var l in i)i[l]instanceof File&&s.push(i[l].type);o.getCredentials("item_photos",{itemId:e.apiData.item._id,fileTypes:s}).then(function(e){var o={inputData:i,credentials:e.data,src:r};n.srcThumbsCollection[t](o,function(e){c.afterUpdateSync(n)})})}else n.srcAction.displayModalMessage(a.msgId)})},"delete":function(t,o,n,r){var a;switch(t){case"single":a=[n];break;case"multiple":a=o.srcThumbsCollection.getSelectedCollection()}o.srcThumbsCollection.removeFromSet({collection:a},function(t,o){t&&i.getList({_id:e.apiData.item._id})})},afterUpdateSync:function(t,o){var n=r.copy(e.apiData.item);n.photos=[];for(var i in t.srcThumbsCollection.collection)n.photos[i]={filename:t.srcThumbsCollection.collection[i].filename,size:t.srcThumbsCollection.collection[i].size};n.put().then(function(t){e.apiData.item=t.data,o&&o(!0)},function(e){o&&o(!1)})}};return c};e.$inject=["$rootScope","$q","aws3Service","MySrcAction","ItemsRest","Restangular","URLS"],angular.module("appModule").service("itemPhotosService",e)}(),function(){var e=angular.module("appModule");e.directive("items",["$rootScope","itemsConf","itemsService",function(e,t,o){var n={restrict:"E",templateUrl:"public/directives/ITEM/items/items.html",scope:{ctrlId:"@"},controller:function(t){t.hardData=e.hardData,t.apiData=e.apiData},compile:function(o,n){return function(o,n,i){switch(e.$$listeners.initSearchItems||e.$on("initSearchItems",function(e,n){o.collectionBrowser=t.searchCollectionBrowser,o.collectionBrowser.init()}),e.$$listeners.initUserItems||e.$on("initUserItems",function(e,n){o.collectionBrowser=t.profileCollectionBrowser,o.elemContextMenuConf=t.itemContextMenuConf,o.collectionBrowser.init()}),o.ctrlId){case"UserItems":o.collectionBrowser=t.profileCollectionBrowser,o.elemContextMenuConf=t.itemContextMenuConf,o.$watch("apiData.profileUser._id",function(e){angular.isDefined(e)&&o.collectionBrowser.init()});break;case"SearchItems":o.collectionBrowser=t.searchCollectionBrowser,o.collectionBrowser.init()}}}};return n}])}(),function(){var e=function(e,t,o,n,i,r){var a=o.get();return this.searchCollectionBrowser=new n.MyCollectionBrowser({singlePageSize:25,filterer:{switchers:[{_id:"all",label:a.phrases[76]},{_id:"L",label:a.itemTypes[0].label},{_id:"F",label:a.itemTypes[1].label}]},sorter:{switchers:[{_id:"title",label:a.phrases[84]},{_id:"dateAdded",label:a.phrases[137]}]},fetchData:function(t){var o=e.globalFormModels.itemSearchModel.getValues();return t.title=o.title,t.categoryId=o.categoryId,t.subcategoryId=o.subcategoryId,r.getList(t)}}),this.profileCollectionBrowser=new n.MyCollectionBrowser({singlePageSize:25,filterer:{switchers:[{_id:"all",label:a.phrases[76]},{_id:"L",label:a.itemTypes[0].label},{_id:"F",label:a.itemTypes[1].label}]},sorter:{switchers:[{_id:"title",label:a.phrases[84]},{_id:"dateAdded",label:a.phrases[137]}]},fetchData:function(t){return t.userId=e.apiData.profileUser._id,r.getList(t)}}),this.itemContextMenuConf={icon:"glyphicon glyphicon-option-horizontal",switchers:[{_id:"edit",label:a.phrases[68],onClick:function(){t.go("main.editem",{id:this.parent.data._id})}},{_id:"delete",label:a.phrases[14],onClick:function(){i.deleteItems([this.parent.data])}}]},this};e.$inject=["$rootScope","$state","hardDataService","myClass","itemsService","ItemsRest"],angular.module("appModule").service("itemsConf",e)}(),function(){var e=function(e,t,o,n){var i=o.service("items");return o.extendModel("items",function(t){return t._isOwn=function(){return this.userId==e.globalFormModels.personalDetailsModel.getValue("_id")},t}),i};e.$inject=["$rootScope","$stateParams","Restangular","storageService"],angular.module("appModule").factory("ItemsRest",e)}(),function(){var e=function(e,t,o,n,i,r){var a=this;return a.deleteItems=function(n){n&&n.length>0&&e.ui.modals.deleteItemModal.show({message:function(){return e.hardData.sentences[48]}(),acceptCb:function(){var r=[],a=!0,c=!1,s=void 0;try{for(var l,u=n[Symbol.iterator]();!(a=(l=u.next()).done);a=!0){var d=l.value;r.push(d.remove({userId:d.userId}))}}catch(p){c=!0,s=p}finally{try{!a&&u["return"]&&u["return"]()}finally{if(c)throw s}}i.all(r).then(function(n){switch(t.current.name){case"main.profile":e.$broadcast("initUserItems",{userId:o.id});break;case"main.item":window.history.back()}})}})},a};e.$inject=["$rootScope","$state","$stateParams","$timeout","$q","Restangular"],angular.module("appModule").service("itemsService",e)}(),function(){var e=angular.module("appModule");e.directive("myAlert",function(){var e={restrict:"E",template:'<div class="myAlert alert no_selection" ng-class="ctrlClass" role="alert" ng-bind="message" my-directive></div>',scope:{ctrlClass:"=",hardData:"="}};return e})}(),function(){var e=angular.module("appModule");e.directive("myBtn",["$rootScope",function(e){return{restrict:"E",replace:!0,templateUrl:"public/directives/my/myBtn/myBtn.html",scope:{ctrlClass:"=",clickAction:"=",clickArgs:"=",clickContext:"=",showModalId:"@",explicitLabel:"=",hardData:"="},controller:["$scope",function(e){}],compile:function(t,o){return function(t,o,n){t.showModalId?t.onClick=function(){e.$broadcast(t.showModalId)}:"function"==typeof t.clickAction&&(t.onClick=function(){t.clickContext?t.clickAction.call(t.clickContext,t.clickArgs):t.clickAction(t.clickArgs)})}}}}])}(),function(){var e=angular.module("appModule");e.directive("myCaptcha",["$timeout","grecaptchaService",function(e,t){var o={restrict:"E",template:'<div id="{{ ctrlId }}" ng-show="visible" style="margin-bottom: 20px;" my-directive></div>',scope:{ctrlId:"=",actionName:"="},controller:function(e,o){o(function(){e.grecaptchaId=t.load(e.ctrlId,e.actionName,function(){o(function(){e.visible=!1},1e3)})})},compile:function(o,n){return function(o,n,i){var r=$(n).parents(".myForm:first"),a=$(r).scope();o.$watch("visible",function(e){e===!0&&t.reset(o.grecaptchaId)}),e(function(){t.shouldBeVisible(o.ctrlId,function(e){a.captcha=o,o.visible=e})})}}};return o}])}(),function(){var e=angular.module("appModule");e.directive("myCollectionBrowser",function(){var e={restrict:"E",transclude:{frontctrls:"?frontctrls",endctrls:"?endctrls",extractrls:"?extractrls",elems:"?elems"},templateUrl:"public/directives/my/myCollectionBrowser/myCollectionBrowser.html",scope:{ins:"=",noScrollTopBtn:"="}};return e})}(),function(){var e=angular.module("appModule");e.directive("myCollectionElem",["$rootScope","MySwitchable",function(e,t){var o={restrict:"E",templateUrl:"public/directives/my/myCollectionElem/myCollectionElem.html",transclude:{titleSection:"?titleSection",avatarSection:"?avatarSection",infoSection:"?infoSection"},scope:{data:"=",contextMenuConf:"=",isSelectable:"="},controller:function(e){e.contextMenuConf&&(e.contextMenu=new t(e.contextMenuConf),e.contextMenu.data=e.data)},compile:function(e,t){return function(e,t,o){}}};return o}])}(),function(){var e=angular.module("appModule");e.directive("myContextMenu",function(){var e={restrict:"E",templateUrl:"public/directives/my/myContextMenu/myContextMenu.html",scope:{ins:"="},controller:function(e){},compile:function(e,t){return function(e,t,o){}}};return e})}(),function(){var e=angular.module("appModule");e.directive("myDirective",["$rootScope","$timeout","hardDataService",function(e,t,o){var n={restrict:"A",controller:function(e){o.bind(e)}};return n}])}(),function(){var e=angular.module("appModule");e.directive("myDropDown",function(){return{restrict:"E",templateUrl:"public/directives/my/myDropDown/myDropDown.html",scope:{ins:"=",openDirection:"=",ctrlClass:"="}}})}(),function(){var e=angular.module("appModule");e.directive("myElemSelector",function(){var e={restrict:"E",templateUrl:"public/directives/my/myElemSelector/myElemSelector.html",scope:{isSelected:"="},controller:function(){},compile:function(e,t){return function(e,t,o){var n=$(t).find("button").get()[0];$(n).on("click",function(){e.isSelected=!e.isSelected,e.$apply()})}}};return e})}(),function(){var e=angular.module("appModule");e.directive("myForm",["MyLoader",function(e){return{restrict:"E",transclude:!0,templateUrl:"public/directives/my/myForm/myForm.html",scope:{ins:"=",hardData:"="},controller:["$scope",function(t){t.ins.scope=t,t.loader=new e,t.ins.model.clear(),t.ins.model.set()}],compile:function(e,t){return function(e,t,o){}}}}])}(),function(){var e=angular.module("appModule");e.directive("myFormErrorIcon",function(){var e={restrict:"E",templateUrl:"public/directives/my/myFormErrorIcon/myFormErrorIcon.html",scope:{args:"="}};return e})}(),function(){var e=angular.module("appModule");e.directive("myInput",function(){var e={restrict:"E",templateUrl:"public/directives/my/myInput/myInput.html",scope:{ctrlId:"=",ctrlType:"=",ctrlMaxLength:"=",ctrlMinValue:"=",ctrlMaxValue:"=",model:"=",hardData:"=",hideErrors:"=",isRequired:"="}};return e})}(),function(){var e=angular.module("appModule");e.directive("myLabel",function(){var e={restrict:"E",templateUrl:"public/directives/my/myLabel/myLabel.html",scope:{text:"=",cssClass:"="}};return e})}(),function(){var e=angular.module("appModule");e.directive("myListGroup",function(){return{restrict:"E",templateUrl:"public/directives/my/myListGroup/myListGroup.html",scope:{ins:"="}}})}(),function(){var e=angular.module("appModule");e.directive("myLoader",["$timeout",function(e){var t={restrict:"E",templateUrl:"public/directives/my/myLoader/myLoader.html",scope:{fixedCentered:"=",absCentered:"="}};return t}])}(),function(){var e=angular.module("appModule");e.directive("myModal",["$rootScope","$timeout",function(e,t){return{restrict:"E",templateUrl:"public/directives/my/myModal/myModal.html",transclude:{header:"?myModalHeader",body:"?myModalBody",footer:"?myModalFooter"},scope:{ins:"=",slideInFromLeft:"="},controller:["$scope",function(e){}],compile:function(o,n){return function(o,n,i){$(".modal").on("show.bs.modal",function(){e.isAnyModalOpen=!0}),$(".modal").on("hide.bs.modal",function(){e.isAnyModalOpen=!1,o.ins.hideCb&&t(function(){o.ins.hideCb()},500)})}}}}])}(),function(){var e=angular.module("appModule");e.directive("myNavDropDown",function(){var e={restrict:"E",templateUrl:"public/directives/my/myNavDropDown/myNavDropDown.html",scope:{ins:"="}};return e})}(),function(){var e=angular.module("appModule");e.directive("myNavMenu",function(){var e={restrict:"E",replace:!0,templateUrl:"public/directives/my/myNavMenu/myNavMenu.html",scope:{ins:"="}};return e})}(),function(){var e=angular.module("appModule");e.directive("myPanel",["ui",function(e){var t={restrict:"E",templateUrl:"public/directives/my/myPanel/myPanel.html",transclude:{titleSection:"?titleSection",actionSection:"?actionSection",bodySection:"?bodySection"}};return t}])}(),function(){var e=angular.module("appModule");e.directive("myPopOverIcon",function(){var e={restrict:"E",transclude:{icon:"span"},templateUrl:"public/directives/my/myPopOverIcon/myPopOverIcon.html",scope:{hardData:"="}};return e})}(),function(){var e=angular.module("appModule");e.directive("mySelect",["jsonService",function(e){return{restrict:"E",templateUrl:"public/directives/my/mySelect/mySelect.html",scope:{ctrlId:"=",model:"=",collection:"=",nestedCollectionFieldName:"=",propNames:"=",optionZero:"=",hardData:"=",hideErrors:"="},link:function(t,o,n){var i=$(o).parents("my-selects-group").get();if(i.length>0){var r=$($(o).parent()[0].children).index(o);if(t.onSelect=function(){for(var e=$(o).parent()[0].children.length,t=r+1;t<e;t++){var n=$($($(o).parent()[0].children[t]).find("select")[0]).scope();n.model.value="",n.collection=void 0}},r>0){var a=$($($(o).parent()[0].children[r-1]).find("select")[0]).scope();t.$watch(function(){return a.model.value},function(o){if(o){var n=a.collection;e.find.objectByProperty(n,a.propNames.optionValue,o,function(e){e&&(t.collection=e[t.nestedCollectionFieldName])})}else t.collection=void 0})}switch(r){case 0:t.$watch("$parent.$parent.collection",function(e){e&&(t.collection=e)}),t.$watch("model.value",function(e){t.optionZero||e||(t.model.value=t.collection[0][t.propNames.optionValue])})}}}}}])}(),function(){var e=angular.module("appModule");e.directive("mySelectsGroup",["hardDataService",function(e){var t={restrict:"E",templateUrl:"public/directives/my/mySelectsGroup/mySelectsGroup.html",transclude:!0,scope:{collection:"=",model:"=",hardData:"="}};return t}])}(),function(){var e=angular.module("appModule");e.directive("mySrc",["$timeout","MySwitchable",function(e,t){var o={restrict:"E",templateUrl:"public/directives/my/mySrc/mySrc.html",scope:{ins:"=",type:"@",isSelectable:"&",contextMenuConf:"=",hrefTarget:"@"},controller:function(e){(e.isSelectable()||e.contextMenuConf)&&(e.onMouseEnter=function(){e.srcCtrlsVisible=!0},e.onMouseLeave=function(){e.srcCtrlsVisible=!1}),e.isSelectable()&&(e.ins.isSelected=!1),e.contextMenuConf&&(e.contextMenu=new t(e.contextMenuConf),e.contextMenu.data=e.ins)},compile:function(e,t){return function(e,t,o){var n=$(t).find(e.type).get()[0];$(n).bind("load",function(){e.$apply(),e.ins.deferred.resolve(!0)}),$(n).bind("error",function(){e.$apply(),e.ins.deferred.resolve(!1)})}}};return o}])}(),function(){var e=angular.module("appModule");e.directive("mySrcSlides",["MySwitchable",function(e){var t={restrict:"E",templateUrl:"public/directives/my/mySrcSlides/mySrcSlides.html",scope:{mySrcCollection:"=",srcType:"@"},controller:function(e){},compile:function(t,o){return function(t,o,n){t.$watchCollection("mySrcCollection.collection",function(o){if(o){var n=[];for(var i in o)n.push({_id:o[i].index,index:o[i].index});t.mySwitchable=new e({switchers:n}),t.mySrcCollection.switchable=t.mySwitchable}})}}};return t}])}(),function(){var e=angular.module("appModule");e.directive("mySrcThumbs",["$rootScope","MySwitchable","MyModal",function(e,t,o){var n={restrict:"E",templateUrl:"public/directives/my/mySrcThumbs/mySrcThumbs.html",scope:{srcThumbsCollection:"=",srcSlidesCollection:"=",mainContextMenuConf:"=",srcContextMenuConf:"=",browsingWindowId:"@",srcType:"@",isSrcSelectable:"&"},controller:function(e){e.srcSlidesModal=new o({id:e.browsingWindowId}),e.mainContextMenuConf&&(e.mainContextMenu=new t(e.mainContextMenuConf))},compile:function(e,t){return function(e,t,o){e.browsingWindowId&&(e.$watchCollection("srcThumbsCollection.collection",function(t){if(t){var o=function(){e.srcSlidesCollection.switchable&&(e.srcSlidesCollection.switchable.switchers[this.index].activate(),e.srcSlidesModal.show())};for(var n in t)t[n].onClick=o}}),e.$watch("srcSlidesCollection.switchable",function(t){if(t){var o=function(){e.srcSlidesModal.title=e.srcSlidesCollection.collection[this.index].filename};for(var n in t.switchers)t.switchers[n].onActivate=o}}))}}};return n}])}(),function(){var e=angular.module("appModule");e.directive("myTabs",function(){return{restrict:"E",templateUrl:"public/directives/my/myTabs/myTabs.html",scope:{ins:"="}}})}(),function(){var e=angular.module("appModule");e.directive("myTextArea",function(){var e={restrict:"E",templateUrl:"public/directives/my/myTextArea/myTextArea.html",scope:{ctrlId:"=",ctrlMaxLength:"=",model:"=",hardData:"="}};return e})}(),function(){var e=angular.module("appModule");e.directive("userAvatar",["userAvatarService","userAvatarConf","MySrc","ui",function(e,t,o,n){var i={restrict:"E",templateUrl:"public/directives/USER/userAvatar/userAvatar.html",scope:{user:"=",editable:"=",noLabel:"&",noLink:"&"},controller:function(n){n.src=new o({defaultUrl:t.defaultUrl,uploadRequest:e.uploadRequest,removeRequest:e.removeRequest}),n.srcContextMenuConf=t.getSrcContextMenuConf(n)},compile:function(t,o){return function(t,o,n){t.$watch(function(){return t.user},function(o){o&&(t.noLabel()||(t.src.label=t.user.truncatedUsername),t.noLink()||(t.src.href="/#/profile?id="+t.user._id),e.loadPhoto(t))})}}};return i}])}(),function(){var e=function(e,t,o){var n={defaultUrl:"public/imgs/avatar.png",getSrcContextMenuConf:function(n){return{icon:"glyphicon glyphicon-option-horizontal",switchers:[{_id:"update",label:e.hardData.phrases[5],onClick:function(){e.$broadcast("displayImgCropWindow",{acceptCb:function(e){n.src.update({file:o.dataURItoBlob(e)},!0).then(function(e){e&&t.loadPhoto(n,!0)})}})}},{_id:"delete",label:e.hardData.phrases[14],onClick:function(){n.src.remove(void 0,!0)},isHidden:function(){return n.src.isDefaultUrlLoaded()}},{_id:"refresh",label:e.hardData.phrases[106],onClick:function(){t.loadPhoto(n,!0)}}]}}};return n};e.$inject=["$rootScope","userAvatarService","utilService"],angular.module("appModule").service("userAvatarConf",e)}(),function(){var e=function(e,t,o,n,i,r){var a={loadPhoto:function(e,t){e.src.load(a.constructPhotoUrl(e,!0),t,function(o){o||e.src.load(a.constructPhotoUrl(e,!1),t)})},constructPhotoUrl:function(e,t){return 0===e.user.photos.length?e.src.defaultUrl:t?r.AWS3_RESIZED_UPLOADS_BUCKET_URL+"resized-"+e.user._id+"/"+e.user.photos[0].filename:r.AWS3_UPLOADS_BUCKET_URL+e.user._id+"/"+e.user.photos[0].filename},uploadRequest:function(r){var c=this;return t(function(t){o.getCredentials("user_avatar",{fileTypes:[r.file.type]}).then(function(s){var l=n.createFormDataObject(s.data[0].awsFormData,r.file);o.makeRequest(s.data[0].awsUrl,l).success(function(o){e.apiData.profileUser.photos[0]={filename:s.data[0].awsFilename,size:r.file.size},e.apiData.profileUser.put().then(function(o){e.apiData.loggedInUser=i.copy(e.apiData.profileUser),t({success:!0,url:a.constructPhotoUrl({src:c,user:e.apiData.profileUser},!0)})},function(e){t({success:!1})})}).error(function(e){t({success:!1})})},function(e){t({success:!1})})})},removeRequest:function(){return t(function(t){e.apiData.profileUser.photos=[],e.apiData.profileUser.put().then(function(){e.apiData.loggedInUser=i.copy(e.apiData.profileUser),t(!0)},function(){t(!1)})})}};return a};e.$inject=["$rootScope","$q","aws3Service","MySrcAction","Restangular","URLS"],angular.module("appModule").service("userAvatarService",e)}(),function(){var e=angular.module("appModule");e.directive("userBadge",["$rootScope","$state","authService",function(e,t,o){return{restrict:"E",templateUrl:"public/directives/USER/userBadge/userBadge.html",scope:!0,controller:["$scope",function(n){n.authState=o.state,n.label1=e.hardData.phrases[32],n.onLogoutClick=function(){e.logout()},n.onContinueClick=function(){t.go("main.home")}}]}}])}(),function(){var e=angular.module("appModule");e.directive("singleFileInput",function(){var e={restrict:"E",template:'<input id="singleFileInput" name="file" type="file" />',scope:!0,controller:function(e){},compile:function(e,t){return function(e,t,o){var n,i=$(t).find("#singleFileInput").get()[0];e.$on("displaySingleFileInput",function(e,t){n=t.cb,$(i).val(void 0),$(i).click()}),$(i).on("change",function(e){e.target.files.length>0&&n(e.target.files)})}}};return e}),e.directive("multipleFilesInput",function(){var e={restrict:"E",template:'<input id="multipleFilesInput" name="file" type="file" multiple />',scope:!0,controller:function(e){},compile:function(e,t){return function(e,t,o){var n,i=$(t).find("#multipleFilesInput").get()[0];e.$on("displayMultipleFilesInput",function(e,t){n=t.cb,$(i).val(void 0),$(i).click()}),$(i).on("change",function(e){e.target.files.length>0&&n(e.target.files)})}}};return e})}();